"use strict";var Ee=Object.create;var z=Object.defineProperty;var Ae=Object.getOwnPropertyDescriptor;var Ce=Object.getOwnPropertyNames;var Pe=Object.getPrototypeOf,_e=Object.prototype.hasOwnProperty;var Re=(e,t)=>{for(var a in t)z(e,a,{get:t[a],enumerable:!0})},fe=(e,t,a,r)=>{if(t&&typeof t=="object"||typeof t=="function")for(let n of Ce(t))!_e.call(e,n)&&n!==a&&z(e,n,{get:()=>t[n],enumerable:!(r=Ae(t,n))||r.enumerable});return e};var Ue=(e,t,a)=>(a=e!=null?Ee(Pe(e)):{},fe(t||!e||!e.__esModule?z(a,"default",{value:e,enumerable:!0}):a,e)),Le=e=>fe(z({},"__esModule",{value:!0}),e);var qe={};Re(qe,{default:()=>Te});module.exports=Le(qe);var D=require("@raycast/api"),ue=require("react");var Q=require("@raycast/api"),{weekStart:ee,birthday:j,progressSymbol:de,showProgressBar:he,countdownDateFirst:te}=(0,Q.getPreferenceValues)(),{colorIcon:Ie,showTitle:Oe,commandMetadata:Me,hour24:We}=(0,Q.getPreferenceValues)();var re=require("@raycast/api");var R=Ue(require("react")),h=require("@raycast/api");var pe=require("react/jsx-runtime");var ne=e=>!(e!=null&&String(e).length>0),Ne=()=>{let e="\u25A0",t="\u25A1";switch(de){case"\u25A0":{e="\u25A0",t="\u25A1";break}case"\u25CF":{e="\u25CF",t="\u25CB";break}case"\u2665\uFE0E":{e="\u2665\uFE0E\uFE0E",t="\u2661";break}case"\u273F":{e="\u273F\uFE0E",t="\u2740";break}case"\u2605":{e="\u2605",t="\u2606";break}case"\u272A":{e="\u272A",t="\u25CB";break}default:break}return{spentSymbol:e,leftSymbol:t}},o=(e,t,a)=>{let{spentSymbol:r,leftSymbol:n}=Ne(),s=r.repeat(Math.floor(e/(e+t)*a))+n.repeat(a-Math.floor(e/(e+t)*a)),p=(e/(e+t)*100).toFixed(0)+"%";return{canvas:s,text:p}},me=async()=>{await(0,re.updateCommandMetadata)({subtitle:"Life Progress"})};var ae=["Countdown Date","You have","You may be able to"],se=["You have","You may be able to","Countdown Date"],ge=["All"].concat(ae),be=["All"].concat(se);var Fe=()=>{let e=new Date;return new Date(j).getTime()>e.getTime()?{isValid:!1,birthTime:new Date("1995-01-01")}:new Date(j).getTime()<new Date(`${e.getFullYear()-110}-01-01`).getTime()?{isValid:!1,birthTime:new Date("1995-01-01")}:{isValid:!0,birthTime:new Date(j)}},$e=()=>{let e=new Date;return e.getDate()===v.getDate()&&e.getMonth()===v.getMonth()},v=Fe().birthTime,oe=new Date(v.getFullYear()+80,v.getMonth(),v.getDate()),U=new Date,ye=()=>Math.floor(U.getFullYear()-v.getFullYear()),Y=()=>Math.floor((U.getTime()-v.getTime())/(1e3*60*60*24)),Ve=()=>v.getFullYear()>=2e3?1:2,B=()=>{let e=oe.getTime()-U.getTime();return Math.floor(e/(1e3*60*60*24))},ze=()=>({spentPaychecks:(U.getFullYear()-v.getFullYear())*12+U.getMonth()-v.getMonth(),leftPaychecks:(oe.getFullYear()-U.getFullYear())*12+oe.getMonth()-U.getMonth()}),je=()=>({spentWeeks:Math.floor(Y()/7),leftWeeks:Math.floor(B()/7)}),ie=()=>24-new Date().getHours()-1,Ye=()=>{let e=new Date;switch(ee){case"Sunday":return 6-e.getDay();case"Monday":return e.getDay()===0?0:7-e.getDay();case"Tuesday":return e.getDay()<=1?1-e.getDay():8-e.getDay();case"Wednesday":return e.getDay()<=2?2-e.getDay():9-e.getDay();case"Thursday":return e.getDay()<=3?3-e.getDay():10-e.getDay();case"Friday":return e.getDay()<=4?4-e.getDay():11-e.getDay();case"Saturday":return e.getDay()<=5?5-e.getDay():12-e.getDay();default:return 6-e.getDay()}},Be=()=>{let e=new Date,t=new Date(e.getFullYear(),e.getMonth()+1,0).getDate();return{spentMonth:e.getDate(),leftMonth:t-e.getDate(),allMonth:t}},Ge=()=>{let e=new Date,t=(new Date(e.getFullYear()+1,0,0).getTime()-new Date(e.getFullYear(),0,0).getTime())/(1e3*60*60*24),a=(new Date(e.getFullYear(),e.getMonth(),e.getDate(),0,0,0).getTime()-new Date(e.getFullYear(),0,0).getTime())/(1e3*60*60*24);return{spentDayThisYear:a,leftDayThisYear:parseInt(t-a+".0001"),allDayThisYear:t}},we=e=>{let t=[],a=["\u{1F55A}","\u{1F559}","\u{1F558}","\u{1F557}","\u{1F556}","\u{1F555}","\u{1F554}","\u{1F553}","\u{1F552}","\u{1F551}","\u{1F550}","\u{1F55B}"],r=[...a,...a],n=Y(),s=B();t.push({section:"You have",icon:He(n+""),title:`Spent ${n} meaningful days`,titleCanvas:{canvas:o(n,s,10).canvas,text:o(n,s,10).text},subTitle:"",number:n,accessUnit:void 0});let p=ye(),l=80-p;t.push({section:"You have",icon:"\u{1F38A}",title:`Celebrated ${p} New Year's Days`,titleCanvas:{canvas:o(p,l,10).canvas,text:o(p,l,10).text},subTitle:"",number:ye(),accessUnit:void 0});let u=Ve(),i=3-u;t.push({section:"You have",icon:u==1?"\u2708\uFE0F":"\u{1F680}",title:`Witnessed ${u} great centuries`,titleCanvas:{canvas:o(u,i,10).canvas,text:o(u,i,10).text},subTitle:"",number:u,accessUnit:void 0});let{spentPaychecks:d,leftPaychecks:N}=ze();t.push({section:"You may be able to",icon:"\u{1F4B0}",title:`Receive ${d} generous paychecks`,titleCanvas:{canvas:o(d,N,10).canvas,text:o(d,N,10).text},subTitle:"",number:d,accessUnit:void 0});let{spentWeeks:T,leftWeeks:F}=je();t.push({section:"You may be able to",icon:"\u{1F3A1}",title:`Spend ${T} pleasant weekends`,titleCanvas:{canvas:o(T,F,10).canvas,text:o(T,F,10).text},subTitle:"",number:T,accessUnit:void 0}),t.push({section:"You may be able to",icon:"\u{1F319}",title:`Enjoy ${s} wonderful nights`,titleCanvas:{canvas:o(n,s,10).canvas,text:o(n,s,10).text},subTitle:"",number:s,accessUnit:void 0});let y=ie();t.push({section:"Countdown Date",icon:r[y],title:`${y} hours left in the day`,titleCanvas:{canvas:o(24-y,y,24).canvas,text:o(24-y,y,24).text},subTitle:"",number:y,accessUnit:void 0});let E=Ye();t.push({section:"Countdown Date",icon:E<=1?"\u{1F3DD}":"\u{1F4BC}",title:`${E} days left in the week`,titleCanvas:{canvas:o(7-E,E,7).canvas,text:o(7-E,E,7).text},subTitle:"",number:E,accessUnit:void 0});let{spentMonth:M,leftMonth:_,allMonth:f}=Be();t.push({section:"Countdown Date",icon:Ke(_),title:`${_} days left in the month`,titleCanvas:{canvas:o(M,_,f).canvas,text:o(M,_,f).text},subTitle:"",number:_,accessUnit:void 0});let{spentDayThisYear:m,leftDayThisYear:g,allDayThisYear:W}=Ge();t.push({section:"Countdown Date",icon:Je(g),title:`${g} days left in the year`,titleCanvas:{canvas:o(m,g,W).canvas,text:o(m,g,W).text},subTitle:"",number:g,accessUnit:void 0});let k=new Date;return e.forEach($=>{let X,V;k.getTime()<$.date?(V=Math.floor(($.date-k.getTime())/(1e3*60*60*24)),X=`${V} days left until ${$.title}`):(V=Math.floor((k.getTime()-$.date)/(1e3*60*60*24)),X=`${V} days passed since ${$.title}`),t.push({section:"Countdown Date",icon:$.icon,title:X,titleCanvas:{canvas:new Date($.date).toLocaleDateString(),text:""},subTitle:$.description,number:g,accessUnit:void 0})}),{lifeProgresses:t}},He=e=>e.endsWith("0")?"\u{1F308}":e.endsWith("1")?"\u{1F324}":e.endsWith("2")?"\u26C5\uFE0F":e.endsWith("3")?"\u{1F326}":e.endsWith("4")?"\u{1F327}":e.endsWith("5")?"\u26C8\uFE0F":e.endsWith("6")?"\u{1F328}":e.endsWith("7")?"\u{1F325}":e.endsWith("8")?"\u2600\uFE0F":(e.endsWith("9"),"\u{1F308}"),Ke=e=>e<=3?"\u{1F311}":e<=7?"\u{1F318}":e<=11?"\u{1F317}":e<=14?"\u{1F316}":e<=18?"\u{1F315}":e<=21?"\u{1F314}":e<=24?"\u{1F313}":e<=28?"\u{1F312}":"\u{1F311}",Je=e=>e<=3?"\u{1F38A}":e<=10?"\u{1F381}":e<=40?"\u{1F3EE}":e<=80?"\u2744\uFE0F":e<=120?"\u{1FA86}":e<=150?"\u{1F341}":e<=180?"\u{1F390}":e<=220?"\u26F1":e<=260?"\u{1F338}":e<=300?"\u{1F3EE}":e<=330?"\u{1F9E8}":e<=355?"\u{1F389}":"\u{1F38A}";var J=require("@raycast/api");var C=require("@raycast/api"),ce=require("react/jsx-runtime");function I(){return(0,ce.jsx)(C.ActionPanel.Section,{children:(0,ce.jsx)(C.Action,{icon:C.Icon.Gear,title:"Configure Command",shortcut:{modifiers:["shift","cmd"],key:","},onAction:C.openCommandPreferences})})}var A=require("@raycast/api");var c=require("@raycast/api"),S=require("react");var x=require("react/jsx-runtime"),Ze=c.Toast.Style;function le(e){let{countdownDates:t,setRefresh:a}=e,[r,n]=(0,S.useState)(),[s,p]=(0,S.useState)(""),[l,u]=(0,S.useState)(""),[i,d]=(0,S.useState)(""),[N,T]=(0,S.useState)(),[F,y]=(0,S.useState)(),[E,M]=(0,S.useState)(""),{pop:_}=(0,c.useNavigation)();return(0,S.useEffect)(()=>{async function f(){if(typeof r<"u"){let m=new Date;if(m<r){let g=(new Date(r.getFullYear(),r.getMonth(),r.getDate(),0,0,0).getTime()-m.getTime())/864e5;M(`${s} ${Math.floor(g)} days left until ${l}`)}else{let g=(m.getTime()-new Date(r.getFullYear(),r.getMonth(),r.getDate(),0,0,0).getTime())/864e5;M(`${s} ${Math.floor(g)} days passed since ${l}`)}}}f().then()},[r,s,l,i]),(0,x.jsxs)(c.Form,{navigationTitle:"Add Countdown Date",actions:(0,x.jsxs)(c.ActionPanel,{children:[(0,x.jsx)(c.Action,{title:"Add Countdown Date",icon:c.Icon.Clock,onAction:async()=>{if(r===void 0){T("The field should't be empty!");return}if(ne(l)){y("The field should't be empty!");return}let f=[...t],m=new Date;f.push({id:"CountdownDate_"+m.getTime(),creatAt:m.getTime(),modifyAt:m.getTime(),title:l,description:i,date:new Date(r.getFullYear(),r.getMonth(),r.getDate(),0,0,0).getTime(),icon:ne(s)?Date.now()>r.getTime()?"\u231B\uFE0F":"\u23F3":s});let g=f.filter(k=>k.date<m.getTime()),W=f.filter(k=>k.date>=m.getTime());g.sort((k,$)=>$.date-k.date),W.sort((k,$)=>k.date-$.date),await c.LocalStorage.setItem("Countdown date",JSON.stringify([...W,...g])),a(m.getTime()),_(),await(0,c.showToast)(Ze.Success,"Date successfully added.")}}),(0,x.jsx)(I,{})]}),children:[(0,x.jsx)(c.Form.DatePicker,{id:"Date",title:"Date",value:r,error:N,type:c.Form.DatePicker.Type.Date,onChange:f=>{f!==null&&(n(f),f!==void 0&&T(void 0))},onBlur:f=>{f.target.value===void 0?T("The field should't be empty!"):T(void 0)}}),(0,x.jsx)(c.Form.TextField,{id:"Title",title:"Title",placeholder:"Countdown date title",value:l,error:F,onChange:f=>{u(f),f.length>0&&y(void 0)},onBlur:f=>{f.target.value?.length==0?y("The field should't be empty!"):y(void 0)}}),(0,x.jsx)(c.Form.TextField,{id:"Icon",title:"Icon",placeholder:"Type : to enter emoji (optional)",value:s,onChange:p}),(0,x.jsx)(c.Form.TextField,{id:"Description",title:"Description",placeholder:"Countdown date description (optional)",value:i,onChange:d}),(0,x.jsx)(c.Form.Description,{title:"Preview",text:E})]})}var P=require("react"),G=require("@raycast/api");var xe=e=>{let[t,a]=(0,P.useState)([]),[r,n]=(0,P.useState)([]),[s,p]=(0,P.useState)(!0),l=(0,P.useCallback)(async()=>{p(!0);let u=await G.LocalStorage.getItem("Countdown date"),i=typeof u<"u"?JSON.parse(u):[],{lifeProgresses:d}=we(i);a(d),n(i),p(!1),await me()},[e]);return(0,P.useEffect)(()=>{l()},[l]),{lifeProgresses:t,countDownDates:r,loading:s}},ve=async(e,t,a,r,n,s)=>{await(0,G.confirmAlert)({icon:e,title:t,message:a,primaryAction:{title:r,onAction:n},dismissAction:{title:"Cancel",onAction:()=>s}})};var H=require("react/jsx-runtime");function K(e){let{countdownDates:t,setRefresh:a}=e;return(0,H.jsx)(A.Action.Push,{icon:A.Icon.Clock,title:"Add Countdown Date",shortcut:{modifiers:["cmd"],key:"d"},target:(0,H.jsx)(le,{countdownDates:t,setRefresh:a})})}function Se(e){let{countdownDates:t,setRefresh:a,lifeProgressesLength:r,index:n}=e;return(0,H.jsx)(A.Action,{icon:A.Icon.Trash,title:"Remove Countdown Date",shortcut:{modifiers:["ctrl"],key:"x"},onAction:async()=>{await ve(A.Icon.Trash,"Remove CountDown Date","Are you sure you want to remove countdown date?","Remove",()=>{let s=[...t];s.splice(t.length-r+n,1),A.LocalStorage.setItem("Countdown date",JSON.stringify(s)),a(Date.now())})}})}var L=require("react/jsx-runtime");function Z(e){let{index:t,lifeProgressesLength:a,lifeProgress:r,countdownDates:n,setRefresh:s}=e;return(0,L.jsx)(J.List.Item,{icon:r.icon,title:{value:r.title,tooltip:r.titleCanvas.canvas+"  "+r.titleCanvas.text},subtitle:{value:r.subTitle,tooltip:r.subTitle},accessories:r.accessUnit,actions:(0,L.jsxs)(J.ActionPanel,{children:[(0,L.jsx)(K,{countdownDates:n,setRefresh:s}),t>9&&(0,L.jsx)(Se,{countdownDates:n,setRefresh:s,lifeProgressesLength:a,index:t}),(0,L.jsx)(I,{})]})})}var q=require("@raycast/api");var O=require("react/jsx-runtime");function De(e){let{countdownDates:t,setRefresh:a}=e,{canvas:r,text:n}=o(Y(),B(),40);return(0,O.jsx)(q.List.Item,{icon:"\u{1F39E}",title:{value:r,tooltip:`You're ${n} through your life.`},subtitle:`You're ${n} through your life.`,actions:(0,O.jsxs)(q.ActionPanel,{children:[(0,O.jsx)(K,{countdownDates:t,setRefresh:a}),(0,O.jsx)(I,{})]})})}var b=require("react/jsx-runtime");function Te(){let[e,t]=(0,ue.useState)("All"),[a,r]=(0,ue.useState)(0),{lifeProgresses:n,countDownDates:s,loading:p}=xe(a),l=te?ae:se,u=te?ge:be;return(0,b.jsxs)(D.List,{isLoading:p,searchBarPlaceholder:`${ie()<=12?"Don't miss the past":"Don't worry about the future"}, ${$e()?"celebrate your birthday":"cherish the present"}`,searchBarAccessory:(0,b.jsx)(D.List.Dropdown,{tooltip:"Your life progress",storeValue:!0,onChange:t,children:u.map(i=>(0,b.jsx)(D.List.Dropdown.Item,{title:i,value:i},i))}),children:[(0,b.jsx)(D.List.EmptyView,{icon:D.Icon.Clock,title:"Cherish the present",description:"Everything is gone, but time is always on"}),he&&(0,b.jsx)(De,{countdownDates:s,setRefresh:r}),(e===u[0]||e===u[1])&&(0,b.jsx)(D.List.Section,{title:l[0],children:n.map((i,d)=>i.section===l[0]&&(0,b.jsx)(Z,{index:d,lifeProgressesLength:n.length,lifeProgress:i,countdownDates:s,setRefresh:r},d))}),(e===u[0]||e===u[2])&&(0,b.jsx)(D.List.Section,{title:l[1],children:n.map((i,d)=>i.section===l[1]&&(0,b.jsx)(Z,{index:d,lifeProgressesLength:n.length,lifeProgress:i,countdownDates:s,setRefresh:r},d))}),(e===u[0]||e===u[3])&&(0,b.jsx)(D.List.Section,{title:l[2],children:n.map((i,d)=>i.section===l[2]&&(0,b.jsx)(Z,{index:d,lifeProgressesLength:n.length,lifeProgress:i,countdownDates:s,setRefresh:r},d))})]})}
