"use strict";var pe=Object.create;var U=Object.defineProperty;var me=Object.getOwnPropertyDescriptor;var be=Object.getOwnPropertyNames;var ge=Object.getPrototypeOf,ye=Object.prototype.hasOwnProperty;var $e=(e,t)=>{for(var r in t)U(e,r,{get:t[r],enumerable:!0})},B=(e,t,r,n)=>{if(t&&typeof t=="object"||typeof t=="function")for(let a of be(t))!ye.call(e,a)&&a!==r&&U(e,a,{get:()=>t[a],enumerable:!(n=me(t,a))||n.enumerable});return e};var z=(e,t,r)=>(r=e!=null?pe(ge(e)):{},B(t||!e||!e.__esModule?U(r,"default",{value:e,enumerable:!0}):r,e)),we=e=>B(U({},"__esModule",{value:!0}),e);var Fe={};$e(Fe,{default:()=>ie});module.exports=we(Fe);var u=require("@raycast/api"),I=require("react");var l=z(require("react")),o=require("@raycast/api");var G=Object.prototype.hasOwnProperty;function R(e,t){var r,n;if(e===t)return!0;if(e&&t&&(r=e.constructor)===t.constructor){if(r===Date)return e.getTime()===t.getTime();if(r===RegExp)return e.toString()===t.toString();if(r===Array){if((n=e.length)===t.length)for(;n--&&R(e[n],t[n]););return n===-1}if(!r||typeof e=="object"){n=0;for(r in e)if(G.call(e,r)&&++n&&!G.call(t,r)||!(r in t)||!R(e[r],t[r]))return!1;return Object.keys(t).length===n}}return e!==e&&t!==t}var x=z(require("node:fs")),T=z(require("node:path"));var Z=require("react/jsx-runtime");function xe(e){let t=(0,l.useRef)(e),r=(0,l.useRef)(0);return R(e,t.current)||(t.current=e,r.current+=1),(0,l.useMemo)(()=>t.current,[r.current])}function g(e){let t=(0,l.useRef)(e);return t.current=e,t}function ke(e,t){let r=e instanceof Error?e.message:String(e);return(0,o.showToast)({style:o.Toast.Style.Failure,title:t?.title??"Something went wrong",message:t?.message??r,primaryAction:t?.primaryAction??K(e),secondaryAction:t?.primaryAction?K(e):void 0})}var K=e=>{let t=!0,r="[Extension Name]...",n="";try{let c=JSON.parse((0,x.readFileSync)((0,T.join)(o.environment.assetsPath,"..","package.json"),"utf8"));r=`[${c.title}]...`,n=`https://raycast.com/${c.owner||c.author}/${c.name}`,(!c.owner||c.access==="public")&&(t=!1)}catch{}let a=o.environment.isDevelopment||t,i=e instanceof Error?e?.stack||e?.message||"":String(e);return{title:a?"Copy Logs":"Report Error",onAction(c){c.hide(),a?o.Clipboard.copy(i):(0,o.open)(`https://github.com/raycast/extensions/issues/new?&labels=extension%2Cbug&template=extension_bug_report.yml&title=${encodeURIComponent(r)}&extension-url=${encodeURI(n)}&description=${encodeURIComponent(`#### Error:
\`\`\`
${i}
\`\`\`
`)}`)}}};function V(e,t,r){let n=(0,l.useRef)(0),[a,i]=(0,l.useState)({isLoading:!0}),c=g(e),m=g(r?.abortable),k=g(t||[]),O=g(r?.onError),A=g(r?.onData),W=g(r?.onWillExecute),F=g(r?.failureToastOptions),N=g(a.data),L=(0,l.useRef)(null),h=(0,l.useRef)({page:0}),D=(0,l.useRef)(!1),M=(0,l.useRef)(!0),j=(0,l.useRef)(50),y=(0,l.useCallback)(()=>(m.current&&(m.current.current?.abort(),m.current.current=new AbortController),++n.current),[m]),$=(0,l.useCallback)((...b)=>{let d=y();W.current?.(b),i(s=>({...s,isLoading:!0}));let v=ve(c.current)(...b);function S(s){return s.name=="AbortError"||d===n.current&&(O.current?O.current(s):o.environment.launchType!==o.LaunchType.Background&&ke(s,{title:"Failed to fetch latest data",primaryAction:{title:"Retry",onAction(w){w.hide(),L.current?.(...k.current||[])}},...F.current}),i({error:s,isLoading:!1})),s}return typeof v=="function"?(D.current=!0,v(h.current).then(({data:s,hasMore:w,cursor:de})=>(d===n.current&&(h.current&&(h.current.cursor=de,h.current.lastItem=s?.[s.length-1]),A.current&&A.current(s,h.current),w&&(j.current=s.length),M.current=w,i(he=>h.current.page===0?{data:s,isLoading:!1}:{data:(he.data||[])?.concat(s),isLoading:!1})),s),s=>(M.current=!1,S(s)))):(D.current=!1,v.then(s=>(d===n.current&&(A.current&&A.current(s),i({data:s,isLoading:!1})),s),S))},[A,O,k,c,i,L,W,h,F,y]);L.current=$;let C=(0,l.useCallback)(()=>{h.current={page:0};let b=k.current||[];return $(...b)},[$,k]),oe=(0,l.useCallback)(async(b,d)=>{let v;try{if(d?.optimisticUpdate){y(),typeof d?.rollbackOnError!="function"&&d?.rollbackOnError!==!1&&(v=structuredClone(N.current?.value));let S=d.optimisticUpdate;i(s=>({...s,data:S(s.data)}))}return await b}catch(S){if(typeof d?.rollbackOnError=="function"){let s=d.rollbackOnError;i(w=>({...w,data:s(w.data)}))}else d?.optimisticUpdate&&d?.rollbackOnError!==!1&&i(s=>({...s,data:v}));throw S}finally{d?.shouldRevalidateAfter!==!1&&(o.environment.launchType===o.LaunchType.Background||o.environment.commandMode==="menu-bar"?await C():C())}},[C,N,i,y]),ce=(0,l.useCallback)(()=>{h.current.page+=1;let b=k.current||[];$(...b)},[h,k,$]);(0,l.useEffect)(()=>{h.current={page:0},r?.execute!==!1?$(...t||[]):y()},[xe([t,r?.execute,$]),m,h]),(0,l.useEffect)(()=>()=>{y()},[y]);let le=r?.execute!==!1?a.isLoading:!1,ue={...a,isLoading:le},fe=D.current?{pageSize:j.current,hasMore:M.current,onLoadMore:ce}:void 0;return{...ue,revalidate:C,mutate:oe,pagination:fe}}function ve(e){return e===Promise.all||e===Promise.race||e===Promise.resolve||e===Promise.reject?e.bind(Promise):e}var E=typeof Buffer=="function",H=typeof TextDecoder=="function"?new TextDecoder:void 0,J=typeof TextEncoder=="function"?new TextEncoder:void 0,Se="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",_=Array.prototype.slice.call(Se),P=(e=>{let t={};return e.forEach((r,n)=>t[r]=n),t})(_),Ee=/^(?:[A-Za-z\d+\/]{4})*?(?:[A-Za-z\d+\/]{2}(?:==)?|[A-Za-z\d+\/]{3}=?)?$/,f=String.fromCharCode.bind(String),q=typeof Uint8Array.from=="function"?Uint8Array.from.bind(Uint8Array):e=>new Uint8Array(Array.prototype.slice.call(e,0)),Ae=e=>e.replace(/=/g,"").replace(/[+\/]/g,t=>t=="+"?"-":"_"),Q=e=>e.replace(/[^A-Za-z0-9\+\/]/g,""),_e=e=>{let t,r,n,a,i="",c=e.length%3;for(let m=0;m<e.length;){if((r=e.charCodeAt(m++))>255||(n=e.charCodeAt(m++))>255||(a=e.charCodeAt(m++))>255)throw new TypeError("invalid character found");t=r<<16|n<<8|a,i+=_[t>>18&63]+_[t>>12&63]+_[t>>6&63]+_[t&63]}return c?i.slice(0,c-3)+"===".substring(c):i},X=typeof btoa=="function"?e=>btoa(e):E?e=>Buffer.from(e,"binary").toString("base64"):_e,Ce=E?e=>Buffer.from(e).toString("base64"):e=>{let r=[];for(let n=0,a=e.length;n<a;n+=4096)r.push(f.apply(null,e.subarray(n,n+4096)));return X(r.join(""))};var Ue=e=>{if(e.length<2){var t=e.charCodeAt(0);return t<128?e:t<2048?f(192|t>>>6)+f(128|t&63):f(224|t>>>12&15)+f(128|t>>>6&63)+f(128|t&63)}else{var t=65536+(e.charCodeAt(0)-55296)*1024+(e.charCodeAt(1)-56320);return f(240|t>>>18&7)+f(128|t>>>12&63)+f(128|t>>>6&63)+f(128|t&63)}},Re=/[\uD800-\uDBFF][\uDC00-\uDFFFF]|[^\x00-\x7F]/g,Te=e=>e.replace(Re,Ue),Y=E?e=>Buffer.from(e,"utf8").toString("base64"):J?e=>Ce(J.encode(e)):e=>X(Te(e)),ee=(e,t=!1)=>t?Ae(Y(e)):Y(e);var Pe=/[\xC0-\xDF][\x80-\xBF]|[\xE0-\xEF][\x80-\xBF]{2}|[\xF0-\xF7][\x80-\xBF]{3}/g,Ie=e=>{switch(e.length){case 4:var t=(7&e.charCodeAt(0))<<18|(63&e.charCodeAt(1))<<12|(63&e.charCodeAt(2))<<6|63&e.charCodeAt(3),r=t-65536;return f((r>>>10)+55296)+f((r&1023)+56320);case 3:return f((15&e.charCodeAt(0))<<12|(63&e.charCodeAt(1))<<6|63&e.charCodeAt(2));default:return f((31&e.charCodeAt(0))<<6|63&e.charCodeAt(1))}},Oe=e=>e.replace(Pe,Ie),Le=e=>{if(e=e.replace(/\s+/g,""),!Ee.test(e))throw new TypeError("malformed base64.");e+="==".slice(2-(e.length&3));let t,r,n,a=[];for(let i=0;i<e.length;)t=P[e.charAt(i++)]<<18|P[e.charAt(i++)]<<12|(r=P[e.charAt(i++)])<<6|(n=P[e.charAt(i++)]),r===64?a.push(f(t>>16&255)):n===64?a.push(f(t>>16&255,t>>8&255)):a.push(f(t>>16&255,t>>8&255,t&255));return a.join("")},te=typeof atob=="function"?e=>atob(Q(e)):E?e=>Buffer.from(e,"base64").toString("binary"):Le,De=E?e=>q(Buffer.from(e,"base64")):e=>q(te(e).split("").map(t=>t.charCodeAt(0)));var Me=E?e=>Buffer.from(e,"base64").toString("utf8"):H?e=>H.decode(De(e)):e=>Oe(te(e)),ze=e=>Q(e.replace(/[-_]/g,t=>t=="-"?"+":"/")),re=e=>Me(ze(e)),ne=e=>{if(typeof e!="string")return!1;let t=e.replace(/\s+/g,"").replace(/={0,2}$/,"");return!/[^\s0-9a-zA-Z\+/]/.test(t)||!/[^\s0-9a-zA-Z\-_]/.test(t)};var p=require("react/jsx-runtime");function ae(e){let{defaultAction:t}=(0,u.getPreferenceValues)(),r=[(0,p.jsx)(u.Action.CopyToClipboard,{content:e},"copyToClipboard"),(0,p.jsx)(u.Action.Paste,{content:e},"pasteInApp"),...We(e)?[(0,p.jsx)(u.Action.OpenInBrowser,{url:e},"openInBrowser")]:[]],n=r.find(i=>i.key===t),a=r.filter(i=>i.key!==t);return(0,p.jsxs)(u.ActionPanel,{children:[n,a]})}function ie(){let[e,t]=(0,I.useState)(""),{data:r,isLoading:n}=V(async c=>ne(c)&&re(c),[e]),{data:a,isLoading:i}=V(async c=>ee(c),[e]);return(0,I.useEffect)(()=>{e||u.Clipboard.read().then(({text:c})=>t(c))},[e]),(0,p.jsxs)(u.List,{onSearchTextChange:c=>t(Ve(c)),searchBarPlaceholder:"Text to encode / decode...",isLoading:n||i,children:[(a||r)&&(0,p.jsxs)(u.List.Section,{title:`Input: ${se(e)}`,children:[a&&(0,p.jsx)(u.List.Item,{icon:{source:u.Icon.CodeBlock,tintColor:u.Color.Magenta},title:"Encode",subtitle:a,actions:ae(a)},"encode"),r&&(0,p.jsx)(u.List.Item,{icon:{source:u.Icon.Code,tintColor:u.Color.Purple},title:"Decode",subtitle:se(r),actions:ae(r)},"decode")]}),(0,p.jsx)(u.List.EmptyView,{icon:{source:u.Icon.QuestionMarkCircle,tintColor:u.Color.Red},title:"Nothing to Encode / Decode",description:"Copy some content to your clipboard, or start typing text to encode or decode."})]})}var se=e=>{let t={'"':'\\"',"'":"\\'","\\":"\\\\","\n":"\\n","\r":"\\r","	":"\\t"};return e.replace(/["'\\\n\r\t]/g,r=>t[r])},Ve=e=>{let t={'\\"':'"',"\\'":"'","\\\\":"\\","\\n":`
`,"\\r":"\r","\\t":"	"};return e.replace(/\\["'\\nrt]/g,r=>t[r])},We=e=>{try{return new URL(e),!0}catch{return!1}};
