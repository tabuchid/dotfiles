"use strict";var F=Object.create;var c=Object.defineProperty;var K=Object.getOwnPropertyDescriptor;var T=Object.getOwnPropertyNames;var C=Object.getPrototypeOf,E=Object.prototype.hasOwnProperty;var W=(t,e)=>{for(var i in e)c(t,i,{get:e[i],enumerable:!0})},v=(t,e,i,a)=>{if(e&&typeof e=="object"||typeof e=="function")for(let s of T(e))!E.call(t,s)&&s!==i&&c(t,s,{get:()=>e[s],enumerable:!(a=K(e,s))||a.enumerable});return t};var d=(t,e,i)=>(i=t!=null?F(C(t)):{},v(e||!t||!t.__esModule?c(i,"default",{value:t,enumerable:!0}):i,t)),D=t=>v(c({},"__esModule",{value:!0}),t);var b={};W(b,{default:()=>x});module.exports=D(b);var o=require("@raycast/api");var r=require("@raycast/api");var y=d(require("node:process"),1),f=require("node:util"),l=require("node:child_process"),$=(0,f.promisify)(l.execFile);async function p(t,{humanReadableOutput:e=!0,signal:i}={}){if(y.default.platform!=="darwin")throw new Error("macOS only");let a=e?[]:["-ss"],s={};i&&(s.signal=i);let{stdout:P}=await $("osascript",["-e",t,a],s);return P.trim()}var g=require("@raycast/api"),n=class t{static cache=new g.Cache;static AudioInputLevelPreviousKey="audio-input-level-previous";static AudioInputLevelCurrentKey="audio-input-level-current";static AudioInputLevelDefault="50";static listeners=new Set;static get prevInputLevel(){return this.cache.get(t.AudioInputLevelPreviousKey)??t.AudioInputLevelDefault}static set prevInputLevel(e){this.cache.set(t.AudioInputLevelPreviousKey,e)}static get curInputLevel(){return this.cache.get(t.AudioInputLevelCurrentKey)??t.AudioInputLevelDefault}static set curInputLevel(e){this.cache.set(t.AudioInputLevelCurrentKey,e)}static addListener(e){this.listeners.add(e)}static removeListener(e){this.listeners.delete(e)}};var L=require("os"),h=require("child_process"),A=require("util"),m=d(require("path")),I=(0,A.promisify)(h.exec),u=(0,L.platform)()==="win32";async function B(){if(u)try{let e=m.default.join(r.environment.assetsPath,"scripts","windows-get-level.ps1"),{stdout:i}=await I(`powershell -ExecutionPolicy Bypass -File "${e}"`);return i.trim()}catch(e){return console.error(e),"0"}return(await p(`
      set result to (input volume of (get volume settings))
      return result
    `)).trim()}async function w(t){if(u){let e=m.default.join(r.environment.assetsPath,"scripts","windows-set-level.ps1");await I(`powershell -ExecutionPolicy Bypass -File "${e}" -Level ${t}`),n.curInputLevel=t;return}await p(`set volume input volume ${t}`),n.curInputLevel=t}var O=async()=>{let t=await B();if(t==="0"){let e=n.prevInputLevel;return await w(e),n.curInputLevel=e,e}return await w("0"),n.prevInputLevel=t,n.curInputLevel="0","0"},S=async()=>{let t=await(0,r.showToast)({style:r.Toast.Style.Animated,title:"Running..."});try{let e=await O();return e==="0"?(t.title="Audio input muted",t.style=r.Toast.Style.Failure):(t.title="Audio input unmuted",t.style=r.Toast.Style.Success),e}catch(e){return t.title="Error",t.message=String(e),t.style=r.Toast.Style.Failure,"0"}};async function x(){if(await(0,o.closeMainWindow)(),u&&await(0,o.showToast)({style:o.Toast.Style.Animated,title:"Windows Detected",message:"Toggling microphone via PowerShell..."}),await S(),!u)try{await(0,o.launchCommand)({name:"mute-menu-bar",type:o.LaunchType.Background})}catch{console.log("mute-menu-bar command is not active")}}
