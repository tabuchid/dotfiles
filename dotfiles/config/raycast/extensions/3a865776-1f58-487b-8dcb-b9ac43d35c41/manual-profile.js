"use strict";var le=Object.create;var _=Object.defineProperty;var ue=Object.getOwnPropertyDescriptor;var fe=Object.getOwnPropertyNames;var de=Object.getPrototypeOf,he=Object.prototype.hasOwnProperty;var pe=(e,t)=>{for(var r in t)_(e,r,{get:t[r],enumerable:!0})},W=(e,t,r,o)=>{if(t&&typeof t=="object"||typeof t=="function")for(let n of fe(t))!he.call(e,n)&&n!==r&&_(e,n,{get:()=>t[n],enumerable:!(o=ue(t,n))||o.enumerable});return e};var N=(e,t,r)=>(r=e!=null?le(de(e)):{},W(t||!e||!e.__esModule?_(r,"default",{value:e,enumerable:!0}):r,e)),me=e=>W(_({},"__esModule",{value:!0}),e);var Te={};pe(Te,{default:()=>ie});module.exports=me(Te);var g=require("@raycast/api"),I=require("react");var l=require("@raycast/api"),V=require("react");var R=require("@raycast/api");var j=N(require("node:process"),1),B=require("node:util"),L=require("node:child_process"),be=(0,B.promisify)(L.execFile);async function P(e,{humanReadableOutput:t=!0,signal:r}={}){if(j.default.platform!=="darwin")throw new Error("macOS only");let o=t?[]:["-ss"],n={};r&&(n.signal=r);let{stdout:s}=await be("osascript",["-e",e,o],n);return s.trim()}function G(e){return`
    tell application "${e}"
      set currentTab to active tab of front window
      set tabURL to URL of currentTab
      return tabURL
    end tell
  `}function K(){return`
    tell application "Arc"
      tell front window
        set activeTabURL to URL of active tab
        return activeTabURL
      end tell
    end tell
  `}function H(e){return`
    tell application "${e}"
      activate
      delay 0.5
      
      tell application "System Events"
        keystroke "l" using {command down}
        delay 0.2
        keystroke "c" using {command down}
        delay 0.5
        key code 53
      end tell
    end tell
      
    delay 0.5
    
    set copiedURL to do shell script "pbpaste"
    
    return copiedURL
  `}var M=["Arc","Brave","Firefox","Firefox Developer Edition","Google Chrome","Microsoft Edge","Mozilla Firefox","Opera","QQ","Safari","Sogou Explorer","Vivaldi","Yandex","Zen"],Z=`
    set cmd to "lsappinfo metainfo | grep -E -o '${M.join("|")}' | head -1"

    set frontmostBrowser to do shell script cmd

    return frontmostBrowser
`;var ge="https://meet.google.com/new",$e=/^[0-9]+$/,ye=500;function we(e){return M.includes(e)}function J(){let e=(0,R.getPreferenceValues)();return $e.test(e.timeout)?Number.parseInt(e.timeout,10):ye}function q(){return(0,R.getPreferenceValues)().preferredBrowser}function Y(e){return new Promise(t=>setTimeout(t,e))}async function ke(){let e=await xe();return e==="Arc"?await P(K()):e==="Firefox"||e==="Firefox Developer Edition"||e==="Zen"?await P(H(e)):await P(G(e))}async function xe(){let e=q();return e?.name&&we(e.name)?e.name:await P(Z)}async function F(){let t=(await ke()).split(",").find(r=>r.includes("meet.google.com"));return t?.includes("/new")?await F():t}async function Q(e){let t=q();await(0,R.open)(`${ge}?authuser=${e}`,t?.name)}var D=require("react");var i=N(require("react")),c=require("@raycast/api");var ee=require("react/jsx-runtime");function T(e){let t=(0,i.useRef)(e);return t.current=e,t}function ve(e,t){let r=this[e];return r instanceof Date?`__raycast_cached_date__${r.toISOString()}`:Buffer.isBuffer(r)?`__raycast_cached_buffer__${r.toString("base64")}`:t}function Se(e,t){return typeof t=="string"&&t.startsWith("__raycast_cached_date__")?new Date(t.replace("__raycast_cached_date__","")):typeof t=="string"&&t.startsWith("__raycast_cached_buffer__")?Buffer.from(t.replace("__raycast_cached_buffer__",""),"base64"):t}var Ee=Symbol("cache without namespace"),X=new Map;function te(e,t,r){let o=r?.cacheNamespace||Ee,n=X.get(o)||X.set(o,new c.Cache({namespace:r?.cacheNamespace})).get(o);if(!n)throw new Error("Missing cache");let s=T(e),p=T(t),b=(0,i.useSyncExternalStore)(n.subscribe,()=>{try{return n.get(s.current)}catch(m){console.error("Could not get Cache data:",m);return}}),$=(0,i.useMemo)(()=>{if(typeof b<"u"){if(b==="undefined")return;try{return JSON.parse(b,Se)}catch(m){return console.warn("The cached data is corrupted",m),p.current}}else return p.current},[b,p]),x=T($),U=(0,i.useCallback)(m=>{let A=typeof m=="function"?m(x.current):m;if(typeof A>"u")n.set(s.current,"undefined");else{let v=JSON.stringify(A,ve);n.set(s.current,v)}return A},[n,s,x]);return[$,U]}var re=(function(e){return e.Required="required",e})({});function z(e,t){if(e){if(typeof e=="function")return e(t);if(e==="required"){let r=typeof t<"u"&&t!==null;if(r)switch(typeof t){case"string":r=t.length>0;break;case"object":Array.isArray(t)?r=t.length>0:t instanceof Date&&(r=t.getTime()>0);break;default:break}if(!r)return"The item is required"}}}function ne(e){let{onSubmit:t,validation:r,initialValues:o={}}=e,[n,s]=(0,i.useState)(o),[p,b]=(0,i.useState)({}),$=(0,i.useRef)({}),x=T(r||{}),U=T(t),m=(0,i.useCallback)(f=>{$.current[f]?.focus()},[$]),A=(0,i.useCallback)(async f=>{let a=!1;for(let[S,w]of Object.entries(x.current)){let E=z(w,f[S]);E&&(a||(a={},m(S)),a[S]=E)}if(a)return b(a),!1;let d=await U.current(f);return typeof d=="boolean"?d:!0},[x,U,m]),v=(0,i.useCallback)((f,a)=>{b(d=>({...d,[f]:a}))},[b]),O=(0,i.useCallback)(function(f,a){s(d=>({...d,[f]:typeof a=="function"?a(d[f]):a}))},[s]),oe=(0,i.useMemo)(()=>new Proxy({},{get(f,a){let d=x.current[a],S=n[a];return{onChange(w){p[a]&&(z(d,w)||v(a,void 0)),O(a,w)},onBlur(w){let E=z(d,w.target.value);E&&v(a,E)},error:p[a],id:a,value:typeof S>"u"?null:S,ref:w=>{$.current[a]=w}}}}),[p,x,v,n,$,O]),ce=(0,i.useCallback)(f=>{b({}),Object.entries($.current).forEach(([a,d])=>{f?.[a]||d?.reset()}),f&&s(f)},[s,b,$]);return{handleSubmit:A,setValidationError:v,setValue:O,values:n,itemProps:oe,focus:m,reset:ce}}var Ae="google-profiles";function C(){let[e,t]=te(Ae,[]),r=(0,D.useCallback)(n=>{if(e.find(({email:s})=>s===n.email))throw new Error;t(s=>[...s,n])},[e,t]),o=(0,D.useCallback)(n=>t(s=>s.filter(({email:p})=>p!==n)),[t]);return{profiles:e,onRemoveItem:o,onStoreData:r}}var y=require("react/jsx-runtime"),ae=()=>{let{profiles:e,onRemoveItem:t}=C(),r=(0,V.useCallback)(async n=>{try{await Q(n);let s=J();await Y(s);let p=await F();await l.Clipboard.copy(p.split("?")[0]),await(0,l.showHUD)("Copied meet link to clipboard")}catch{await(0,l.showToast)({style:l.Toast.Style.Failure,title:"Couldn't copy to clipboard"})}},[]),o=(0,V.useCallback)(n=>{t(n),(0,l.showToast)({style:l.Toast.Style.Success,title:"Profile removed!"})},[t]);return(0,y.jsx)(y.Fragment,{children:e.map(({email:n,name:s})=>(0,y.jsx)(l.List.Item,{id:n,title:s,subtitle:n,actions:(0,y.jsxs)(l.ActionPanel,{children:[(0,y.jsx)(l.Action,{title:"Select Profile",onAction:()=>r(n)}),(0,y.jsx)(l.Action,{title:"Delete Profile",onAction:()=>o(n)})]})},n))})};var u=require("@raycast/api");var k=require("react/jsx-runtime"),Pe=/[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?$/;function Re(e){if(!e)return"The item is required";if(!Pe.test(e))return"You need a valid email address"}var se=({onFinish:e})=>{let{onStoreData:t}=C(),{handleSubmit:r,itemProps:o}=ne({onSubmit(n){try{t(n),e(),(0,u.showToast)({style:u.Toast.Style.Success,title:"Profile created!"})}catch{(0,u.showToast)({style:u.Toast.Style.Failure,title:"Profile already exists!"})}},validation:{name:re.Required,email:Re}});return(0,k.jsxs)(u.Form,{actions:(0,k.jsxs)(u.ActionPanel,{children:[(0,k.jsx)(u.Action.SubmitForm,{title:"Add Profile",onSubmit:r}),(0,k.jsx)(u.Action.SubmitForm,{title:"Back",onSubmit:e})]}),children:[(0,k.jsx)(u.Form.TextField,{autoFocus:!0,info:"It's important that the email is the same as the one you are logged in on your default browser!",placeholder:"john.doe@raycast.com",title:"Profile email *",...o.email}),(0,k.jsx)(u.Form.TextField,{placeholder:"Raycast",title:"Profile name *",...o.name})]})};var h=require("react/jsx-runtime");function ie(){let[e,t]=(0,I.useState)(),r=(0,I.useCallback)(()=>t(void 0),[]);return(0,h.jsxs)(h.Fragment,{children:[(0,h.jsxs)(g.List,{children:[(0,h.jsx)(g.List.Item,{title:"Create a new profile...",icon:{value:g.Icon.AddPerson,tooltip:"Add new profile to the list"},actions:(0,h.jsx)(g.ActionPanel,{children:(0,h.jsx)(g.Action,{title:"Create a New Profile",onAction:()=>t("add_profile")})})}),(0,h.jsx)(g.List.Section,{title:"Profiles",subtitle:"List of created profiles to start a new Google Meet",children:(0,h.jsx)(ae,{})})]}),e==="add_profile"&&(0,h.jsx)(se,{onFinish:r})]})}
