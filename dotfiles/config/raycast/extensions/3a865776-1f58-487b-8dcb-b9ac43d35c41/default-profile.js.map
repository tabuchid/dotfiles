{
  "version": 3,
  "sources": ["../src/default-profile.ts", "../src/helpers.ts", "../node_modules/run-applescript/index.js", "../src/utils/scripts.ts"],
  "sourcesContent": ["import { showHUD, Clipboard, showToast, Toast } from \"@raycast/api\";\nimport { getMeetTab, openMeetTabDefaultProfile, getTimeout, sleep } from \"./helpers\";\n\nexport default async function main() {\n  try {\n    await openMeetTabDefaultProfile();\n\n    const timeout = getTimeout();\n    await sleep(timeout);\n\n    const meetTab = await getMeetTab();\n\n    await Clipboard.copy(meetTab);\n    await showHUD(\"Copied meet link to clipboard\");\n  } catch {\n    await showToast({\n      style: Toast.Style.Failure,\n      title: \"Couldn't copy to clipboard\",\n    });\n  }\n}\n", "import { getPreferenceValues, open } from \"@raycast/api\";\nimport { runAppleScript } from \"run-applescript\";\nimport {\n  getOpenedBrowserScript,\n  getOpenedUrlForArc,\n  getOpenedUrlForFirefox,\n  getOpenedUrlsScript,\n  supportedBrowsers,\n} from \"./utils/scripts\";\n\nimport type { SupportedBrowsers } from \"./utils/scripts\";\n\nconst openMeetTabUrl = \"https://meet.google.com/new\";\nconst timeoutRegex = /^[0-9]+$/;\nconst defaultTimeoutMs = 500;\n\nfunction isSupportedBrowserName(name: string): name is SupportedBrowsers {\n  return supportedBrowsers.includes(name as SupportedBrowsers);\n}\n\nexport function getTimeout(): number {\n  const prefs = getPreferenceValues<Preferences>();\n  return timeoutRegex.test(prefs.timeout) ? Number.parseInt(prefs.timeout, 10) : defaultTimeoutMs;\n}\n\nfunction getPreferredBrowser() {\n  return getPreferenceValues<Preferences>().preferredBrowser;\n}\n\nexport function sleep(ms: number): Promise<void> {\n  return new Promise((resolve) => setTimeout(resolve, ms));\n}\n\nasync function getOpenTabs(): Promise<string> {\n  const browserName = await getOpenedBrowser();\n\n  if (browserName === \"Arc\") {\n    return await runAppleScript(getOpenedUrlForArc());\n  }\n\n  if (browserName === \"Firefox\" || browserName === \"Firefox Developer Edition\" || browserName === \"Zen\") {\n    return await runAppleScript(getOpenedUrlForFirefox(browserName));\n  }\n\n  return await runAppleScript(getOpenedUrlsScript(browserName));\n}\n\nexport async function getOpenedBrowser(): Promise<SupportedBrowsers> {\n  const preferredBrowser = getPreferredBrowser();\n\n  if (preferredBrowser?.name && isSupportedBrowserName(preferredBrowser.name)) {\n    return preferredBrowser.name;\n  }\n\n  return (await runAppleScript(getOpenedBrowserScript)) as SupportedBrowsers;\n}\n\n/**\n * This needs be a recursive function because at first meet URL is not generated\n * but it depends on the browser to generate the correct URL, since it would not\n * be optimal to time it (setTimeout or something like that) because it's not possible\n * to guess if it would take a long time or not to generate the correct URL, being\n * recursive works pretty ok, since it's not a big workload to process.\n */\nexport async function getMeetTab(): Promise<string> {\n  const activeUrls = await getOpenTabs();\n  const meetTab = activeUrls.split(\",\").find((url) => url.includes(\"meet.google.com\"));\n\n  if (meetTab?.includes(\"/new\")) {\n    return await getMeetTab();\n  }\n\n  return meetTab as string;\n}\n\nexport async function openMeetTabDefaultProfile(): Promise<void> {\n  const preferredBrowser = getPreferredBrowser();\n\n  await open(openMeetTabUrl, preferredBrowser?.name);\n}\n\nexport async function openMeetTabSelectedProfile(profile: string): Promise<void> {\n  const preferredBrowser = getPreferredBrowser();\n\n  await open(`${openMeetTabUrl}?authuser=${profile}`, preferredBrowser?.name);\n}\n", "import process from 'node:process';\nimport {promisify} from 'node:util';\nimport {execFile, execFileSync} from 'node:child_process';\n\nconst execFileAsync = promisify(execFile);\n\nexport async function runAppleScript(script, {humanReadableOutput = true, signal} = {}) {\n\tif (process.platform !== 'darwin') {\n\t\tthrow new Error('macOS only');\n\t}\n\n\tconst outputArguments = humanReadableOutput ? [] : ['-ss'];\n\n\tconst execOptions = {};\n\tif (signal) {\n\t\texecOptions.signal = signal;\n\t}\n\n\tconst {stdout} = await execFileAsync('osascript', ['-e', script, outputArguments], execOptions);\n\treturn stdout.trim();\n}\n\nexport function runAppleScriptSync(script, {humanReadableOutput = true} = {}) {\n\tif (process.platform !== 'darwin') {\n\t\tthrow new Error('macOS only');\n\t}\n\n\tconst outputArguments = humanReadableOutput ? [] : ['-ss'];\n\n\tconst stdout = execFileSync('osascript', ['-e', script, ...outputArguments], {\n\t\tencoding: 'utf8',\n\t\tstdio: ['ignore', 'pipe', 'ignore'],\n\t\ttimeout: 500,\n\t});\n\n\treturn stdout.trim();\n}\n", "/**\n * Get current tab URL\n *\n * @param browserName selected browser name\n *\n * @returns Google Meet url i.e `https://meet.google.com/pen-adzt-swz`\n */\nexport function getOpenedUrlsScript(browserName: SupportedBrowsers): string {\n  return `\n    tell application \"${browserName}\"\n      set currentTab to active tab of front window\n      set tabURL to URL of currentTab\n      return tabURL\n    end tell\n  `;\n}\n\n/**\n * Get current tab URL for Arc\n * @returns Google Meet url i.e `https://meet.google.com/pen-adzt-swz`\n */\nexport function getOpenedUrlForArc() {\n  return `\n    tell application \"Arc\"\n      tell front window\n        set activeTabURL to URL of active tab\n        return activeTabURL\n      end tell\n    end tell\n  `;\n}\n\n/**\n * Firefox has little to no support to Applescript, this a very hacky solution, but it works\n * 1. Focus the browser\n * 2. Use the `cmd + l` to focus on the URL bar\n * 3. Use `cmd + c` to copy to the clipboard\n * 4. Press `Escape` key to closes the URL bar focus\n * 5. Returns the copied URL\n *\n * @param browserName `Firefox | Firefox Developer Edition`\n *\n * @returns Google Meet url i.e `https://meet.google.com/pen-adzt-swz`\n */\nexport function getOpenedUrlForFirefox(browserName: string) {\n  return `\n    tell application \"${browserName}\"\n      activate\n      delay 0.5\n      \n      tell application \"System Events\"\n        keystroke \"l\" using {command down}\n        delay 0.2\n        keystroke \"c\" using {command down}\n        delay 0.5\n        key code 53\n      end tell\n    end tell\n      \n    delay 0.5\n    \n    set copiedURL to do shell script \"pbpaste\"\n    \n    return copiedURL\n  `;\n}\n\nexport const supportedBrowsers = [\n  \"Arc\",\n  \"Brave\",\n  \"Firefox\",\n  \"Firefox Developer Edition\",\n  \"Google Chrome\",\n  \"Microsoft Edge\",\n  \"Mozilla Firefox\",\n  \"Opera\",\n  \"QQ\",\n  \"Safari\",\n  \"Sogou Explorer\",\n  \"Vivaldi\",\n  \"Yandex\",\n  \"Zen\",\n] as const;\n\n// Easy way to access the focused window when the meet link opens\nexport const getOpenedBrowserScript = `\n    set cmd to \"lsappinfo metainfo | grep -E -o '${supportedBrowsers.join(\"|\")}' | head -1\"\n\n    set frontmostBrowser to do shell script cmd\n\n    return frontmostBrowser\n`;\n\nexport type SupportedBrowsers = (typeof supportedBrowsers)[number];\n"],
  "mappings": "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",
  "names": ["default_profile_exports", "__export", "main", "__toCommonJS", "import_api", "import_api", "import_node_process", "import_node_util", "import_node_child_process", "execFileAsync", "runAppleScript", "script", "humanReadableOutput", "signal", "process", "outputArguments", "execOptions", "stdout", "getOpenedUrlsScript", "browserName", "getOpenedUrlForArc", "getOpenedUrlForFirefox", "supportedBrowsers", "getOpenedBrowserScript", "openMeetTabUrl", "timeoutRegex", "defaultTimeoutMs", "isSupportedBrowserName", "name", "supportedBrowsers", "getTimeout", "prefs", "getPreferredBrowser", "sleep", "ms", "resolve", "getOpenTabs", "browserName", "getOpenedBrowser", "runAppleScript", "getOpenedUrlForArc", "getOpenedUrlForFirefox", "getOpenedUrlsScript", "preferredBrowser", "getOpenedBrowserScript", "getMeetTab", "meetTab", "url", "openMeetTabDefaultProfile", "main", "openMeetTabDefaultProfile", "timeout", "getTimeout", "sleep", "meetTab", "getMeetTab"]
}
