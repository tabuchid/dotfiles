"use strict";var C=Object.defineProperty;var $=Object.getOwnPropertyDescriptor;var E=Object.getOwnPropertyNames;var L=Object.prototype.hasOwnProperty;var H=(n,s)=>{for(var r in s)C(n,r,{get:s[r],enumerable:!0})},V=(n,s,r,m)=>{if(s&&typeof s=="object"||typeof s=="function")for(let i of E(s))!L.call(n,i)&&i!==r&&C(n,i,{get:()=>s[i],enumerable:!(m=$(s,i))||m.enumerable});return n};var M=n=>V(C({},"__esModule",{value:!0}),n);var F={};H(F,{default:()=>N});module.exports=M(F);var t=require("@raycast/api"),o=require("react");var l=require("@raycast/api"),u=require("fs/promises"),d=require("path");function U(n){return n.sort((s,r)=>k(s)-k(r)),n}function y(n,s){return U(n),n.map(r=>{if(typeof r=="object"){if("max-age"in r)return`max-age=${r["max-age"]}`;if("s-maxage"in r)return`s-maxage=${r["s-maxage"]}`;if("stale-while-revalidate"in r)return`stale-while-revalidate=${r["stale-while-revalidate"]}`;if("stale-if-error"in r)return`stale-if-error=${r["stale-if-error"]}`}else return r}).join(s?", ":",")}function k(n){if(typeof n=="object"){if("max-age"in n)return 4;if("s-maxage"in n)return 5;if("stale-while-revalidate"in n)return 6;if("stale-if-error"in n)return 7}else switch(n){case"private":return 1;case"public":return 2;case"no-cache":return 3;case"immutable":return 8;case"must-revalidate":return 9;case"proxy-revalidate":return 10;case"no-transform":return 11;case"must-understand":return 12;case"no-store":return 13}return Number.MAX_VALUE}function T(n){if(typeof n=="object"){if("max-age"in n)return"max-age=N";if("s-maxage"in n)return"s-maxage=N";if("stale-while-revalidate"in n)return"stale-while-revalidate=N";if("stale-if-error"in n)return"stale-if-error=N"}return n}function A(n){if(typeof n=="object"){if("max-age"in n)return;if("s-maxage"in n)return"duration the response remains fresh - specific for shared caches";if("stale-while-revalidate"in n)return"reuse stale response while cache is revalidated";if("stale-if-error"in n)return"reuse stale responses when an origin responds with an error"}else switch(n){case"no-cache":return;case"no-store":return;case"no-transform":return"intermediaries shouldn't transform the response contents";case"must-revalidate":return"must revalidate before reusing cache";case"proxy-revalidate":return"shared caches (e.g. Proxies) revalidate before reusing cache";case"must-understand":return"only store cache if requirements for caching based on status code is understood";case"private":return;case"public":return;case"immutable":return"revalidation not necessary (use e.g. for resources with hashed URLs)"}}async function x(n){if(typeof n=="object"){if("max-age"in n)return await(0,u.readFile)((0,d.join)(l.environment.assetsPath,"docs/max-age.md"),{encoding:"utf-8"});if("s-maxage"in n)return await(0,u.readFile)((0,d.join)(l.environment.assetsPath,"docs/s-maxage.md"),{encoding:"utf-8"});if("stale-while-revalidate"in n)return await(0,u.readFile)((0,d.join)(l.environment.assetsPath,"docs/stale-while-revalidate.md"),{encoding:"utf-8"});if("stale-if-error"in n)return await(0,u.readFile)((0,d.join)(l.environment.assetsPath,"docs/stale-if-error.md"),{encoding:"utf-8"})}else switch(n){case"no-cache":return await(0,u.readFile)((0,d.join)(l.environment.assetsPath,"docs/no-cache.md"),{encoding:"utf-8"});case"no-store":return await(0,u.readFile)((0,d.join)(l.environment.assetsPath,"docs/no-store.md"),{encoding:"utf-8"});case"no-transform":return await(0,u.readFile)((0,d.join)(l.environment.assetsPath,"docs/no-transform.md"),{encoding:"utf-8"});case"must-revalidate":return await(0,u.readFile)((0,d.join)(l.environment.assetsPath,"docs/must-revalidate.md"),{encoding:"utf-8"});case"proxy-revalidate":return await(0,u.readFile)((0,d.join)(l.environment.assetsPath,"docs/proxy-revalidate.md"),{encoding:"utf-8"});case"must-understand":return await(0,u.readFile)((0,d.join)(l.environment.assetsPath,"docs/must-understand.md"),{encoding:"utf-8"});case"private":return await(0,u.readFile)((0,d.join)(l.environment.assetsPath,"docs/private.md"),{encoding:"utf-8"});case"public":return await(0,u.readFile)((0,d.join)(l.environment.assetsPath,"docs/public.md"),{encoding:"utf-8"});case"immutable":return await(0,u.readFile)((0,d.join)(l.environment.assetsPath,"docs/immutable.md"),{encoding:"utf-8"})}return null}var e=require("react/jsx-runtime");function N(){let{push:n}=(0,t.useNavigation)();return(0,e.jsxs)(t.List,{searchBarPlaceholder:"Where is the response allowed to be stored?",children:[(0,e.jsx)(t.List.Item,{title:"shared",subtitle:"private and shared cache",accessoryIcon:t.Icon.ArrowRight,accessoryTitle:"Browser, Proxies, CDNs",actions:(0,e.jsx)(t.ActionPanel,{children:(0,e.jsx)(t.Action,{title:"Select",onAction:()=>n((0,e.jsx)(P,{directive:"max-age",directives:[]}))})})}),(0,e.jsx)(t.List.Item,{title:"public",subtitle:"private and shared cache including requests with `Authorization` header",accessoryIcon:t.Icon.ArrowRight,accessoryTitle:"Browser, Proxies, CDNs",actions:(0,e.jsxs)(t.ActionPanel,{children:[(0,e.jsx)(t.Action,{title:"Select",onAction:()=>n((0,e.jsx)(P,{directive:"max-age",directives:["public"]}))}),(0,e.jsx)(t.Action,{title:"Show `public` Docs",onAction:()=>n((0,e.jsx)(p,{directive:"public"}))})]})}),(0,e.jsx)(t.List.Item,{title:"private",subtitle:"private cache only",accessoryIcon:t.Icon.ArrowRight,accessoryTitle:"Browser",actions:(0,e.jsxs)(t.ActionPanel,{children:[(0,e.jsx)(t.Action,{title:"Select",onAction:()=>n((0,e.jsx)(P,{directive:"max-age",directives:["private"]}))}),(0,e.jsx)(t.Action,{title:"Show `private` Docs",onAction:()=>n((0,e.jsx)(p,{directive:"private"}))})]})}),(0,e.jsx)(t.List.Item,{title:"no-store",subtitle:"don't store at all",actions:(0,e.jsxs)(t.ActionPanel,{children:[(0,e.jsx)(t.Action,{title:"Finish",onAction:()=>n((0,e.jsx)(S,{directives:["no-store"]}))}),(0,e.jsx)(t.Action,{title:"Show `no-store` Docs",onAction:()=>n((0,e.jsx)(p,{directive:"no-store"}))})]})})]})}function P({directive:n,directives:s,onSelect:r}){let{push:m,pop:i}=(0,t.useNavigation)(),[h,f]=(0,o.useState)("hours"),[v,D]=(0,o.useState)("1"),g=(0,o.useMemo)(()=>{let c=parseFloat(v);if(!c||c<0||isNaN(c))return!1;switch(h){case"seconds":default:return Math.round(c);case"minutes":return Math.round(c*60);case"hours":return Math.round(c*60*60);case"days":return Math.round(c*60*60*24);case"weeks":return Math.round(c*60*60*24*7);case"months":return Math.round(c*60*60*24*(365.25/12));case"years":return Math.round(c*60*60*24*365.25)}},[v,h]);return(0,e.jsxs)(t.List,{navigationTitle:`${n}=`,searchBarPlaceholder:"How long is the cache valid?",searchText:v,onSearchTextChange:D,searchBarAccessory:(0,e.jsxs)(t.List.Dropdown,{tooltip:"select duration unit",defaultValue:h,onChange:f,storeValue:!0,children:[(0,e.jsx)(t.List.Dropdown.Item,{value:"seconds",title:"seconds"}),(0,e.jsx)(t.List.Dropdown.Item,{value:"minutes",title:"minutes"}),(0,e.jsx)(t.List.Dropdown.Item,{value:"hours",title:"hours"}),(0,e.jsx)(t.List.Dropdown.Item,{value:"days",title:"days"}),(0,e.jsx)(t.List.Dropdown.Item,{value:"weeks",title:"weeks"}),(0,e.jsx)(t.List.Dropdown.Item,{value:"months",title:"months"}),(0,e.jsx)(t.List.Dropdown.Item,{value:"years",title:"years"})]}),children:[g&&(0,e.jsx)(t.List.Item,{title:String(g),subtitle:"seconds",accessoryIcon:r?void 0:t.Icon.ArrowRight,actions:(0,e.jsxs)(t.ActionPanel,{children:[(0,e.jsx)(t.Action,{title:"Select",onAction:()=>{r?(r(g),i()):m((0,e.jsx)(B,{directives:[...s,{[n]:g}]}))}}),!r&&(0,e.jsx)(t.Action,{title:"Finish",onAction:()=>m((0,e.jsx)(S,{directives:[...s,{[n]:g}]}))}),(0,e.jsx)(t.Action,{title:"Show `max-age` docs",onAction:()=>m((0,e.jsx)(p,{directive:{[n]:0}}))})]})}),n==="max-age"&&(0,e.jsx)(t.List.Item,{title:"no-cache",subtitle:"store in caches but revalidate before reuse",actions:(0,e.jsxs)(t.ActionPanel,{children:[(0,e.jsx)(t.Action,{title:"Finish",onAction:()=>m((0,e.jsx)(S,{directives:[...s,"no-cache"]}))}),(0,e.jsx)(t.Action,{title:"Show `no-cache` Docs",onAction:()=>m((0,e.jsx)(p,{directive:"no-cache"}))})]})})]})}var j=["immutable","must-revalidate","proxy-revalidate"],_=["s-maxage","stale-while-revalidate","stale-if-error"];function B({directives:n}){let{push:s}=(0,t.useNavigation)(),[r,m]=(0,o.useState)(!1),[i,h]=(0,o.useState)(null),[f,v]=(0,o.useState)({"s-maxage":null,"stale-while-revalidate":null,"stale-if-error":null}),[D,g]=(0,o.useState)(!1),[c,R]=(0,o.useState)(!1),b=(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(t.Action,{title:"Finish header",onAction:()=>s((0,e.jsx)(S,{directives:[...n,...i?[i]:[],...Object.entries(f).filter(([,a])=>a!==null).map(([a,w])=>({[a]:w})),...D?["must-understand","no-store"]:[],...c?["no-transform"]:[]]}))}),(0,e.jsx)(t.Action,{title:"Toggle Docs Split",onAction:()=>m(a=>!a)})]});return(0,e.jsxs)(t.List,{navigationTitle:"Other Options",isShowingDetail:r,children:[(0,e.jsx)(t.List.Section,{title:"Revalidation",children:j.map(a=>(0,e.jsx)(t.List.Item,{title:a,subtitle:A(a),detail:(0,e.jsx)(I,{directive:a}),accessoryIcon:i===a?t.Icon.Checkmark:t.Icon.Circle,actions:(0,e.jsxs)(t.ActionPanel,{children:[i===a?(0,e.jsx)(t.Action,{title:"Deselect",onAction:()=>h(null)}):(0,e.jsx)(t.Action,{title:"Select",onAction:()=>h(a)}),b,(0,e.jsx)(t.Action,{title:`Open \`${a}\` Docs`,onAction:()=>s((0,e.jsx)(p,{directive:a}))})]})},a))}),(0,e.jsxs)(t.List.Section,{title:"Other",children:[_.map(a=>(0,e.jsx)(t.List.Item,{title:a,subtitle:A({[a]:0}),detail:(0,e.jsx)(I,{directive:{[a]:0}}),accessoryIcon:f[a]!==null?t.Icon.Checkmark:t.Icon.ArrowRight,accessoryTitle:f[a]!==null?`${f[a]} seconds`:void 0,actions:(0,e.jsxs)(t.ActionPanel,{children:[f[a]!==null?(0,e.jsx)(t.Action,{title:"Deselect",onAction:()=>v(w=>({...w,[a]:null}))}):(0,e.jsx)(t.Action,{title:"Select",onAction:()=>s((0,e.jsx)(P,{directives:[],directive:a,onSelect:w=>v(O=>({...O,[a]:w}))}))}),b,(0,e.jsx)(t.Action,{title:`Open \`${a}\` docs`,onAction:()=>s((0,e.jsx)(p,{directive:{[a]:0}}))})]})},a)),(0,e.jsx)(t.List.Item,{title:"no-transform",subtitle:A("no-transform"),detail:(0,e.jsx)(I,{directive:"no-transform"}),accessoryIcon:c?t.Icon.Checkmark:t.Icon.Circle,actions:(0,e.jsxs)(t.ActionPanel,{children:[c?(0,e.jsx)(t.Action,{title:"Deselect",onAction:()=>R(!1)}):(0,e.jsx)(t.Action,{title:"Select",onAction:()=>R(!0)}),b,(0,e.jsx)(t.Action,{title:"Open `no-transform` Docs",onAction:()=>s((0,e.jsx)(p,{directive:"no-transform"}))})]})}),(0,e.jsx)(t.List.Item,{title:"must-understand",subtitle:A("must-understand"),detail:(0,e.jsx)(I,{directive:"must-understand"}),accessoryIcon:D?t.Icon.Checkmark:t.Icon.Circle,actions:(0,e.jsxs)(t.ActionPanel,{children:[D?(0,e.jsx)(t.Action,{title:"Deselect",onAction:()=>g(!1)}):(0,e.jsx)(t.Action,{title:"Select",onAction:()=>g(!0)}),b,(0,e.jsx)(t.Action,{title:"Open `must-understand` docs",onAction:()=>s((0,e.jsx)(p,{directive:"must-understand"}))})]})})]})]})}function S({directives:n}){let[s,r]=(0,o.useState)(void 0);return(0,o.useEffect)(()=>{async function m(){let i="";for(let h of n){let f=await x(h);f&&(i+=`#### ${T(h)}
${f}
`)}i!==""&&(i+=`

Source: [mdn](https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Cache-Control)`),r(i)}m()},[n]),(0,e.jsx)(t.Detail,{navigationTitle:"Cache-Control:",isLoading:s===void 0,markdown:`# Cache-Control: ${y(n,!0)}
${s??""}`,actions:(0,e.jsxs)(t.ActionPanel,{children:[(0,e.jsx)(t.Action.CopyToClipboard,{title:"Copy Header Value",content:y(n,!0)}),(0,e.jsx)(t.Action.CopyToClipboard,{title:"Copy Header Value without spaces",content:y(n,!1)})]})})}function p({directive:n}){let[s,r]=(0,o.useState)(void 0);return(0,o.useEffect)(()=>{x(n).then(r)}),(0,e.jsx)(t.Detail,{navigationTitle:`Docs: ${T(n)}`,isLoading:s===void 0,markdown:s?`${s}

Source: [mdn](https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Cache-Control)`:"Not found"})}function I({directive:n}){let[s,r]=(0,o.useState)(void 0);return(0,o.useEffect)(()=>{x(n).then(r)}),(0,e.jsx)(t.List.Item.Detail,{isLoading:s===void 0,markdown:s?`${s}

Source: [mdn](https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Cache-Control)`:"Not found"})}
