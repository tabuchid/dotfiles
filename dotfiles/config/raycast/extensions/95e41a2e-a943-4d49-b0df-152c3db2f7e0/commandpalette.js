"use strict";var W=Object.create;var u=Object.defineProperty;var D=Object.getOwnPropertyDescriptor;var $=Object.getOwnPropertyNames;var B=Object.getPrototypeOf,J=Object.prototype.hasOwnProperty;var K=(e,n)=>{for(var t in n)u(e,t,{get:n[t],enumerable:!0})},F=(e,n,t,s)=>{if(n&&typeof n=="object"||typeof n=="function")for(let i of $(n))!J.call(e,i)&&i!==t&&u(e,i,{get:()=>n[i],enumerable:!(s=D(n,i))||s.enumerable});return e};var f=(e,n,t)=>(t=e!=null?W(B(e)):{},F(n||!e||!e.__esModule?u(t,"default",{value:e,enumerable:!0}):t,e)),_=e=>F(u({},"__esModule",{value:!0}),e);var ne={};K(ne,{default:()=>L});module.exports=_(ne);var o=require("@raycast/api"),a=f(require("fs/promises")),b=f(require("os")),l=f(require("path")),d=require("react");var E=require("@raycast/api");var A=require("@raycast/api"),g=f(require("fs"));function x(e){return e instanceof Error?e.message:"unknown error"}async function y(e){return g.promises.access(e,g.constants.F_OK).then(()=>!0).catch(()=>!1)}var ie=new Intl.NumberFormat("en",{notation:"compact"});function q(e){return new Promise(n=>setTimeout(n,e))}async function R(e,n=2e3){let t=new Date;for(;t.getTime()>0;){if(await q(10),await y(e))return!0;if(new Date().getTime()-t.getTime()>n)return!1}return!1}function h(e){return`${C()}://tonka3000.raycast/${e}`}async function I(e){await(0,A.open)(h(e))}var S=process.platform==="win32",P=process.platform==="darwin";var v=require("@raycast/api");function V(e,n){let t,s;function i(...p){return(t===void 0||n?.maxAge&&s!==void 0&&Date.now()-s>n.maxAge)&&(t=e(...p),s=Date.now()),t}return i.clear=()=>{t=void 0,s=void 0},i}var me=V(v.getApplications);var N=require("@raycast/api"),c=(0,N.getPreferenceValues)(),G=c.build,pe=c.layout,ue=c.keepSectionOrder,fe=c.closeOtherWindows,ge=c.terminalApp,ye=c.showGitBranch,Ce=c.gitBranchColor;function k(){return(0,E.getPreferenceValues)().build}var T={Antigravity:"antigravity",Code:"vscode","Code - Insiders":"vscode-insiders",Cursor:"cursor",Kiro:"kiro",VSCodium:"vscode-oss",Positron:"positron",Windsurf:"windsurf",Trae:"trae","Trae CN":"trae-cn"};function C(){let e=T[k()];return!e||e.length<=0?T.Code:e}var r=require("react/jsx-runtime");function H(){let e=k(),n=l.default.join(b.homedir(),`Library/Application Support/${e}/User/globalStorage/tonka3000.raycast/transit`);return S&&(n=l.default.join(b.homedir(),`AppData/Roaming/${e}/User/globalStorage/tonka3000.raycast/transit`)),n}function Q(e){let n=e.command,t=n.category?`${n.category}: ${n.title}`:n.title;return(0,r.jsx)(o.Action.CreateQuicklink,{shortcut:{modifiers:["cmd"],key:"l"},quicklink:{link:h(`runcommand?cmd=${n.command}`),name:`VSCode - ${t}`}})}async function z(){let e=H();await a.mkdir(e,{recursive:!0});let n=l.default.join(e,"request.json"),t=l.default.join(e,"commands.json");if(await a.writeFile(n,JSON.stringify({command:"writecommands",args:{filename:t}},null,2)),await y(t)&&await a.rm(t),await R(t))return await Z(t);throw new Error("Could not get VSCode commands")}function X(e){let n=e.command,t=i=>i.category?`${i.category}: ${i.title}`:i.title,s=async()=>{try{await I(`runcommand?cmd=${n.command}`),(0,o.popToRoot)()}catch(i){(0,o.showToast)({style:o.Toast.Style.Failure,title:"Could not run Command",message:x(i)})}};return(0,r.jsx)(o.List.Item,{title:t(n),actions:(0,r.jsxs)(o.ActionPanel,{children:[(0,r.jsxs)(o.ActionPanel.Section,{children:[(0,r.jsx)(o.Action,{title:"Run Command",onAction:s,icon:{source:o.Icon.Terminal}}),(0,r.jsx)(Q,{command:n})]}),(0,r.jsx)(o.ActionPanel.Section,{children:(0,r.jsx)(o.Action.CopyToClipboard,{shortcut:{modifiers:["cmd","shift"],key:"."},title:"Copy Command ID",content:n.command})})]})})}function Y(){return(0,r.jsx)(o.Action.OpenInBrowser,{title:"Install Raycast for VS Code",url:`${C()}:extension/tonka3000.raycast`,onOpen:()=>{(0,o.popToRoot)(),(0,o.showHUD)("Open VSCode Extension")}})}function L(){let{isLoading:e,commands:n,error:t,refresh:s}=ee();return t&&(0,o.showToast)({style:o.Toast.Style.Failure,title:"Error",message:t}),(0,r.jsxs)(o.List,{isLoading:e,searchBarPlaceholder:e===!0?"Load Commands from VSCode":"Search Commands",children:[(0,r.jsx)(o.List.Section,{title:"Commands",subtitle:`${n?.length}`,children:n?.map(i=>(0,r.jsx)(X,{command:i},i.command))}),t&&(0,r.jsx)(o.List.EmptyView,{title:"No Response from Raycast for VSCode extension",description:"Please ensure the Raycast for VSCode extension is installed and running",icon:"\u26A0\uFE0F",actions:(0,r.jsxs)(o.ActionPanel,{children:[(0,r.jsx)(o.Action,{title:"Reload",icon:o.Icon.RotateClockwise,shortcut:{modifiers:["cmd"],key:"r"},onAction:s}),(0,r.jsx)(Y,{})]})})]})}async function Z(e){let n=await a.readFile(e,"utf-8"),t=JSON.parse(n);return await a.rm(e),t}function ee(){let[e,n]=(0,d.useState)(!0),[t,s]=(0,d.useState)(),[i,p]=(0,d.useState)(),[O,j]=(0,d.useState)(new Date),M=()=>{j(new Date)};return(0,d.useEffect)(()=>{let m=!1;async function U(){if(!m){n(!0),p(void 0);try{let w=await z();m||s(w)}catch(w){m||p(x(w))}finally{m||n(!1)}}}return U(),()=>{m=!0}},[O]),{commands:t,isLoading:e,error:i,refresh:M}}
