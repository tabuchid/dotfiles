"use strict";var We=Object.create;var Z=Object.defineProperty;var Fe=Object.getOwnPropertyDescriptor;var je=Object.getOwnPropertyNames;var ze=Object.getPrototypeOf,Be=Object.prototype.hasOwnProperty;var Ge=(e,t)=>{for(var r in t)Z(e,r,{get:t[r],enumerable:!0})},be=(e,t,r,n)=>{if(t&&typeof t=="object"||typeof t=="function")for(let s of je(t))!Be.call(e,s)&&s!==r&&Z(e,s,{get:()=>t[s],enumerable:!(n=Fe(t,s))||n.enumerable});return e};var T=(e,t,r)=>(r=e!=null?We(ze(e)):{},be(t||!e||!e.__esModule?Z(r,"default",{value:e,enumerable:!0}):r,e)),Ke=e=>be(Z({},"__esModule",{value:!0}),e);var xt={};Ge(xt,{default:()=>Ne});module.exports=Ke(xt);var w=require("@raycast/api");var l=T(require("react")),p=require("@raycast/api");var ye=Object.prototype.hasOwnProperty;function q(e,t){var r,n;if(e===t)return!0;if(e&&t&&(r=e.constructor)===t.constructor){if(r===Date)return e.getTime()===t.getTime();if(r===RegExp)return e.toString()===t.toString();if(r===Array){if((n=e.length)===t.length)for(;n--&&q(e[n],t[n]););return n===-1}if(!r||typeof e=="object"){n=0;for(r in e)if(ye.call(e,r)&&++n&&!ye.call(t,r)||!(r in t)||!q(e[r],t[r]))return!1;return Object.keys(t).length===n}}return e!==e&&t!==t}var L=T(require("node:fs")),Q=T(require("node:path")),ke=T(require("node:crypto"));var ve=require("react/jsx-runtime");function Je(e){let t=(0,l.useRef)(e),r=(0,l.useRef)(0);return q(e,t.current)||(t.current=e,r.current+=1),(0,l.useMemo)(()=>t.current,[r.current])}function E(e){let t=(0,l.useRef)(e);return t.current=e,t}function He(e,t){let r=e instanceof Error?e.message:String(e);return(0,p.showToast)({style:p.Toast.Style.Failure,title:t?.title??"Something went wrong",message:t?.message??r,primaryAction:t?.primaryAction??$e(e),secondaryAction:t?.primaryAction?$e(e):void 0})}var $e=e=>{let t=!0,r="[Extension Name]...",n="";try{let i=JSON.parse((0,L.readFileSync)((0,Q.join)(p.environment.assetsPath,"..","package.json"),"utf8"));r=`[${i.title}]...`,n=`https://raycast.com/${i.owner||i.author}/${i.name}`,(!i.owner||i.access==="public")&&(t=!1)}catch{}let s=p.environment.isDevelopment||t,a=e instanceof Error?e?.stack||e?.message||"":String(e);return{title:s?"Copy Logs":"Report Error",onAction(i){i.hide(),s?p.Clipboard.copy(a):(0,p.open)(`https://github.com/raycast/extensions/issues/new?&labels=extension%2Cbug&template=extension_bug_report.yml&title=${encodeURIComponent(r)}&extension-url=${encodeURI(n)}&description=${encodeURIComponent(`#### Error:
\`\`\`
${a}
\`\`\`
`)}`)}}};function oe(e,t,r){let n=(0,l.useRef)(0),[s,a]=(0,l.useState)({isLoading:!0}),i=E(e),c=E(r?.abortable),o=E(t||[]),u=E(r?.onError),d=E(r?.onData),f=E(r?.onWillExecute),y=E(r?.failureToastOptions),S=E(s.data),v=(0,l.useRef)(null),g=(0,l.useRef)({page:0}),x=(0,l.useRef)(!1),A=(0,l.useRef)(!0),U=(0,l.useRef)(50),k=(0,l.useCallback)(()=>(c.current&&(c.current.current?.abort(),c.current.current=new AbortController),++n.current),[c]),b=(0,l.useCallback)((...O)=>{let C=k();f.current?.(O),a(h=>({...h,isLoading:!0}));let M=Ze(i.current)(...O);function W(h){return h.name=="AbortError"||C===n.current&&(u.current?u.current(h):p.environment.launchType!==p.LaunchType.Background&&He(h,{title:"Failed to fetch latest data",primaryAction:{title:"Retry",onAction(D){D.hide(),v.current?.(...o.current||[])}},...y.current}),a({error:h,isLoading:!1})),h}return typeof M=="function"?(x.current=!0,M(g.current).then(({data:h,hasMore:D,cursor:Ve})=>(C===n.current&&(g.current&&(g.current.cursor=Ve,g.current.lastItem=h?.[h.length-1]),d.current&&d.current(h,g.current),D&&(U.current=h.length),A.current=D,a(Me=>g.current.page===0?{data:h,isLoading:!1}:{data:(Me.data||[])?.concat(h),isLoading:!1})),h),h=>(A.current=!1,W(h)))):(x.current=!1,M.then(h=>(C===n.current&&(d.current&&d.current(h),a({data:h,isLoading:!1})),h),W))},[d,u,o,i,a,v,f,g,y,k]);v.current=b;let R=(0,l.useCallback)(()=>{g.current={page:0};let O=o.current||[];return b(...O)},[b,o]),P=(0,l.useCallback)(async(O,C)=>{let M;try{if(C?.optimisticUpdate){k(),typeof C?.rollbackOnError!="function"&&C?.rollbackOnError!==!1&&(M=structuredClone(S.current?.value));let W=C.optimisticUpdate;a(h=>({...h,data:W(h.data)}))}return await O}catch(W){if(typeof C?.rollbackOnError=="function"){let h=C.rollbackOnError;a(D=>({...D,data:h(D.data)}))}else C?.optimisticUpdate&&C?.rollbackOnError!==!1&&a(h=>({...h,data:M}));throw W}finally{C?.shouldRevalidateAfter!==!1&&(p.environment.launchType===p.LaunchType.Background||p.environment.commandMode==="menu-bar"?await R():R())}},[R,S,a,k]),_=(0,l.useCallback)(()=>{g.current.page+=1;let O=o.current||[];b(...O)},[g,o,b]);(0,l.useEffect)(()=>{g.current={page:0},r?.execute!==!1?b(...t||[]):k()},[Je([t,r?.execute,b]),c,g]),(0,l.useEffect)(()=>()=>{k()},[k]);let B=r?.execute!==!1?s.isLoading:!1,G={...s,isLoading:B},H=x.current?{pageSize:U.current,hasMore:A.current,onLoadMore:_}:void 0;return{...G,revalidate:R,mutate:P,pagination:H}}function Ze(e){return e===Promise.all||e===Promise.race||e===Promise.resolve||e===Promise.reject?e.bind(Promise):e}function xe(e){return typeof e!="function"?!1:/^function\s+\w*\s*\(\s*\)\s*{\s+\[native code\]\s+}$/i.exec(Function.prototype.toString.call(e))!==null}function qe(e){return e instanceof URLSearchParams?e.toString():e}function Se(e,t=[]){function r(n){return"update"in e?e.update(n,"utf8"):e.write(n)}return{dispatch:function(n){n=qe(n),n===null?this._null():this["_"+typeof n](n)},_object:function(n){let s=/\[object (.*)\]/i,a=Object.prototype.toString.call(n),i=s.exec(a)?.[1]??"unknown:["+a+"]";i=i.toLowerCase();let c=null;if((c=t.indexOf(n))>=0){this.dispatch("[CIRCULAR:"+c+"]");return}else t.push(n);if(Buffer.isBuffer(n))return r("buffer:"),r(n.toString("utf8"));if(i!=="object"&&i!=="function"&&i!=="asyncfunction")if(this["_"+i])this["_"+i](n);else throw new Error('Unknown object type "'+i+'"');else{let o=Object.keys(n);o=o.sort(),xe(n)||o.splice(0,0,"prototype","__proto__","constructor"),r("object:"+o.length+":");let u=this;return o.forEach(function(d){u.dispatch(d),r(":"),u.dispatch(n[d]),r(",")})}},_array:function(n,s){s=typeof s<"u"?s:!1;let a=this;if(r("array:"+n.length+":"),!s||n.length<=1){n.forEach(function(o){a.dispatch(o)});return}let i=[],c=n.map(function(o){let u=Ye(),d=t.slice();return Se(u,d).dispatch(o),i=i.concat(d.slice(t.length)),u.read().toString()});t=t.concat(i),c.sort(),this._array(c,!1)},_date:function(n){r("date:"+n.toJSON())},_symbol:function(n){r("symbol:"+n.toString())},_error:function(n){r("error:"+n.toString())},_boolean:function(n){r("bool:"+n.toString())},_string:function(n){r("string:"+n.length+":"),r(n.toString())},_function:function(n){r("fn:"),xe(n)?this.dispatch("[native]"):this.dispatch(n.toString()),this.dispatch("function-name:"+String(n.name)),this._object(n)},_number:function(n){r("number:"+n.toString())},_xml:function(n){r("xml:"+n.toString())},_null:function(){r("Null")},_undefined:function(){r("Undefined")},_regexp:function(n){r("regex:"+n.toString())},_uint8array:function(n){r("uint8array:"),this.dispatch(Array.prototype.slice.call(n))},_uint8clampedarray:function(n){r("uint8clampedarray:"),this.dispatch(Array.prototype.slice.call(n))},_int8array:function(n){r("int8array:"),this.dispatch(Array.prototype.slice.call(n))},_uint16array:function(n){r("uint16array:"),this.dispatch(Array.prototype.slice.call(n))},_int16array:function(n){r("int16array:"),this.dispatch(Array.prototype.slice.call(n))},_uint32array:function(n){r("uint32array:"),this.dispatch(Array.prototype.slice.call(n))},_int32array:function(n){r("int32array:"),this.dispatch(Array.prototype.slice.call(n))},_float32array:function(n){r("float32array:"),this.dispatch(Array.prototype.slice.call(n))},_float64array:function(n){r("float64array:"),this.dispatch(Array.prototype.slice.call(n))},_arraybuffer:function(n){r("arraybuffer:"),this.dispatch(new Uint8Array(n))},_url:function(n){r("url:"+n.toString())},_map:function(n){r("map:");let s=Array.from(n);this._array(s,!0)},_set:function(n){r("set:");let s=Array.from(n);this._array(s,!0)},_file:function(n){r("file:"),this.dispatch([n.name,n.size,n.type,n.lastModified])},_blob:function(){throw Error(`Hashing Blob objects is currently not supported
(see https://github.com/puleos/object-hash/issues/26)
Use "options.replacer" or "options.ignoreUnknown"
`)},_domwindow:function(){r("domwindow")},_bigint:function(n){r("bigint:"+n.toString())},_process:function(){r("process")},_timer:function(){r("timer")},_pipe:function(){r("pipe")},_tcp:function(){r("tcp")},_udp:function(){r("udp")},_tty:function(){r("tty")},_statwatcher:function(){r("statwatcher")},_securecontext:function(){r("securecontext")},_connection:function(){r("connection")},_zlib:function(){r("zlib")},_context:function(){r("context")},_nodescript:function(){r("nodescript")},_httpparser:function(){r("httpparser")},_dataview:function(){r("dataview")},_signal:function(){r("signal")},_fsevent:function(){r("fsevent")},_tlswrap:function(){r("tlswrap")}}}function Ye(){return{buf:"",write:function(e){this.buf+=e},end:function(e){this.buf+=e},read:function(){return this.buf}}}function Qe(e,t){let r=this[e];return r instanceof Date?`__raycast_cached_date__${r.toISOString()}`:Buffer.isBuffer(r)?`__raycast_cached_buffer__${r.toString("base64")}`:t}function Xe(e,t){return typeof t=="string"&&t.startsWith("__raycast_cached_date__")?new Date(t.replace("__raycast_cached_date__","")):typeof t=="string"&&t.startsWith("__raycast_cached_buffer__")?Buffer.from(t.replace("__raycast_cached_buffer__",""),"base64"):t}function Y(e){let t=ke.default.createHash("sha1");return Se(t).dispatch(e),t.digest("hex")}var et=Symbol("cache without namespace"),we=new Map;function tt(e,t,r){let n=r?.cacheNamespace||et,s=we.get(n)||we.set(n,new p.Cache({namespace:r?.cacheNamespace})).get(n);if(!s)throw new Error("Missing cache");let a=E(e),i=E(t),c=(0,l.useSyncExternalStore)(s.subscribe,()=>{try{return s.get(a.current)}catch(f){console.error("Could not get Cache data:",f);return}}),o=(0,l.useMemo)(()=>{if(typeof c<"u"){if(c==="undefined")return;try{return JSON.parse(c,Xe)}catch(f){return console.warn("The cached data is corrupted",f),i.current}}else return i.current},[c,i]),u=E(o),d=(0,l.useCallback)(f=>{let y=typeof f=="function"?f(u.current):f;if(typeof y>"u")s.set(a.current,"undefined");else{let S=JSON.stringify(y,Qe);s.set(a.current,S)}return y},[s,a,u]);return[o,d]}var F=Symbol();function nt(e,t,r){let{initialData:n,keepPreviousData:s,internal_cacheKeySuffix:a,...i}=r||{},c=(0,l.useRef)(null),[o,u]=tt(Y(t||[])+a,F,{cacheNamespace:Y(e)}),d=(0,l.useRef)(o!==F?o:n),f=(0,l.useRef)(void 0),{mutate:y,revalidate:S,...v}=oe(e,t||[],{...i,onData(k,b){f.current=b,i.onData&&i.onData(k,b),!(b&&b.page>0)&&(c.current="promise",d.current=k,u(k))}}),g,x=v.pagination;f.current&&f.current.page>0&&v.data?g=v.data:c.current==="promise"?g=d.current:s&&o!==F?(g=o,x&&(x.hasMore=!0,x.pageSize=o.length)):s&&o===F?g=d.current:o!==F?(g=o,x&&(x.hasMore=!0,x.pageSize=o.length)):g=n;let A=E(g),U=(0,l.useCallback)(async(k,b)=>{let R;try{if(b?.optimisticUpdate){typeof b?.rollbackOnError!="function"&&b?.rollbackOnError!==!1&&(R=structuredClone(A.current));let P=b.optimisticUpdate(A.current);c.current="cache",d.current=P,u(P)}return await y(k,{shouldRevalidateAfter:b?.shouldRevalidateAfter})}catch(P){if(typeof b?.rollbackOnError=="function"){let _=b.rollbackOnError(A.current);c.current="cache",d.current=_,u(_)}else b?.optimisticUpdate&&b?.rollbackOnError!==!1&&(c.current="cache",d.current=R,u(R));throw P}},[u,y,A,d,c]);return(0,l.useEffect)(()=>{o!==F&&(c.current="cache",d.current=o)},[o]),{data:g,isLoading:v.isLoading,error:v.error,mutate:f.current&&f.current.page>0?y:U,pagination:x,revalidate:S}}function rt(e){if(e){let t=st(e);if(!t)return!1;if(t.subtype==="json"||t.suffix==="json"||t.suffix&&/\bjson\b/i.test(t.suffix)||t.subtype&&/\bjson\b/i.test(t.subtype))return!0}return!1}var at=/^([A-Za-z0-9][A-Za-z0-9!#$&^_-]{0,126})\/([A-Za-z0-9][A-Za-z0-9!#$&^_.+-]{0,126});?$/;function st(e){let t=e.indexOf(";"),r=t!==-1?e.slice(0,t).trim():e.trim(),n=at.exec(r.toLowerCase().toLowerCase());if(!n)return;let s=n[1],a=n[2],i,c=a.lastIndexOf("+");return c!==-1&&(i=a.substring(c+1),a=a.substring(0,c)),{type:s,subtype:a,suffix:i}}async function it(e){if(!e.ok)throw new Error(e.statusText);let t=e.headers.get("content-type");return t&&rt(t)?await e.json():await e.text()}function ot(e){return{data:e,hasMore:!1}}function Ee(e,t){let{parseResponse:r,mapResult:n,initialData:s,execute:a,keepPreviousData:i,onError:c,onData:o,onWillExecute:u,failureToastOptions:d,...f}=t||{},y={initialData:s,execute:a,keepPreviousData:i,onError:c,onData:o,onWillExecute:u,failureToastOptions:d},S=E(r||it),v=E(n||ot),g=(0,l.useRef)(null),x=(0,l.useRef)(null),A=typeof e=="function"?e({page:0}):void 0;(!g.current||typeof x.current>"u"||x.current!==A)&&(g.current=e),x.current=A;let U=(0,l.useRef)(null),k=(0,l.useCallback)((P,_)=>async B=>{let G=await fetch(P(B),{signal:U.current?.signal,..._}),H=await S.current(G);return v.current?.(H)},[S,v]),b=(0,l.useCallback)(async(P,_)=>{let B=await fetch(P,{signal:U.current?.signal,..._}),G=await S.current(B);return v.current(G)?.data},[S,v]),R=(0,l.useMemo)(()=>x.current?k:b,[x,b,k]);return nt(R,[g.current,f],{...y,internal_cacheKeySuffix:x.current+Y(v.current)+Y(S.current),abortable:U})}var Le=require("react");var m=require("@raycast/api");var se=require("@raycast/api"),ue=T(require("child_process")),ae=T(require("fs/promises")),fe=T(require("os")),$=T(require("path"));var ct=require("@raycast/api"),X=T(require("fs"));function K(e){return e instanceof Error?e.message:"unknown error"}async function ee(e){return X.promises.access(e,X.constants.F_OK).then(()=>!0).catch(()=>!1)}var lt=new Intl.NumberFormat("en",{notation:"compact"});function ce(e){return lt.format(e)}var le=process.platform==="win32",te=process.platform==="darwin";var Ce=require("@raycast/api");function Ie(e,t){let r,n;function s(...a){return(r===void 0||t?.maxAge&&n!==void 0&&Date.now()-n>t.maxAge)&&(r=e(...a),n=Date.now()),r}return s.clear=()=>{r=void 0,n=void 0},s}var Ae=T(require("path")),ut=Ie(Ce.getApplications),dt={Antigravity:{macos:"com.google.antigravity",windows:{name:"Antigravity",exe:"Antigravity.exe"}},Code:{macos:"com.microsoft.VSCode",windows:{name:"Visual Studio Code",exe:"Code.exe"}},"Code - Insiders":{macos:"com.microsoft.VSCodeInsiders",windows:{name:"Visual Studio Code - Insiders",exe:"Code - Insiders.exe"}},Cursor:{macos:"com.todesktop.230313mzl4w4u92",windows:{name:"Cursor",exe:"Cursor.exe"}},Kiro:{macos:"dev.kiro.desktop",windows:{name:"Kiro",exe:"Kiro.exe"}},Positron:{macos:"com.rstudio.positron",windows:{name:"Positron",exe:"Positron.exe"}},Trae:{macos:"com.trae.app",windows:{name:"Trae",exe:"Trae.exe"}},"Trae CN":{macos:"cn.trae.app",windows:{name:"Trae CN",exe:"Trae - CN.exe"}},VSCodium:{macos:"com.vscodium",windows:{name:"VSCodium",exe:"VSCodium.exe"}},"VSCodium - Insiders":{macos:"com.vscodium.VSCodiumInsiders",windows:{name:"VSCodium - Insiders",exe:"VSCodium - Insiders.exe"}},Windsurf:{macos:"com.exafunction.windsurf",windows:{name:"Windsurf",exe:"Windsurf.exe"}}};async function re(e){let t=await ut(),r=dt[e];if(te){if(r){let n=t.find(s=>s.bundleId===r.macos);if(n)return n}}else{let n=t.find(s=>{let a=s.name===r.windows.name,c=Ae.default.basename(s.path)===r.windows.exe;return a||c});if(n)return n}}var Re=require("@raycast/api"),N=(0,Re.getPreferenceValues)(),Pe=N.build,Ut=N.layout,_t=N.keepSectionOrder,Ot=N.closeOtherWindows,Dt=N.terminalApp,Lt=N.showGitBranch,Nt=N.gitBranchColor;function ft(e){if(!e)return e;let t=e.match(/%(.+)%/);if(t)return t[1]}function ht(){let e={};if(le){let t=$.default.join(fe.homedir(),"AppData","Local","Programs");e={Antigravity:$.default.join(t,"Antigravity","bin","antigravity.cmd"),Code:$.default.join(t,"Microsoft VS Code","bin","code.cmd"),"Code - Insiders":$.default.join(t,"Microsoft VS Code Insiders","bin","code-insiders.cmd"),Kiro:$.default.join(t,"Kiro","bin","kiro.cmd"),Cursor:$.default.join(t,"cursor","resources","app","bin","cursor.cmd"),Positron:$.default.join(t,"Positron","bin","positron.cmd"),Trae:$.default.join(t,"Trae","bin","trae.cmd"),"Trae CN":$.default.join(t,"Trae CN","bin","trae-cn.cmd"),VSCodium:$.default.join(t,"VSCodium","bin","codium.cmd"),"VSCodium - Insiders":$.default.join(t,"VSCodium Insiders","bin","codium-insiders.cmd"),Windsurf:$.default.join(t,"Windsurf","bin","windsurf.cmd")}}return te&&(e={Antigravity:"/Applications/Antigravity.app/Contents/Resources/app/bin/antigravity",Code:"/Applications/Visual Studio Code.app/Contents/Resources/app/bin/code","Code - Insiders":"/Applications/Visual Studio Code - Insiders.app/Contents/Resources/app/bin/code",Cursor:"/Applications/Cursor.app/Contents/Resources/app/bin/cursor",Kiro:"/Applications/Kiro.app/Contents/Resources/app/bin/kiro",Positron:"/Applications/Positron.app/Contents/Resources/app/bin/code",Trae:"/Applications/Trae.app/Contents/Resources/app/bin/marscode","Trae CN":"/Applications/Trae CN.app/Contents/Resources/app/bin/marscode",VSCodium:"/Applications/VSCodium.app/Contents/Resources/app/bin/codium","VSCodium - Insiders":"/Applications/VSCodium - Insiders.app/Contents/Resources/app/bin/codium-insiders",Windsurf:"/Applications/Windsurf.app/Contents/Resources/app/bin/windsurf"}),e}function pt(){let e=ht(),t=e[ie()];return!t||t.length<=0?e.Code:t}var de=class{constructor(t){this.cliFilename=`"${t}"`,this.execOptions=le?{shell:!0}:void 0}installExtensionByIDSync(t){ue.execFileSync(this.cliFilename,["--install-extension",t,"--force"],this.execOptions)}uninstallExtensionByIDSync(t){ue.execFileSync(this.cliFilename,["--uninstall-extension",t,"--force"],this.execOptions)}async newWindow(){let t=await re(Pe);(0,se.open)("",t)}};function he(){return new de(pt())}async function mt(e){try{if(await ee(e)){let t=await ae.readFile(e,{encoding:"utf-8"}),r=JSON.parse(t),n=r.displayName,s=ft(n),a=r.icon,i=$.default.dirname(e);if(s&&s.length>0){let u=$.default.join(i,"package.nls.json");try{if(await ee(u)){let d=await ae.readFile(u,{encoding:"utf-8"}),y=JSON.parse(d)[s];y&&y.length>0&&(n=y)}}catch{}}let c=r.preview,o=a?$.default.join(i,a):void 0;return{displayName:n,icon:o,preview:c}}}catch{}}async function Ue(){let e=$.default.join(fe.homedir(),`.${ne()}/extensions`),t=$.default.join(e,"extensions.json");if(await ee(t)){let r=await ae.readFile(t,{encoding:"utf-8"}),n=JSON.parse(r);if(n&&n.length>0){let s=[];for(let a of n){let i=typeof a.location=="string"?$.default.join(e,a.location):a.location.fsPath??a.location.path,c=$.default.join(i,"package.json"),o=await mt(c);s.push({id:a.identifier.id,name:o?.displayName||a.identifier.id,version:a.version,preRelease:a.metadata?.preRelease,icon:o?.icon,updated:a.metadata?.updated,fsPath:i,publisherId:a.metadata?.publisherId,publisherDisplayName:a.metadata?.publisherDisplayName,preview:o?.preview,installedTimestamp:a.metadata?.installedTimestamp})}return s}}}function ie(){return(0,se.getPreferenceValues)().build}var Te={Antigravity:"antigravity",Code:"vscode","Code - Insiders":"vscode-insiders",Cursor:"cursor",Kiro:"kiro",VSCodium:"vscode-oss",Positron:"positron",Windsurf:"windsurf",Trae:"trae","Trae CN":"trae-cn"};function ne(){let e=Te[ie()];return!e||e.length<=0?Te.Code:e}var J=require("react/jsx-runtime");function _e(e){return(0,J.jsx)(m.Action,{onAction:async()=>{try{await(0,m.showToast)({style:m.Toast.Style.Animated,title:"Install Extension"}),he().installExtensionByIDSync(e.extensionID),await(0,m.showToast)({style:m.Toast.Style.Success,title:"Install Successful"}),e.afterInstall&&e.afterInstall()}catch(r){(0,m.showToast)({style:m.Toast.Style.Failure,title:"Error",message:K(r)})}},title:"Install Extension",icon:{source:m.Icon.Plus}})}function pe(e){return(0,J.jsx)(m.Action,{onAction:async()=>{try{await(0,m.confirmAlert)({title:e.extensionName?`Uninstall "${e.extensionName}" extension?`:"Uninstall extension?",icon:m.Icon.Trash,primaryAction:{style:m.Alert.ActionStyle.Destructive,title:"Uninstall"}})&&(await(0,m.showToast)({style:m.Toast.Style.Animated,title:"Uninstall Extension"}),he().uninstallExtensionByIDSync(e.extensionID),await(0,m.showToast)({style:m.Toast.Style.Success,title:"Uninstall Successful"}),e.afterUninstall&&e.afterUninstall())}catch(r){(0,m.showToast)({style:m.Toast.Style.Failure,title:"Error",message:K(r)})}},title:"Uninstall Extension",style:m.Action.Style.Destructive,icon:m.Icon.Trash,shortcut:{modifiers:["ctrl"],key:"x"}})}function me(e){let t=ie(),{data:r}=oe(async()=>re(t)),n=`${ne()}:extension/${e.extensionID}`,s=`Open in ${t}`;return(0,J.jsx)(m.Action.OpenInBrowser,{title:s,url:n,icon:r?{fileIcon:r.path}:"icon.png"})}function ge(e){let t=`https://marketplace.visualstudio.com/items?itemName=${e.extensionID}`;return(0,J.jsx)(m.Action.OpenInBrowser,{title:"Open in Browser",url:t,shortcut:{modifiers:["cmd"],key:"b"}})}var j=require("@raycast/api"),V=require("react");var De=require("react/jsx-runtime");function Oe(){let[e,t]=(0,V.useState)(!0),[r,n]=(0,V.useState)(),[s,a]=(0,V.useState)(),[i,c]=(0,V.useState)(new Date),o=()=>{c(new Date)};return(0,V.useEffect)(()=>{let u=!1;async function d(){if(!u){t(!0),a(void 0);try{let f=await Ue();u||n(f)}catch(f){u||a(K(f))}finally{u||t(!1)}}}return d(),()=>{u=!0}},[i]),{extensions:r,isLoading:e,error:s,refresh:o}}var I=require("react/jsx-runtime");function z(e){return`${e.publisher.publisherName}.${e.extensionName}`}function gt(e){let t=e.extension,r=e.installedExtensions,n=()=>{if(!t.versions||t.versions.length<=0)return;let y=t.versions[0].files.find(S=>S.assetType==="Microsoft.VisualStudio.Services.Icons.Default");if(y)return y.source},a=t.statistics?.find(y=>y.statisticName==="install")?.value,i=t.versions&&t.versions.length>0?t.versions[0]:void 0,c=i?i.version:void 0,o=i?new Date(i.lastUpdated):void 0,d=(r?r.map(f=>f.id.toLocaleLowerCase()):[]).includes(z(t).toLocaleLowerCase());return(0,I.jsx)(w.List.Item,{title:{value:t.displayName,tooltip:t.shortDescription},subtitle:t.publisher?.displayName,icon:n()||"icon.png",accessories:[{tag:d?{value:"Installed",color:w.Color.Blue}:"",tooltip:d?"Already Installed":""},{icon:a!==void 0?w.Icon.Download:void 0,text:a!==void 0?ce(a):void 0,tooltip:a!==void 0?`${ce(a)} Installs`:void 0},{tag:c,tooltip:o?`Last Update: ${o?.toLocaleString()}`:""}],actions:(0,I.jsxs)(w.ActionPanel,{children:[(0,I.jsxs)(w.ActionPanel.Section,{children:[d?(0,I.jsx)(pe,{extensionID:z(e.extension),extensionName:e.extension.displayName,afterUninstall:e.reloadLocalExtensions}):(0,I.jsx)(_e,{extensionID:z(t),afterInstall:e.reloadLocalExtensions}),(0,I.jsx)(me,{extensionID:z(t)})]}),(0,I.jsxs)(w.ActionPanel.Section,{children:[(0,I.jsx)(ge,{extensionID:z(t)}),(0,I.jsx)(w.Action.CopyToClipboard,{content:z(t),title:"Copy Extension ID",shortcut:{modifiers:["cmd","shift"],key:"."}})]})]})})}function bt(e){if(!e||!e?.results||e.results.length<=0)return;let r=e.results[0].resultMetadata?.find(n=>n.metadataType==="ResultCount");if(r){let n=r.metadataItems.find(s=>s.name==="TotalCount");if(n)return n.count}}function Ne(){let[e,t]=(0,Le.useState)(""),{extensions:r,refresh:n}=Oe(),{isLoading:s,error:a,data:i}=$t(e);a&&(0,w.showToast)({style:w.Toast.Style.Failure,title:"Error",message:a});let c=i?.results?i?.results[0].extensions:void 0,o=bt(i);return(0,I.jsx)(w.List,{isLoading:s,searchBarPlaceholder:"Search by Name or ID in VS Code Marketplace",onSearchTextChange:t,throttle:!0,children:(0,I.jsx)(w.List.Section,{title:"Found Extensions",subtitle:o!==void 0?`${c?.length}/${o}`:`${c?.length}`,children:c?.map(u=>(0,I.jsx)(gt,{extension:u,installedExtensions:r,reloadLocalExtensions:n},u.extensionId))})})}function yt(...e){return String(e.reduce((t,r)=>t|r,0))}function $t(e){let t="https://marketplace.visualstudio.com/_apis/public/gallery/extensionquery?api-version=3.0-preview.1",r={"content-type":"application/json","accept-encoding":"gzip"},s=[128,256,4,2,16,32].reduce((f,y)=>f|y,0),a={filters:[{criteria:[{filterType:8,value:"Microsoft.VisualStudio.Code"},{filterType:10,value:e},{filterType:12,value:yt(4096)}],pageNumber:1,pageSize:100,sortBy:0,sortOrder:0}],assetTypes:[],flags:s},i=JSON.stringify(a),c=e.length>0,{isLoading:o,error:u,data:d}=Ee(t,{headers:r,body:i,method:"POST",keepPreviousData:!1,execute:c});return{isLoading:c?o:!1,error:u?.message,data:e.length<=0?void 0:d}}
