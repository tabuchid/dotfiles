"use strict";var ae=Object.create;var $=Object.defineProperty;var se=Object.getOwnPropertyDescriptor;var ie=Object.getOwnPropertyNames;var oe=Object.getPrototypeOf,ce=Object.prototype.hasOwnProperty;var le=(r,t)=>{for(var e in t)$(r,e,{get:t[e],enumerable:!0})},L=(r,t,e,n)=>{if(t&&typeof t=="object"||typeof t=="function")for(let a of ie(t))!ce.call(r,a)&&a!==e&&$(r,a,{get:()=>t[a],enumerable:!(n=se(t,a))||n.enumerable});return r};var w=(r,t,e)=>(e=r!=null?ae(oe(r)):{},L(t||!r||!r.__esModule?$(e,"default",{value:r,enumerable:!0}):e,r)),ue=r=>L($({},"__esModule",{value:!0}),r);var ke={};le(ke,{default:()=>ee});module.exports=ue(ke);var u=require("@raycast/api");var h=w(require("react")),c=require("@raycast/api");var _=w(require("node:child_process")),M=require("node:buffer"),g=w(require("node:stream")),D=require("node:util");var j=require("react/jsx-runtime");var C=globalThis;var k=r=>!!r&&typeof r=="object"&&typeof r.removeListener=="function"&&typeof r.emit=="function"&&typeof r.reallyExit=="function"&&typeof r.listeners=="function"&&typeof r.kill=="function"&&typeof r.pid=="number"&&typeof r.on=="function",A=Symbol.for("signal-exit emitter"),R=class{constructor(){if(this.emitted={afterExit:!1,exit:!1},this.listeners={afterExit:[],exit:[]},this.count=0,this.id=Math.random(),C[A])return C[A];Object.defineProperty(C,A,{value:this,writable:!1,enumerable:!1,configurable:!1})}on(t,e){this.listeners[t].push(e)}removeListener(t,e){let n=this.listeners[t],a=n.indexOf(e);a!==-1&&(a===0&&n.length===1?n.length=0:n.splice(a,1))}emit(t,e,n){if(this.emitted[t])return!1;this.emitted[t]=!0;let a=!1;for(let s of this.listeners[t])a=s(e,n)===!0||a;return t==="exit"&&(a=this.emit("afterExit",e,n)||a),a}},T=class{onExit(){return()=>{}}load(){}unload(){}},I=class{#o;#t;#e;#s;#i;#a;#n;#r;constructor(t){this.#o=process.platform==="win32"?"SIGINT":"SIGHUP",this.#t=new R,this.#a={},this.#n=!1,this.#r=[],this.#r.push("SIGHUP","SIGINT","SIGTERM"),globalThis.process.platform!=="win32"&&this.#r.push("SIGALRM","SIGABRT","SIGVTALRM","SIGXCPU","SIGXFSZ","SIGUSR2","SIGTRAP","SIGSYS","SIGQUIT","SIGIOT"),globalThis.process.platform==="linux"&&this.#r.push("SIGIO","SIGPOLL","SIGPWR","SIGSTKFLT"),this.#e=t,this.#a={};for(let e of this.#r)this.#a[e]=()=>{let n=this.#e.listeners(e),{count:a}=this.#t,s=t;if(typeof s.__signal_exit_emitter__=="object"&&typeof s.__signal_exit_emitter__.count=="number"&&(a+=s.__signal_exit_emitter__.count),n.length===a){this.unload();let i=this.#t.emit("exit",null,e),o=e==="SIGHUP"?this.#o:e;i||t.kill(t.pid,o)}};this.#i=t.reallyExit,this.#s=t.emit}onExit(t,e){if(!k(this.#e))return()=>{};this.#n===!1&&this.load();let n=e?.alwaysLast?"afterExit":"exit";return this.#t.on(n,t),()=>{this.#t.removeListener(n,t),this.#t.listeners.exit.length===0&&this.#t.listeners.afterExit.length===0&&this.unload()}}load(){if(!this.#n){this.#n=!0,this.#t.count+=1;for(let t of this.#r)try{let e=this.#a[t];e&&this.#e.on(t,e)}catch{}this.#e.emit=(t,...e)=>this.#l(t,...e),this.#e.reallyExit=t=>this.#c(t)}}unload(){this.#n&&(this.#n=!1,this.#r.forEach(t=>{let e=this.#a[t];if(!e)throw new Error("Listener not defined for signal: "+t);try{this.#e.removeListener(t,e)}catch{}}),this.#e.emit=this.#s,this.#e.reallyExit=this.#i,this.#t.count-=1)}#c(t){return k(this.#e)?(this.#e.exitCode=t||0,this.#t.emit("exit",this.#e.exitCode,null),this.#i.call(this.#e,this.#e.exitCode)):0}#l(t,...e){let n=this.#s;if(t==="exit"&&k(this.#e)){typeof e[0]=="number"&&(this.#e.exitCode=e[0]);let a=n.call(this.#e,t,...e);return this.#t.emit("exit",this.#e.exitCode,null),a}else return n.call(this.#e,t,...e)}},P=null,fe=(r,t)=>(P||(P=k(process)?new I(process):new T),P.onExit(r,t));function z(r,{timeout:t}={}){let e=new Promise((o,l)=>{r.on("exit",(f,d)=>{o({exitCode:f,signal:d,timedOut:!1})}),r.on("error",f=>{l(f)}),r.stdin&&r.stdin.on("error",f=>{l(f)})}),n=fe(()=>{r.kill()});if(t===0||t===void 0)return e.finally(()=>n());let a,s=new Promise((o,l)=>{a=setTimeout(()=>{r.kill("SIGTERM"),l(Object.assign(new Error("Timed out"),{timedOut:!0,signal:"SIGTERM"}))},t)}),i=e.finally(()=>{clearTimeout(a)});return Promise.race([s,i]).finally(()=>n())}var U=class extends Error{constructor(){super("The output is too big"),this.name="MaxBufferError"}};function de(r){let{encoding:t}=r,e=t==="buffer",n=new g.default.PassThrough({objectMode:!1});t&&t!=="buffer"&&n.setEncoding(t);let a=0,s=[];return n.on("data",i=>{s.push(i),a+=i.length}),n.getBufferedValue=()=>e?Buffer.concat(s,a):s.join(""),n.getBufferedLength=()=>a,n}async function N(r,t){let e=de(t);return await new Promise((n,a)=>{let s=i=>{i&&e.getBufferedLength()<=M.constants.MAX_LENGTH&&(i.bufferedData=e.getBufferedValue()),a(i)};(async()=>{try{await(0,D.promisify)(g.default.pipeline)(r,e),n()}catch(i){s(i)}})(),e.on("data",()=>{e.getBufferedLength()>8e7&&s(new U)})}),e.getBufferedValue()}async function W(r,t){r.destroy();try{return await t}catch(e){return e.bufferedData}}async function B({stdout:r,stderr:t},{encoding:e},n){let a=N(r,{encoding:e}),s=N(t,{encoding:e});try{return await Promise.all([n,a,s])}catch(i){return Promise.all([{error:i,exitCode:null,signal:i.signal,timedOut:i.timedOut||!1},W(r,a),W(t,s)])}}function he(r){let t=typeof r=="string"?`
`:10,e=typeof r=="string"?"\r":13;return r[r.length-1]===t&&(r=r.slice(0,-1)),r[r.length-1]===e&&(r=r.slice(0,-1)),r}function x(r,t){return r.stripFinalNewline?he(t):t}function pe({timedOut:r,timeout:t,signal:e,exitCode:n}){return r?`timed out after ${t} milliseconds`:e!=null?`was killed with ${e}`:n!=null?`failed with exit code ${n}`:"failed"}function me({stdout:r,stderr:t,error:e,signal:n,exitCode:a,command:s,timedOut:i,options:o,parentError:l}){let d=`Command ${pe({timedOut:i,timeout:o?.timeout,signal:n,exitCode:a})}: ${s}`,m=e?`${d}
${e.message}`:d,b=[m,t,r].filter(Boolean).join(`
`);return e?e.originalMessage=e.message:e=l,e.message=b,e.shortMessage=m,e.command=s,e.exitCode=a,e.signal=n,e.stdout=r,e.stderr=t,"bufferedData"in e&&delete e.bufferedData,e}function G({stdout:r,stderr:t,error:e,exitCode:n,signal:a,timedOut:s,command:i,options:o,parentError:l}){if(e||n!==0||a!==null)throw me({error:e,exitCode:n,signal:a,stdout:r,stderr:t,command:i,timedOut:s,options:o,parentError:l});return r}async function v(r,t,e){if(process.platform!=="darwin")throw new Error("AppleScript is only supported on macOS");let{humanReadableOutput:n,language:a,timeout:s,...i}=Array.isArray(t)?e||{}:t||{},o=n!==!1?[]:["-ss"];a==="JavaScript"&&o.push("-l","JavaScript"),Array.isArray(t)&&o.push("-",...t);let l=_.default.spawn("osascript",o,{...i,env:{PATH:"/usr/local/bin:/usr/bin:/bin:/usr/sbin:/sbin"}}),f=z(l,{timeout:s??1e4});l.stdin.end(r);let[{error:d,exitCode:m,signal:b,timedOut:S},E,te]=await B(l,{encoding:"utf8"},f),re=x({stripFinalNewline:!0},E),ne=x({stripFinalNewline:!0},te);return G({stdout:re,stderr:ne,error:d,exitCode:m,signal:b,timedOut:S,command:"osascript",options:e,parentError:new Error})}async function K(r,t){if(process.platform!=="win32")throw new Error("PowerShell is only supported on Windows");let{timeout:e,...n}=t||{},a=["-NoLogo","-NoProfile","-NonInteractive","-Command","-"],s=_.default.spawn("powershell.exe",a,{...n}),i=z(s,{timeout:e??1e4});s.stdin.end(r);let[{error:o,exitCode:l,signal:f,timedOut:d},m,b]=await B(s,{encoding:"utf8"},i),S=x({stripFinalNewline:!0},m),E=x({stripFinalNewline:!0},b);return G({stdout:S,stderr:E,error:o,exitCode:l,signal:f,timedOut:d,command:"powershell.exe",options:t,parentError:new Error})}var J=require("@raycast/api"),p=(0,J.getPreferenceValues)(),O=p.build,Ae=p.layout,Pe=p.keepSectionOrder,Re=p.closeOtherWindows,Te=p.terminalApp,Ie=p.showGitBranch,Ue=p.gitBranchColor;var ge=`
try
    tell application "Finder"
        return POSIX path of (insertion location as alias)
    end tell
on error
    return ""
end try
`,H=async()=>await v(ge);var $e=require("@raycast/api");var X=require("@raycast/api");var q=require("@raycast/api");function Z(r,t){let e,n;function a(...s){return(e===void 0||t?.maxAge&&n!==void 0&&Date.now()-n>t.maxAge)&&(e=r(...s),n=Date.now()),e}return a.clear=()=>{e=void 0,n=void 0},a}var Y=w(require("path")),be=Z(q.getApplications),ye={Antigravity:{macos:"com.google.antigravity",windows:{name:"Antigravity",exe:"Antigravity.exe"}},Code:{macos:"com.microsoft.VSCode",windows:{name:"Visual Studio Code",exe:"Code.exe"}},"Code - Insiders":{macos:"com.microsoft.VSCodeInsiders",windows:{name:"Visual Studio Code - Insiders",exe:"Code - Insiders.exe"}},Cursor:{macos:"com.todesktop.230313mzl4w4u92",windows:{name:"Cursor",exe:"Cursor.exe"}},Kiro:{macos:"dev.kiro.desktop",windows:{name:"Kiro",exe:"Kiro.exe"}},Positron:{macos:"com.rstudio.positron",windows:{name:"Positron",exe:"Positron.exe"}},Trae:{macos:"com.trae.app",windows:{name:"Trae",exe:"Trae.exe"}},"Trae CN":{macos:"cn.trae.app",windows:{name:"Trae CN",exe:"Trae - CN.exe"}},VSCodium:{macos:"com.vscodium",windows:{name:"VSCodium",exe:"VSCodium.exe"}},"VSCodium - Insiders":{macos:"com.vscodium.VSCodiumInsiders",windows:{name:"VSCodium - Insiders",exe:"VSCodium - Insiders.exe"}},Windsurf:{macos:"com.exafunction.windsurf",windows:{name:"Windsurf",exe:"Windsurf.exe"}}};async function F(r){let t=await be(),e=ye[r];if(y){if(e){let n=t.find(a=>a.bundleId===e.macos);if(n)return n}}else{let n=t.find(a=>{let s=a.name===e.windows.name,o=Y.default.basename(a.path)===e.windows.exe;return s||o});if(n)return n}}var He=new Intl.NumberFormat("en",{notation:"compact"});var V=process.platform==="win32",y=process.platform==="darwin";async function Q(){return decodeURI(await K(`
$url = (New-Object -ComObject Shell.Application).Windows() |
  Where-Object { $_.LocationName -ne $null -and $_.LocationName -ne "Desktop" } |
  Select-Object -First 1 -ExpandProperty LocationURL

Write-Output $url
`)).trim().replace("file:///","")}var we=async()=>(await v(`
    tell application "Path Finder"
      set thePaths to {}
      repeat with pfItem in (get selection)
        set the end of thePaths to POSIX path of pfItem
      end repeat
      return thePaths
    end tell
  `)).split(",");async function ee(){try{let r=[],t=await F(O);if(y){let e=await(0,u.getFrontmostApplication)();if(e.name==="Finder"?r=await(0,u.getSelectedFinderItems)():e.name==="Path Finder"&&(r=(await we()).map(a=>({path:a}))),r.length===0){let n=await H();if(n.length===0)throw new Error("Not a valid directory");r=[{path:n}]}for(let n of r)await(0,u.open)(n.path,t)}if(V){if(r=await(0,u.getSelectedFinderItems)(),r.length===0){let e=await Q();if(e.length===0)throw new Error("Not a valid directory.");r=[{path:e}]}for(let e of r)(0,u.open)(e.path,t)}await(0,u.closeMainWindow)()}catch(r){await(0,u.showToast)({title:"Failed opening selected Finder or Path Finder item",style:u.Toast.Style.Failure,message:r instanceof Error?r.message:String(r)})}}
