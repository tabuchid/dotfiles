"use strict";var ns=Object.create;var Tt=Object.defineProperty;var ss=Object.getOwnPropertyDescriptor;var is=Object.getOwnPropertyNames;var os=Object.getPrototypeOf,cs=Object.prototype.hasOwnProperty;var J=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports),ls=(e,t)=>{for(var r in t)Tt(e,r,{get:t[r],enumerable:!0})},na=(e,t,r,a)=>{if(t&&typeof t=="object"||typeof t=="function")for(let n of is(t))!cs.call(e,n)&&n!==r&&Tt(e,n,{get:()=>t[n],enumerable:!(a=ss(t,n))||a.enumerable});return e};var O=(e,t,r)=>(r=e!=null?ns(os(e)):{},na(t||!e||!e.__esModule?Tt(r,"default",{value:e,enumerable:!0}):r,e)),us=e=>na(Tt({},"__esModule",{value:!0}),e);var dr=J(Lt=>{"use strict";Object.defineProperty(Lt,"__esModule",{value:!0});Lt.redactString=fr;Lt.sanitizeArgs=Is;function _a(e){return e.replace(/([A-Za-z0-9._%+-])[^@\s]*(@[A-Za-z0-9.-]+\.[A-Za-z]{2,})/g,(t,r,a)=>`${r}***${a}`)}function fr(e){let t=e;return t=t.replace(/bearer\s+[^\s"']+/gi,"Bearer ***"),t=t.replace(/(password|pass|pwd|secret|token|auth|authorization|key)\s*[:=]\s*[^\s&"']+/gi,"$1=***"),t=t.replace(/((?:code|2fa|two[-\s]?factor|otp)\s*[:=\s]+)(\d{4,8})/gi,(r,a)=>`${a}******`),t=t.replace(/[a-f0-9]{32,}/gi,"***"),t=t.replace(/[A-Za-z0-9+/]{20,}={0,2}/g,"***"),t=_a(t),t}function $a(e,t){let r=e.toLowerCase();if(t==null)return t;if(typeof t=="string")return["password","pass","pwd","secret","token","auth","authorization","applepassword"].includes(r)?"***":["code","otp","2fa","twofactor","two_factor"].includes(r)?"******":["email","appleid","apple_id","username","user"].includes(r)?_a(t):fr(t);if(typeof t=="number")return["code","otp","2fa"].includes(r)?0:t;if(typeof t=="object")try{let a=JSON.stringify(t,(n,s)=>$a(n,s));return JSON.parse(a)}catch{return t}return t}function Is(e){return e.map(t=>{if(typeof t=="string")return fr(t);if(typeof t=="object"&&t!==null)try{let r=JSON.stringify(t,(a,n)=>$a(a,n));return JSON.parse(r)}catch{return t}return t})}});var Ca=J(qe=>{"use strict";Object.defineProperty(qe,"__esModule",{value:!0});qe.logger=qe.Logger=void 0;var Es=require("@raycast/api"),Sa=dr(),Ut=class e{constructor(t={}){this.config={isVerboseEnabled:t.isVerboseEnabled||this.defaultVerboseCheck,prefix:t.prefix||"",enableRedaction:t.enableRedaction??!0}}defaultVerboseCheck(){try{return(0,Es.getPreferenceValues)().verboseLogging||!1}catch(t){return console.error("[Logger] Failed to read preferences for verbose logging:",t),!1}}static getInstance(){return e.instance||(e.instance=new e),e.instance}formatMessage(t){return this.config.prefix?`${this.config.prefix} ${t}`:t}processLogData(t,r){let a=this.formatMessage(t);return this.config.enableRedaction?[(0,Sa.redactString)(a),(0,Sa.sanitizeArgs)(r)]:[a,r]}log(t,...r){if(this.config.isVerboseEnabled()){let[a,n]=this.processLogData(t,r);console.log(a,...n)}}error(t,...r){let[a,n]=this.processLogData(t,r);console.error(a,...n)}warn(t,...r){let[a,n]=this.processLogData(t,r);console.warn(a,...n)}child(t){let r=this.config.prefix?`${this.config.prefix} ${t}`:t;return new e({...this.config,prefix:r})}};qe.Logger=Ut;qe.logger=Ut.getInstance()});var hr=J(fe=>{"use strict";Object.defineProperty(fe,"__esModule",{value:!0});fe.sanitizeArgs=fe.redactString=fe.logger=fe.Logger=void 0;var Pa=Ca();Object.defineProperty(fe,"Logger",{enumerable:!0,get:function(){return Pa.Logger}});Object.defineProperty(fe,"logger",{enumerable:!0,get:function(){return Pa.logger}});var va=dr();Object.defineProperty(fe,"redactString",{enumerable:!0,get:function(){return va.redactString}});Object.defineProperty(fe,"sanitizeArgs",{enumerable:!0,get:function(){return va.sanitizeArgs}})});var Wt=J((Oo,Ma)=>{"use strict";var{Readable:Uo,Writable:Ro,Duplex:Fs,Transform:Fa}=require("stream"),Ms=Symbol.for("object-stream.none"),pr=Symbol.for("object-stream.final"),gr=Symbol.for("object-stream.many"),Ls=e=>({[pr]:e}),Us=e=>({[gr]:e}),Rs=e=>e&&typeof e=="object"&&pr in e,Os=e=>e&&typeof e=="object"&&gr in e,Ns=e=>e[pr],Vs=e=>e[gr],Bs=async(e,t)=>{for(;;){let r=e.next();if(r&&typeof r.then=="function"&&(r=await r),r.done)break;let a=r.value;a&&typeof a.then=="function"&&(a=await a),N.sanitize(a,t)}},js=e=>new Fa({writableObjectMode:!0,readableObjectMode:!0,transform(t,r,a){try{let n=e.call(this,t,r);if(n&&typeof n.then=="function"){n.then(s=>(N.sanitize(s,this),a(null)),s=>a(s));return}if(n&&typeof n.next=="function"){Bs(n,this).then(()=>a(null),s=>a(s));return}N.sanitize(n,this),a(null)}catch(n){a(n)}}}),Ws=e=>new Fa({writableObjectMode:!0,readableObjectMode:!0,transform(t,r,a){try{let n=t;for(let s=0;s<e.length;++s){let i=e[s].call(this,n,r);if(i===N.none){a(null);return}if(N.isFinal(i)){n=N.getFinalValue(i);break}n=i}N.sanitize(n,this),a(null)}catch(n){a(n)}}}),Ta=e=>e&&typeof e.pipe=="function"&&typeof e.on=="function"&&(!e._writableState||(typeof e._readableState=="object"?e._readableState.readable:null)!==!1)&&(!e._writableState||e._readableState),Da=e=>e&&typeof e.write=="function"&&typeof e.on=="function"&&(!e._readableState||(typeof e._writableState=="object"?e._writableState.writable:null)!==!1),zs=e=>e&&typeof e.pipe=="function"&&e._readableState&&typeof e.on=="function"&&typeof e.write=="function",N=class e extends Fs{constructor(t,r){if(super(r||{writableObjectMode:!0,readableObjectMode:!0}),!(t instanceof Array)||!t.length)throw Error("Chain's argument should be a non-empty array.");this.streams=t.filter(a=>a).map((a,n,s)=>{if(typeof a=="function"||a instanceof Array)return e.convertToTransform(a);if(zs(a)||!n&&Ta(a)||n===s.length-1&&Da(a))return a;throw Error("Arguments should be functions, arrays or streams.")}).filter(a=>a),this.input=this.streams[0],this.output=this.streams.reduce((a,n)=>a&&a.pipe(n)||n),Da(this.input)||(this._write=(a,n,s)=>s(null),this._final=a=>a(null),this.input.on("end",()=>this.end())),Ta(this.output)?(this.output.on("data",a=>!this.push(a)&&this.output.pause()),this.output.on("end",()=>this.push(null))):(this._read=()=>{},this.resume(),this.output.on("finish",()=>this.push(null))),(!r||!r.skipEvents)&&this.streams.forEach(a=>a.on("error",n=>this.emit("error",n)))}_write(t,r,a){let n=null;try{this.input.write(t,r,s=>a(s||n))}catch(s){n=s}}_final(t){let r=null;try{this.input.end(null,null,a=>t(a||r))}catch(a){r=a}}_read(){this.output.resume()}static make(t,r){return new e(t,r)}static sanitize(t,r){e.isFinal(t)?t=e.getFinalValue(t):e.isMany(t)&&(t=e.getManyValues(t)),t!=null&&t!==e.none&&(t instanceof Array?t.forEach(a=>a!=null&&r.push(a)):r.push(t))}static convertToTransform(t){return typeof t=="function"?js(t):t instanceof Array&&t.length?Ws(t):null}};N.none=Ms;N.final=Ls;N.isFinal=Rs;N.getFinalValue=Ns;N.many=Us;N.isMany=Os;N.getManyValues=Vs;N.chain=N.make;N.make.Constructor=N;Ma.exports=N});var Ua=J((No,La)=>{"use strict";var{Transform:Hs}=require("stream"),{StringDecoder:Ks}=require("string_decoder"),br=class extends Hs{constructor(t){super(Object.assign({},t,{writableObjectMode:!1})),this._buffer=""}_transform(t,r,a){typeof t=="string"?this._transform=this._transformString:(this._stringDecoder=new Ks,this._transform=this._transformBuffer),this._transform(t,r,a)}_transformBuffer(t,r,a){this._buffer+=this._stringDecoder.write(t),this._processBuffer(a)}_transformString(t,r,a){this._buffer+=t.toString(),this._processBuffer(a)}_processBuffer(t){this._buffer&&(this.push(this._buffer,"utf8"),this._buffer=""),t(null)}_flushInput(){this._stringDecoder&&(this._buffer+=this._stringDecoder.end())}_flush(t){this._flushInput(),this._processBuffer(t)}};La.exports=br});var yr=J((Vo,Ra)=>{"use strict";var qs=Ua(),P={value1:/^(?:[\"\{\[\]\-\d]|true\b|false\b|null\b|\s{1,256})/,string:/^(?:[^\x00-\x1f\"\\]{1,256}|\\[bfnrt\"\\\/]|\\u[\da-fA-F]{4}|\")/,key1:/^(?:[\"\}]|\s{1,256})/,colon:/^(?:\:|\s{1,256})/,comma:/^(?:[\,\]\}]|\s{1,256})/,ws:/^\s{1,256}/,numberStart:/^\d/,numberDigit:/^\d{0,256}/,numberFraction:/^[\.eE]/,numberExponent:/^[eE]/,numberExpSign:/^[-+]/},Gs=16,z=!0;try{new RegExp(".","y"),z=!1}catch{}!z&&Object.keys(P).forEach(e=>{let t=P[e].source.slice(1);t.slice(0,3)==="(?:"&&t.slice(-1)===")"&&(t=t.slice(3,-1)),P[e]=new RegExp(t,"y")});P.numberFracStart=P.numberExpStart=P.numberStart;P.numberFracDigit=P.numberExpDigit=P.numberDigit;var Js={true:!0,false:!1,null:null},he={object:"objectStop",array:"arrayStop","":"done"},Zs=e=>String.fromCharCode(parseInt(e.slice(2),16)),Ys={b:"\b",f:"\f",n:`
`,r:"\r",t:"	",'"':'"',"\\":"\\","/":"/"},Ue=class e extends qs{static make(t){return new e(t)}constructor(t){super(Object.assign({},t,{readableObjectMode:!0})),this._packKeys=this._packStrings=this._packNumbers=this._streamKeys=this._streamStrings=this._streamNumbers=!0,t&&("packValues"in t&&(this._packKeys=this._packStrings=this._packNumbers=t.packValues),"packKeys"in t&&(this._packKeys=t.packKeys),"packStrings"in t&&(this._packStrings=t.packStrings),"packNumbers"in t&&(this._packNumbers=t.packNumbers),"streamValues"in t&&(this._streamKeys=this._streamStrings=this._streamNumbers=t.streamValues),"streamKeys"in t&&(this._streamKeys=t.streamKeys),"streamStrings"in t&&(this._streamStrings=t.streamStrings),"streamNumbers"in t&&(this._streamNumbers=t.streamNumbers),this._jsonStreaming=t.jsonStreaming),!this._packKeys&&(this._streamKeys=!0),!this._packStrings&&(this._streamStrings=!0),!this._packNumbers&&(this._streamNumbers=!0),this._done=!1,this._expect=this._jsonStreaming?"done":"value",this._stack=[],this._parent="",this._open_number=!1,this._accumulator=""}_flush(t){this._done=!0,super._flush(r=>{if(r)return t(r);this._open_number&&(this._streamNumbers&&this.push({name:"endNumber"}),this._open_number=!1,this._packNumbers&&(this.push({name:"numberValue",value:this._accumulator}),this._accumulator="")),t(null)})}_processBuffer(t){let r,a,n=0;e:for(;;)switch(this._expect){case"value1":case"value":if(P.value1.lastIndex=n,r=P.value1.exec(this._buffer),!r){if(this._done||n+Gs<this._buffer.length)return n<this._buffer.length?t(new Error("Parser cannot parse input: expected a value")):t(new Error("Parser has expected a value"));break e}switch(a=r[0],a){case'"':this._streamStrings&&this.push({name:"startString"}),this._expect="string";break;case"{":this.push({name:"startObject"}),this._stack.push(this._parent),this._parent="object",this._expect="key1";break;case"[":this.push({name:"startArray"}),this._stack.push(this._parent),this._parent="array",this._expect="value1";break;case"]":if(this._expect!=="value1")return t(new Error("Parser cannot parse input: unexpected token ']'"));this._open_number&&(this._streamNumbers&&this.push({name:"endNumber"}),this._open_number=!1,this._packNumbers&&(this.push({name:"numberValue",value:this._accumulator}),this._accumulator="")),this.push({name:"endArray"}),this._parent=this._stack.pop(),this._expect=he[this._parent];break;case"-":this._open_number=!0,this._streamNumbers&&(this.push({name:"startNumber"}),this.push({name:"numberChunk",value:"-"})),this._packNumbers&&(this._accumulator="-"),this._expect="numberStart";break;case"0":this._open_number=!0,this._streamNumbers&&(this.push({name:"startNumber"}),this.push({name:"numberChunk",value:"0"})),this._packNumbers&&(this._accumulator="0"),this._expect="numberFraction";break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":this._open_number=!0,this._streamNumbers&&(this.push({name:"startNumber"}),this.push({name:"numberChunk",value:a})),this._packNumbers&&(this._accumulator=a),this._expect="numberDigit";break;case"true":case"false":case"null":if(this._buffer.length-n===a.length&&!this._done)break e;this.push({name:a+"Value",value:Js[a]}),this._expect=he[this._parent];break}z?this._buffer=this._buffer.slice(a.length):n+=a.length;break;case"keyVal":case"string":if(P.string.lastIndex=n,r=P.string.exec(this._buffer),!r){if(n<this._buffer.length&&(this._done||this._buffer.length-n>=6))return t(new Error("Parser cannot parse input: escaped characters"));if(this._done)return t(new Error("Parser has expected a string value"));break e}if(a=r[0],a==='"')this._expect==="keyVal"?(this._streamKeys&&this.push({name:"endKey"}),this._packKeys&&(this.push({name:"keyValue",value:this._accumulator}),this._accumulator=""),this._expect="colon"):(this._streamStrings&&this.push({name:"endString"}),this._packStrings&&(this.push({name:"stringValue",value:this._accumulator}),this._accumulator=""),this._expect=he[this._parent]);else if(a.length>1&&a.charAt(0)==="\\"){let s=a.length==2?Ys[a.charAt(1)]:Zs(a);(this._expect==="keyVal"?this._streamKeys:this._streamStrings)&&this.push({name:"stringChunk",value:s}),(this._expect==="keyVal"?this._packKeys:this._packStrings)&&(this._accumulator+=s)}else(this._expect==="keyVal"?this._streamKeys:this._streamStrings)&&this.push({name:"stringChunk",value:a}),(this._expect==="keyVal"?this._packKeys:this._packStrings)&&(this._accumulator+=a);z?this._buffer=this._buffer.slice(a.length):n+=a.length;break;case"key1":case"key":if(P.key1.lastIndex=n,r=P.key1.exec(this._buffer),!r){if(n<this._buffer.length||this._done)return t(new Error("Parser cannot parse input: expected an object key"));break e}if(a=r[0],a==='"')this._streamKeys&&this.push({name:"startKey"}),this._expect="keyVal";else if(a==="}"){if(this._expect!=="key1")return t(new Error("Parser cannot parse input: unexpected token '}'"));this.push({name:"endObject"}),this._parent=this._stack.pop(),this._expect=he[this._parent]}z?this._buffer=this._buffer.slice(a.length):n+=a.length;break;case"colon":if(P.colon.lastIndex=n,r=P.colon.exec(this._buffer),!r){if(n<this._buffer.length||this._done)return t(new Error("Parser cannot parse input: expected ':'"));break e}a=r[0],a===":"&&(this._expect="value"),z?this._buffer=this._buffer.slice(a.length):n+=a.length;break;case"arrayStop":case"objectStop":if(P.comma.lastIndex=n,r=P.comma.exec(this._buffer),!r){if(n<this._buffer.length||this._done)return t(new Error("Parser cannot parse input: expected ','"));break e}if(this._open_number&&(this._streamNumbers&&this.push({name:"endNumber"}),this._open_number=!1,this._packNumbers&&(this.push({name:"numberValue",value:this._accumulator}),this._accumulator="")),a=r[0],a===",")this._expect=this._expect==="arrayStop"?"value":"key";else if(a==="}"||a==="]"){if(a==="}"?this._expect==="arrayStop":this._expect!=="arrayStop")return t(new Error("Parser cannot parse input: expected '"+(this._expect==="arrayStop"?"]":"}")+"'"));this.push({name:a==="}"?"endObject":"endArray"}),this._parent=this._stack.pop(),this._expect=he[this._parent]}z?this._buffer=this._buffer.slice(a.length):n+=a.length;break;case"numberStart":if(P.numberStart.lastIndex=n,r=P.numberStart.exec(this._buffer),!r){if(n<this._buffer.length||this._done)return t(new Error("Parser cannot parse input: expected a starting digit"));break e}a=r[0],this._streamNumbers&&this.push({name:"numberChunk",value:a}),this._packNumbers&&(this._accumulator+=a),this._expect=a==="0"?"numberFraction":"numberDigit",z?this._buffer=this._buffer.slice(a.length):n+=a.length;break;case"numberDigit":if(P.numberDigit.lastIndex=n,r=P.numberDigit.exec(this._buffer),!r){if(n<this._buffer.length||this._done)return t(new Error("Parser cannot parse input: expected a digit"));break e}if(a=r[0],a)this._streamNumbers&&this.push({name:"numberChunk",value:a}),this._packNumbers&&(this._accumulator+=a),z?this._buffer=this._buffer.slice(a.length):n+=a.length;else{if(n<this._buffer.length){this._expect="numberFraction";break}if(this._done){this._expect=he[this._parent];break}break e}break;case"numberFraction":if(P.numberFraction.lastIndex=n,r=P.numberFraction.exec(this._buffer),!r){if(n<this._buffer.length||this._done){this._expect=he[this._parent];break}break e}a=r[0],this._streamNumbers&&this.push({name:"numberChunk",value:a}),this._packNumbers&&(this._accumulator+=a),this._expect=a==="."?"numberFracStart":"numberExpSign",z?this._buffer=this._buffer.slice(a.length):n+=a.length;break;case"numberFracStart":if(P.numberFracStart.lastIndex=n,r=P.numberFracStart.exec(this._buffer),!r){if(n<this._buffer.length||this._done)return t(new Error("Parser cannot parse input: expected a fractional part of a number"));break e}a=r[0],this._streamNumbers&&this.push({name:"numberChunk",value:a}),this._packNumbers&&(this._accumulator+=a),this._expect="numberFracDigit",z?this._buffer=this._buffer.slice(a.length):n+=a.length;break;case"numberFracDigit":if(P.numberFracDigit.lastIndex=n,r=P.numberFracDigit.exec(this._buffer),a=r[0],a)this._streamNumbers&&this.push({name:"numberChunk",value:a}),this._packNumbers&&(this._accumulator+=a),z?this._buffer=this._buffer.slice(a.length):n+=a.length;else{if(n<this._buffer.length){this._expect="numberExponent";break}if(this._done){this._expect=he[this._parent];break}break e}break;case"numberExponent":if(P.numberExponent.lastIndex=n,r=P.numberExponent.exec(this._buffer),!r){if(n<this._buffer.length){this._expect=he[this._parent];break}if(this._done){this._expect="done";break}break e}a=r[0],this._streamNumbers&&this.push({name:"numberChunk",value:a}),this._packNumbers&&(this._accumulator+=a),this._expect="numberExpSign",z?this._buffer=this._buffer.slice(a.length):n+=a.length;break;case"numberExpSign":if(P.numberExpSign.lastIndex=n,r=P.numberExpSign.exec(this._buffer),!r){if(n<this._buffer.length){this._expect="numberExpStart";break}if(this._done)return t(new Error("Parser has expected an exponent value of a number"));break e}a=r[0],this._streamNumbers&&this.push({name:"numberChunk",value:a}),this._packNumbers&&(this._accumulator+=a),this._expect="numberExpStart",z?this._buffer=this._buffer.slice(a.length):n+=a.length;break;case"numberExpStart":if(P.numberExpStart.lastIndex=n,r=P.numberExpStart.exec(this._buffer),!r){if(n<this._buffer.length||this._done)return t(new Error("Parser cannot parse input: expected an exponent part of a number"));break e}a=r[0],this._streamNumbers&&this.push({name:"numberChunk",value:a}),this._packNumbers&&(this._accumulator+=a),this._expect="numberExpDigit",z?this._buffer=this._buffer.slice(a.length):n+=a.length;break;case"numberExpDigit":if(P.numberExpDigit.lastIndex=n,r=P.numberExpDigit.exec(this._buffer),a=r[0],a)this._streamNumbers&&this.push({name:"numberChunk",value:a}),this._packNumbers&&(this._accumulator+=a),z?this._buffer=this._buffer.slice(a.length):n+=a.length;else{if(n<this._buffer.length||this._done){this._expect=he[this._parent];break}break e}break;case"done":if(P.ws.lastIndex=n,r=P.ws.exec(this._buffer),!r){if(n<this._buffer.length){if(this._jsonStreaming){this._expect="value";break}return t(new Error("Parser cannot parse input: unexpected characters"))}break e}a=r[0],this._open_number&&(this._streamNumbers&&this.push({name:"endNumber"}),this._open_number=!1,this._packNumbers&&(this.push({name:"numberValue",value:this._accumulator}),this._accumulator="")),z?this._buffer=this._buffer.slice(a.length):n+=a.length;break}!z&&(this._buffer=this._buffer.slice(n)),t(null)}};Ue.parser=Ue.make;Ue.make.Constructor=Ue;Ra.exports=Ue});var Na=J((Bo,Oa)=>{"use strict";var Xs=e=>e.on("data",t=>e.emit(t.name,t.value));Oa.exports=Xs});var xr=J((jo,Va)=>{"use strict";var wr=yr(),Qs=Na(),kr=e=>Qs(new wr(e));kr.Parser=wr;kr.parser=wr.parser;Va.exports=kr});var Sr=J((Wo,Ba)=>{"use strict";var{Transform:ei}=require("stream"),me=class e extends ei{static stringFilter(t,r){return a=>{let n=a.join(r);return n.length===t.length&&n===t||n.length>t.length&&n.substr(0,t.length)===t&&n.substr(t.length,r.length)===r}}static regExpFilter(t,r){return a=>t.test(a.join(r))}static arrayReplacement(t){return()=>t}constructor(t){super(Object.assign({},t,{writableObjectMode:!0,readableObjectMode:!0})),this._transform=this._check,this._stack=[];let r=t&&t.filter,a=t&&t.pathSeparator||".";typeof r=="string"?this._filter=e.stringFilter(r,a):typeof r=="function"?this._filter=r:r instanceof RegExp&&(this._filter=e.regExpFilter(r,a));let n=t&&t.replacement;typeof n=="function"?this._replacement=n:this._replacement=e.arrayReplacement(n||e.defaultReplacement),this._allowEmptyReplacement=t&&t.allowEmptyReplacement,this._streamKeys=!0,t&&("streamValues"in t&&(this._streamKeys=t.streamValues),"streamKeys"in t&&(this._streamKeys=t.streamKeys)),this._once=t&&t.once,this._previousToken=""}_check(t,r,a){switch(t.name){case"startObject":case"startArray":case"startString":case"startNumber":case"nullValue":case"trueValue":case"falseValue":typeof this._stack[this._stack.length-1]=="number"&&++this._stack[this._stack.length-1];break;case"keyValue":this._stack[this._stack.length-1]=t.value;break;case"numberValue":this._previousToken!=="endNumber"&&typeof this._stack[this._stack.length-1]=="number"&&++this._stack[this._stack.length-1];break;case"stringValue":this._previousToken!=="endString"&&typeof this._stack[this._stack.length-1]=="number"&&++this._stack[this._stack.length-1];break}if(this._previousToken=t.name,this._checkChunk(t))return a(null);switch(t.name){case"startObject":this._stack.push(null);break;case"startArray":this._stack.push(-1);break;case"endObject":case"endArray":this._stack.pop();break}a(null)}_passObject(t,r,a){switch(this.push(t),t.name){case"startObject":case"startArray":++this._depth;break;case"endObject":case"endArray":--this._depth;break}this._depth||(this._transform=this._once?this._skip:this._check),a(null)}_pass(t,r,a){this.push(t),a(null)}_skipObject(t,r,a){switch(t.name){case"startObject":case"startArray":++this._depth;break;case"endObject":case"endArray":--this._depth;break}this._depth||(this._transform=this._once?this._pass:this._check),a(null)}_skip(t,r,a){a(null)}};me.defaultReplacement=[{name:"nullValue",value:null}];var _r=(e,t)=>function(r,a,n){if(this._expected){let s=this._expected;if(this._expected="",this._transform=this._once?this._skip:this._check,s===r.name)this.push(r);else return this._transform(r,a,n)}else this.push(r),r.name===e&&(this._expected=t);n(null)};me.prototype._passNumber=_r("endNumber","numberValue");me.prototype._passString=_r("endString","stringValue");me.prototype._passKey=_r("endKey","keyValue");var $r=(e,t)=>function(r,a,n){if(this._expected){let s=this._expected;if(this._expected="",this._transform=this._once?this._pass:this._check,s!==r.name)return this._transform(r,a,n)}else r.name===e&&(this._expected=t);n(null)};me.prototype._skipNumber=$r("endNumber","numberValue");me.prototype._skipString=$r("endString","stringValue");me.prototype._skipKey=$r("endKey","keyValue");Ba.exports=me});var gt=J((zo,ja)=>{"use strict";var{chain:ti}=Wt(),ri=yr(),ai=(e,t)=>ti([new ri(t),e(t)],Object.assign({},t,{writableObjectMode:!1,readableObjectMode:!0}));ja.exports=ai});var za=J((Ho,Wa)=>{"use strict";var ni=Sr(),si=gt(),Re=class e extends ni{static make(t){return new e(t)}static withParser(t){return si(e.make,t)}constructor(t){super(t),this._once=!1,this._lastStack=[]}_flush(t){this._syncStack(),t(null)}_checkChunk(t){switch(t.name){case"startObject":this._filter(this._stack,t)&&(this._syncStack(),this.push(t),this._lastStack.push(null));break;case"startArray":this._filter(this._stack,t)&&(this._syncStack(),this.push(t),this._lastStack.push(-1));break;case"nullValue":case"trueValue":case"falseValue":case"stringValue":case"numberValue":this._filter(this._stack,t)&&(this._syncStack(),this.push(t));break;case"startString":this._filter(this._stack,t)?(this._syncStack(),this.push(t),this._transform=this._passString):this._transform=this._skipString;break;case"startNumber":this._filter(this._stack,t)?(this._syncStack(),this.push(t),this._transform=this._passNumber):this._transform=this._skipNumber;break}return!1}_syncStack(){let t=this._stack,r=this._lastStack,a=t.length,n=r.length,s=0;for(let i=Math.min(a,n);s<i&&t[s]===r[s];++s);for(let i=n-1;i>s;--i)this.push({name:typeof r[i]=="number"?"endArray":"endObject"});if(s<n)if(s<a){if(typeof t[s]=="string"){let i=t[s];this._streamKeys&&(this.push({name:"startKey"}),this.push({name:"stringChunk",value:i}),this.push({name:"endKey"})),this.push({name:"keyValue",value:i})}++s}else this.push({name:typeof r[s]=="number"?"endArray":"endObject"});for(let i=s;i<a;++i){let o=t[i];typeof o=="number"?o>=0&&this.push({name:"startArray"}):typeof o=="string"&&(this.push({name:"startObject"}),this._streamKeys&&(this.push({name:"startKey"}),this.push({name:"stringChunk",value:o}),this.push({name:"endKey"})),this.push({name:"keyValue",value:o}))}this._lastStack=Array.prototype.concat.call(t)}};Re.filter=Re.make;Re.make.Constructor=Re;Wa.exports=Re});var qa=J((Ko,Ka)=>{"use strict";var ii=require("events"),Ha=e=>function(){this.done?this.done=!1:this.stack.push(this.current,this.key),this.current=new e,this.key=null},$e=class e extends ii{static connectTo(t,r){return new e(r).connectTo(t)}constructor(t){super(),this.stack=[],this.current=this.key=null,this.done=!0,t&&(this.reviver=typeof t.reviver=="function"&&t.reviver,this.reviver&&(this.stringValue=this._saveValue=this._saveValueWithReviver),t.numberAsString&&(this.numberValue=this.stringValue))}connectTo(t){return t.on("data",r=>{this[r.name]&&(this[r.name](r.value),this.done&&this.emit("done",this))}),this}get depth(){return(this.stack.length>>1)+(this.done?0:1)}get path(){let t=[];for(let r=0;r<this.stack.length;r+=2){let a=this.stack[r+1];t.push(a===null?this.stack[r].length:a)}return t}dropToLevel(t){if(t<this.depth)if(t){let r=t-1<<1;this.current=this.stack[r],this.key=this.stack[r+1],this.stack.splice(r)}else this.stack=[],this.current=this.key=null,this.done=!0;return this}consume(t){return this[t.name]&&this[t.name](t.value),this}keyValue(t){this.key=t}numberValue(t){this._saveValue(parseFloat(t))}nullValue(){this._saveValue(null)}trueValue(){this._saveValue(!0)}falseValue(){this._saveValue(!1)}endObject(){if(this.stack.length){let t=this.current;this.key=this.stack.pop(),this.current=this.stack.pop(),this._saveValue(t)}else this.done=!0}_saveValue(t){this.done?this.current=t:this.current instanceof Array?this.current.push(t):(this.current[this.key]=t,this.key=null)}_saveValueWithReviver(t){this.done?this.current=this.reviver("",t):this.current instanceof Array?(t=this.reviver(""+this.current.length,t),this.current.push(t),t===void 0&&delete this.current[this.current.length-1]):(t=this.reviver(this.key,t),t!==void 0&&(this.current[this.key]=t),this.key=null)}};$e.prototype.stringValue=$e.prototype._saveValue;$e.prototype.startObject=Ha(Object);$e.prototype.startArray=Ha(Array);$e.prototype.endArray=$e.prototype.endObject;Ka.exports=$e});var vr=J((qo,Ga)=>{"use strict";var{Transform:oi}=require("stream"),ci=qa(),Cr=class{constructor(t){this.depth=t}startObject(){++this.depth}endObject(){--this.depth}startArray(){++this.depth}endArray(){--this.depth}},Pr=class extends oi{constructor(t){super(Object.assign({},t,{writableObjectMode:!0,readableObjectMode:!0})),t&&(this.objectFilter=t.objectFilter,this.includeUndecided=t.includeUndecided),typeof this.objectFilter!="function"&&(this._filter=this._transform),this._transform=this._wait||this._filter,this._assembler=new ci(t)}_transform(t,r,a){this._assembler[t.name]&&(this._assembler[t.name](t.value),this._assembler.depth===this._level&&this._push()),a(null)}_filter(t,r,a){if(this._assembler[t.name]){this._assembler[t.name](t.value);let n=this.objectFilter(this._assembler);if(n)return this._assembler.depth===this._level&&(this._push(),this._transform=this._filter),this._transform=this._accept,a(null);if(n===!1)return this._saved_assembler=this._assembler,this._assembler=new Cr(this._saved_assembler.depth),this._saved_assembler.dropToLevel(this._level),this._assembler.depth===this._level&&(this._assembler=this._saved_assembler,this._transform=this._filter),this._transform=this._reject,a(null);this._assembler.depth===this._level&&this._push(!this.includeUndecided)}a(null)}_accept(t,r,a){this._assembler[t.name]&&(this._assembler[t.name](t.value),this._assembler.depth===this._level&&(this._push(),this._transform=this._filter)),a(null)}_reject(t,r,a){this._assembler[t.name]&&(this._assembler[t.name](t.value),this._assembler.depth===this._level&&(this._assembler=this._saved_assembler,this._transform=this._filter)),a(null)}};Ga.exports=Pr});var Za=J((Go,Ja)=>{"use strict";var li=vr(),ui=gt(),Oe=class e extends li{static make(t){return new e(t)}static withParser(t){return ui(e.make,t)}constructor(t){super(t),this._level=1,this._counter=0}_wait(t,r,a){return t.name!=="startArray"?a(new Error("Top-level object should be an array.")):(this._transform=this._filter,this._transform(t,r,a))}_push(t){this._assembler.current.length&&(t?(++this._counter,this._assembler.current.pop()):this.push({key:this._counter++,value:this._assembler.current.pop()}))}};Oe.streamArray=Oe.make;Oe.make.Constructor=Oe;Ja.exports=Oe});var yn=J((kc,bn)=>{"use strict";var _i=Sr(),$i=gt(),Be=class e extends _i{static make(t){return new e(t)}static withParser(t){return $i(e.make,t)}_checkChunk(t){switch(t.name){case"startObject":case"startArray":if(this._filter(this._stack,t))return this.push(t),this._transform=this._passObject,this._depth=1,!0;break;case"startString":if(this._filter(this._stack,t))return this.push(t),this._transform=this._passString,!0;break;case"startNumber":if(this._filter(this._stack,t))return this.push(t),this._transform=this._passNumber,!0;break;case"nullValue":case"trueValue":case"falseValue":case"stringValue":case"numberValue":if(this._filter(this._stack,t))return this.push(t),this._transform=this._once?this._skip:this._check,!0;break}return!1}};Be.pick=Be.make;Be.make.Constructor=Be;bn.exports=Be});var kn=J((xc,wn)=>{"use strict";var Si=vr(),Ci=gt(),je=class e extends Si{static make(t){return new e(t)}static withParser(t){return Ci(e.make,t)}constructor(t){super(t),this._level=1,this._lastKey=null}_wait(t,r,a){return t.name!=="startObject"?a(new Error("Top-level object should be an object.")):(this._transform=this._filter,this._transform(t,r,a))}_push(t){this._lastKey===null?this._lastKey=this._assembler.key:(!t&&this.push({key:this._lastKey,value:this._assembler.current[this._lastKey]}),this._assembler.current={},this._lastKey=null)}};je.streamObject=je.make;je.make.Constructor=je;wn.exports=je});var Co={};ls(Co,{default:()=>ts});module.exports=us(Co);var We=require("react"),R=require("@raycast/api");var E=O(require("react")),D=require("@raycast/api");var sa=Object.prototype.hasOwnProperty;function Dt(e,t){var r,a;if(e===t)return!0;if(e&&t&&(r=e.constructor)===t.constructor){if(r===Date)return e.getTime()===t.getTime();if(r===RegExp)return e.toString()===t.toString();if(r===Array){if((a=e.length)===t.length)for(;a--&&Dt(e[a],t[a]););return a===-1}if(!r||typeof e=="object"){a=0;for(r in e)if(sa.call(e,r)&&++a&&!sa.call(t,r)||!(r in t)||!Dt(e[r],t[r]))return!1;return Object.keys(t).length===a}}return e!==e&&t!==t}var Fe=O(require("node:fs")),Mt=O(require("node:path")),ma=O(require("node:crypto")),pa=O(require("node:child_process")),ga=require("node:buffer"),He=O(require("node:stream")),ba=require("node:util");var ya=require("react/jsx-runtime");var ar=globalThis;function fs(e){let t=(0,E.useRef)(e),r=(0,E.useRef)(0);return Dt(e,t.current)||(t.current=e,r.current+=1),(0,E.useMemo)(()=>t.current,[r.current])}function ae(e){let t=(0,E.useRef)(e);return t.current=e,t}function ds(e,t){let r=e instanceof Error?e.message:String(e);return(0,D.showToast)({style:D.Toast.Style.Failure,title:t?.title??"Something went wrong",message:t?.message??r,primaryAction:t?.primaryAction??ia(e),secondaryAction:t?.primaryAction?ia(e):void 0})}var ia=e=>{let t=!0,r="[Extension Name]...",a="";try{let i=JSON.parse((0,Fe.readFileSync)((0,Mt.join)(D.environment.assetsPath,"..","package.json"),"utf8"));r=`[${i.title}]...`,a=`https://raycast.com/${i.owner||i.author}/${i.name}`,(!i.owner||i.access==="public")&&(t=!1)}catch{}let n=D.environment.isDevelopment||t,s=e instanceof Error?e?.stack||e?.message||"":String(e);return{title:n?"Copy Logs":"Report Error",onAction(i){i.hide(),n?D.Clipboard.copy(s):(0,D.open)(`https://github.com/raycast/extensions/issues/new?&labels=extension%2Cbug&template=extension_bug_report.yml&title=${encodeURIComponent(r)}&extension-url=${encodeURI(a)}&description=${encodeURIComponent(`#### Error:
\`\`\`
${s}
\`\`\`
`)}`)}}};function hs(e,t,r){let a=(0,E.useRef)(0),[n,s]=(0,E.useState)({isLoading:!0}),i=ae(e),o=ae(r?.abortable),c=ae(t||[]),u=ae(r?.onError),l=ae(r?.onData),f=ae(r?.onWillExecute),g=ae(r?.failureToastOptions),k=ae(n.data),$=(0,E.useRef)(null),m=(0,E.useRef)({page:0}),w=(0,E.useRef)(!1),S=(0,E.useRef)(!0),v=(0,E.useRef)(50),x=(0,E.useCallback)(()=>(o.current&&(o.current.current?.abort(),o.current.current=new AbortController),++a.current),[o]),p=(0,E.useCallback)((...j)=>{let G=x();f.current?.(j),s(I=>({...I,isLoading:!0}));let ke=ms(i.current)(...j);function ue(I){return I.name=="AbortError"||G===a.current&&(u.current?u.current(I):D.environment.launchType!==D.LaunchType.Background&&ds(I,{title:"Failed to fetch latest data",primaryAction:{title:"Retry",onAction(xe){xe.hide(),$.current?.(...c.current||[])}},...g.current}),s({error:I,isLoading:!1})),I}return typeof ke=="function"?(w.current=!0,ke(m.current).then(({data:I,hasMore:xe,cursor:rs})=>(G===a.current&&(m.current&&(m.current.cursor=rs,m.current.lastItem=I?.[I.length-1]),l.current&&l.current(I,m.current),xe&&(v.current=I.length),S.current=xe,s(as=>m.current.page===0?{data:I,isLoading:!1}:{data:(as.data||[])?.concat(I),isLoading:!1})),I),I=>(S.current=!1,ue(I)))):(w.current=!1,ke.then(I=>(G===a.current&&(l.current&&l.current(I),s({data:I,isLoading:!1})),I),ue))},[l,u,c,i,s,$,f,m,g,x]);$.current=p;let y=(0,E.useCallback)(()=>{m.current={page:0};let j=c.current||[];return p(...j)},[p,c]),b=(0,E.useCallback)(async(j,G)=>{let ke;try{if(G?.optimisticUpdate){x(),typeof G?.rollbackOnError!="function"&&G?.rollbackOnError!==!1&&(ke=structuredClone(k.current?.value));let ue=G.optimisticUpdate;s(I=>({...I,data:ue(I.data)}))}return await j}catch(ue){if(typeof G?.rollbackOnError=="function"){let I=G.rollbackOnError;s(xe=>({...xe,data:I(xe.data)}))}else G?.optimisticUpdate&&G?.rollbackOnError!==!1&&s(I=>({...I,data:ke}));throw ue}finally{G?.shouldRevalidateAfter!==!1&&(D.environment.launchType===D.LaunchType.Background||D.environment.commandMode==="menu-bar"?await y():y())}},[y,k,s,x]),C=(0,E.useCallback)(()=>{m.current.page+=1;let j=c.current||[];p(...j)},[m,c,p]);(0,E.useEffect)(()=>{m.current={page:0},r?.execute!==!1?p(...t||[]):x()},[fs([t,r?.execute,p]),o,m]),(0,E.useEffect)(()=>()=>{x()},[x]);let U=r?.execute!==!1?n.isLoading:!1,F={...n,isLoading:U},Pe=w.current?{pageSize:v.current,hasMore:S.current,onLoadMore:C}:void 0;return{...F,revalidate:y,mutate:b,pagination:Pe}}function ms(e){return e===Promise.all||e===Promise.race||e===Promise.resolve||e===Promise.reject?e.bind(Promise):e}function oa(e){return typeof e!="function"?!1:/^function\s+\w*\s*\(\s*\)\s*{\s+\[native code\]\s+}$/i.exec(Function.prototype.toString.call(e))!==null}function ps(e){return e instanceof URLSearchParams?e.toString():e}function wa(e,t=[]){function r(a){return"update"in e?e.update(a,"utf8"):e.write(a)}return{dispatch:function(a){a=ps(a),a===null?this._null():this["_"+typeof a](a)},_object:function(a){let n=/\[object (.*)\]/i,s=Object.prototype.toString.call(a),i=n.exec(s)?.[1]??"unknown:["+s+"]";i=i.toLowerCase();let o=null;if((o=t.indexOf(a))>=0){this.dispatch("[CIRCULAR:"+o+"]");return}else t.push(a);if(Buffer.isBuffer(a))return r("buffer:"),r(a.toString("utf8"));if(i!=="object"&&i!=="function"&&i!=="asyncfunction")if(this["_"+i])this["_"+i](a);else throw new Error('Unknown object type "'+i+'"');else{let c=Object.keys(a);c=c.sort(),oa(a)||c.splice(0,0,"prototype","__proto__","constructor"),r("object:"+c.length+":");let u=this;return c.forEach(function(l){u.dispatch(l),r(":"),u.dispatch(a[l]),r(",")})}},_array:function(a,n){n=typeof n<"u"?n:!1;let s=this;if(r("array:"+a.length+":"),!n||a.length<=1){a.forEach(function(c){s.dispatch(c)});return}let i=[],o=a.map(function(c){let u=gs(),l=t.slice();return wa(u,l).dispatch(c),i=i.concat(l.slice(t.length)),u.read().toString()});t=t.concat(i),o.sort(),this._array(o,!1)},_date:function(a){r("date:"+a.toJSON())},_symbol:function(a){r("symbol:"+a.toString())},_error:function(a){r("error:"+a.toString())},_boolean:function(a){r("bool:"+a.toString())},_string:function(a){r("string:"+a.length+":"),r(a.toString())},_function:function(a){r("fn:"),oa(a)?this.dispatch("[native]"):this.dispatch(a.toString()),this.dispatch("function-name:"+String(a.name)),this._object(a)},_number:function(a){r("number:"+a.toString())},_xml:function(a){r("xml:"+a.toString())},_null:function(){r("Null")},_undefined:function(){r("Undefined")},_regexp:function(a){r("regex:"+a.toString())},_uint8array:function(a){r("uint8array:"),this.dispatch(Array.prototype.slice.call(a))},_uint8clampedarray:function(a){r("uint8clampedarray:"),this.dispatch(Array.prototype.slice.call(a))},_int8array:function(a){r("int8array:"),this.dispatch(Array.prototype.slice.call(a))},_uint16array:function(a){r("uint16array:"),this.dispatch(Array.prototype.slice.call(a))},_int16array:function(a){r("int16array:"),this.dispatch(Array.prototype.slice.call(a))},_uint32array:function(a){r("uint32array:"),this.dispatch(Array.prototype.slice.call(a))},_int32array:function(a){r("int32array:"),this.dispatch(Array.prototype.slice.call(a))},_float32array:function(a){r("float32array:"),this.dispatch(Array.prototype.slice.call(a))},_float64array:function(a){r("float64array:"),this.dispatch(Array.prototype.slice.call(a))},_arraybuffer:function(a){r("arraybuffer:"),this.dispatch(new Uint8Array(a))},_url:function(a){r("url:"+a.toString())},_map:function(a){r("map:");let n=Array.from(a);this._array(n,!0)},_set:function(a){r("set:");let n=Array.from(a);this._array(n,!0)},_file:function(a){r("file:"),this.dispatch([a.name,a.size,a.type,a.lastModified])},_blob:function(){throw Error(`Hashing Blob objects is currently not supported
(see https://github.com/puleos/object-hash/issues/26)
Use "options.replacer" or "options.ignoreUnknown"
`)},_domwindow:function(){r("domwindow")},_bigint:function(a){r("bigint:"+a.toString())},_process:function(){r("process")},_timer:function(){r("timer")},_pipe:function(){r("pipe")},_tcp:function(){r("tcp")},_udp:function(){r("udp")},_tty:function(){r("tty")},_statwatcher:function(){r("statwatcher")},_securecontext:function(){r("securecontext")},_connection:function(){r("connection")},_zlib:function(){r("zlib")},_context:function(){r("context")},_nodescript:function(){r("nodescript")},_httpparser:function(){r("httpparser")},_dataview:function(){r("dataview")},_signal:function(){r("signal")},_fsevent:function(){r("fsevent")},_tlswrap:function(){r("tlswrap")}}}function gs(){return{buf:"",write:function(e){this.buf+=e},end:function(e){this.buf+=e},read:function(){return this.buf}}}function bs(e,t){let r=this[e];return r instanceof Date?`__raycast_cached_date__${r.toISOString()}`:Buffer.isBuffer(r)?`__raycast_cached_buffer__${r.toString("base64")}`:t}function ys(e,t){return typeof t=="string"&&t.startsWith("__raycast_cached_date__")?new Date(t.replace("__raycast_cached_date__","")):typeof t=="string"&&t.startsWith("__raycast_cached_buffer__")?Buffer.from(t.replace("__raycast_cached_buffer__",""),"base64"):t}function ca(e){let t=ma.default.createHash("sha1");return wa(t).dispatch(e),t.digest("hex")}var ws=Symbol("cache without namespace"),la=new Map;function ur(e,t,r){let a=r?.cacheNamespace||ws,n=la.get(a)||la.set(a,new D.Cache({namespace:r?.cacheNamespace})).get(a);if(!n)throw new Error("Missing cache");let s=ae(e),i=ae(t),o=(0,E.useSyncExternalStore)(n.subscribe,()=>{try{return n.get(s.current)}catch(f){console.error("Could not get Cache data:",f);return}}),c=(0,E.useMemo)(()=>{if(typeof o<"u"){if(o==="undefined")return;try{return JSON.parse(o,ys)}catch(f){return console.warn("The cached data is corrupted",f),i.current}}else return i.current},[o,i]),u=ae(c),l=(0,E.useCallback)(f=>{let g=typeof f=="function"?f(u.current):f;if(typeof g>"u")n.set(s.current,"undefined");else{let k=JSON.stringify(g,bs);n.set(s.current,k)}return g},[n,s,u]);return[c,l]}var ze=Symbol();function Ke(e,t,r){let{initialData:a,keepPreviousData:n,internal_cacheKeySuffix:s,...i}=r||{},o=(0,E.useRef)(null),[c,u]=ur(ca(t||[])+s,ze,{cacheNamespace:ca(e)}),l=(0,E.useRef)(c!==ze?c:a),f=(0,E.useRef)(void 0),{mutate:g,revalidate:k,...$}=hs(e,t||[],{...i,onData(x,p){f.current=p,i.onData&&i.onData(x,p),!(p&&p.page>0)&&(o.current="promise",l.current=x,u(x))}}),m,w=$.pagination;f.current&&f.current.page>0&&$.data?m=$.data:o.current==="promise"?m=l.current:n&&c!==ze?(m=c,w&&(w.hasMore=!0,w.pageSize=c.length)):n&&c===ze?m=l.current:c!==ze?(m=c,w&&(w.hasMore=!0,w.pageSize=c.length)):m=a;let S=ae(m),v=(0,E.useCallback)(async(x,p)=>{let y;try{if(p?.optimisticUpdate){typeof p?.rollbackOnError!="function"&&p?.rollbackOnError!==!1&&(y=structuredClone(S.current));let b=p.optimisticUpdate(S.current);o.current="cache",l.current=b,u(b)}return await g(x,{shouldRevalidateAfter:p?.shouldRevalidateAfter})}catch(b){if(typeof p?.rollbackOnError=="function"){let C=p.rollbackOnError(S.current);o.current="cache",l.current=C,u(C)}else p?.optimisticUpdate&&p?.rollbackOnError!==!1&&(o.current="cache",l.current=y,u(y));throw b}},[u,g,S,l,o]);return(0,E.useEffect)(()=>{c!==ze&&(o.current="cache",l.current=c)},[c]),{data:m,isLoading:$.isLoading,error:$.error,mutate:f.current&&f.current.page>0?g:v,pagination:w,revalidate:k}}var Ft=e=>!!e&&typeof e=="object"&&typeof e.removeListener=="function"&&typeof e.emit=="function"&&typeof e.reallyExit=="function"&&typeof e.listeners=="function"&&typeof e.kill=="function"&&typeof e.pid=="number"&&typeof e.on=="function",nr=Symbol.for("signal-exit emitter"),ir=class{constructor(){if(this.emitted={afterExit:!1,exit:!1},this.listeners={afterExit:[],exit:[]},this.count=0,this.id=Math.random(),ar[nr])return ar[nr];Object.defineProperty(ar,nr,{value:this,writable:!1,enumerable:!1,configurable:!1})}on(t,r){this.listeners[t].push(r)}removeListener(t,r){let a=this.listeners[t],n=a.indexOf(r);n!==-1&&(n===0&&a.length===1?a.length=0:a.splice(n,1))}emit(t,r,a){if(this.emitted[t])return!1;this.emitted[t]=!0;let n=!1;for(let s of this.listeners[t])n=s(r,a)===!0||n;return t==="exit"&&(n=this.emit("afterExit",r,a)||n),n}},or=class{onExit(){return()=>{}}load(){}unload(){}},cr=class{#o;#t;#e;#s;#i;#n;#a;#r;constructor(t){this.#o=process.platform==="win32"?"SIGINT":"SIGHUP",this.#t=new ir,this.#n={},this.#a=!1,this.#r=[],this.#r.push("SIGHUP","SIGINT","SIGTERM"),globalThis.process.platform!=="win32"&&this.#r.push("SIGALRM","SIGABRT","SIGVTALRM","SIGXCPU","SIGXFSZ","SIGUSR2","SIGTRAP","SIGSYS","SIGQUIT","SIGIOT"),globalThis.process.platform==="linux"&&this.#r.push("SIGIO","SIGPOLL","SIGPWR","SIGSTKFLT"),this.#e=t,this.#n={};for(let r of this.#r)this.#n[r]=()=>{let a=this.#e.listeners(r),{count:n}=this.#t,s=t;if(typeof s.__signal_exit_emitter__=="object"&&typeof s.__signal_exit_emitter__.count=="number"&&(n+=s.__signal_exit_emitter__.count),a.length===n){this.unload();let i=this.#t.emit("exit",null,r),o=r==="SIGHUP"?this.#o:r;i||t.kill(t.pid,o)}};this.#i=t.reallyExit,this.#s=t.emit}onExit(t,r){if(!Ft(this.#e))return()=>{};this.#a===!1&&this.load();let a=r?.alwaysLast?"afterExit":"exit";return this.#t.on(a,t),()=>{this.#t.removeListener(a,t),this.#t.listeners.exit.length===0&&this.#t.listeners.afterExit.length===0&&this.unload()}}load(){if(!this.#a){this.#a=!0,this.#t.count+=1;for(let t of this.#r)try{let r=this.#n[t];r&&this.#e.on(t,r)}catch{}this.#e.emit=(t,...r)=>this.#l(t,...r),this.#e.reallyExit=t=>this.#c(t)}}unload(){this.#a&&(this.#a=!1,this.#r.forEach(t=>{let r=this.#n[t];if(!r)throw new Error("Listener not defined for signal: "+t);try{this.#e.removeListener(t,r)}catch{}}),this.#e.emit=this.#s,this.#e.reallyExit=this.#i,this.#t.count-=1)}#c(t){return Ft(this.#e)?(this.#e.exitCode=t||0,this.#t.emit("exit",this.#e.exitCode,null),this.#i.call(this.#e,this.#e.exitCode)):0}#l(t,...r){let a=this.#s;if(t==="exit"&&Ft(this.#e)){typeof r[0]=="number"&&(this.#e.exitCode=r[0]);let n=a.call(this.#e,t,...r);return this.#t.emit("exit",this.#e.exitCode,null),n}else return a.call(this.#e,t,...r)}},sr=null,ks=(e,t)=>(sr||(sr=Ft(process)?new cr(process):new or),sr.onExit(e,t));function xs(e,{timeout:t}={}){let r=new Promise((o,c)=>{e.on("exit",(u,l)=>{o({exitCode:u,signal:l,timedOut:!1})}),e.on("error",u=>{c(u)}),e.stdin&&e.stdin.on("error",u=>{c(u)})}),a=ks(()=>{e.kill()});if(t===0||t===void 0)return r.finally(()=>a());let n,s=new Promise((o,c)=>{n=setTimeout(()=>{e.kill("SIGTERM"),c(Object.assign(new Error("Timed out"),{timedOut:!0,signal:"SIGTERM"}))},t)}),i=r.finally(()=>{clearTimeout(n)});return Promise.race([s,i]).finally(()=>a())}var lr=class extends Error{constructor(){super("The output is too big"),this.name="MaxBufferError"}};function _s(e){let{encoding:t}=e,r=t==="buffer",a=new He.default.PassThrough({objectMode:!1});t&&t!=="buffer"&&a.setEncoding(t);let n=0,s=[];return a.on("data",i=>{s.push(i),n+=i.length}),a.getBufferedValue=()=>r?Buffer.concat(s,n):s.join(""),a.getBufferedLength=()=>n,a}async function ua(e,t){let r=_s(t);return await new Promise((a,n)=>{let s=i=>{i&&r.getBufferedLength()<=ga.constants.MAX_LENGTH&&(i.bufferedData=r.getBufferedValue()),n(i)};(async()=>{try{await(0,ba.promisify)(He.default.pipeline)(e,r),a()}catch(i){s(i)}})(),r.on("data",()=>{r.getBufferedLength()>8e7&&s(new lr)})}),r.getBufferedValue()}async function fa(e,t){e.destroy();try{return await t}catch(r){return r.bufferedData}}async function $s({stdout:e,stderr:t},{encoding:r},a){let n=ua(e,{encoding:r}),s=ua(t,{encoding:r});try{return await Promise.all([a,n,s])}catch(i){return Promise.all([{error:i,exitCode:null,signal:i.signal,timedOut:i.timedOut||!1},fa(e,n),fa(t,s)])}}function Ss(e){let t=typeof e=="string"?`
`:10,r=typeof e=="string"?"\r":13;return e[e.length-1]===t&&(e=e.slice(0,-1)),e[e.length-1]===r&&(e=e.slice(0,-1)),e}function da(e,t){return e.stripFinalNewline?Ss(t):t}function Cs({timedOut:e,timeout:t,signal:r,exitCode:a}){return e?`timed out after ${t} milliseconds`:r!=null?`was killed with ${r}`:a!=null?`failed with exit code ${a}`:"failed"}function Ps({stdout:e,stderr:t,error:r,signal:a,exitCode:n,command:s,timedOut:i,options:o,parentError:c}){let l=`Command ${Cs({timedOut:i,timeout:o?.timeout,signal:a,exitCode:n})}: ${s}`,f=r?`${l}
${r.message}`:l,g=[f,t,e].filter(Boolean).join(`
`);return r?r.originalMessage=r.message:r=c,r.message=g,r.shortMessage=f,r.command=s,r.exitCode=n,r.signal=a,r.stdout=e,r.stderr=t,"bufferedData"in r&&delete r.bufferedData,r}function vs({stdout:e,stderr:t,error:r,exitCode:a,signal:n,timedOut:s,command:i,options:o,parentError:c}){if(r||a!==0||n!==null)throw Ps({error:r,exitCode:a,signal:n,stdout:e,stderr:t,command:i,timedOut:s,options:o,parentError:c});return e}function ha(e,t,r,a){let n=(a-90)*Math.PI/180;return{x:e+r*Math.cos(n),y:t+r*Math.sin(n)}}function As(e,t,r,a,n){let s=ha(e,t,r,n),i=ha(e,t,r,a),o=n-a<=180?"0":"1";return["M",s.x,s.y,"A",r,r,0,o,0,i.x,i.y].join(" ")}function dt(e,t=D.Color.Red,r){let a=r?.background||(D.environment.appearance==="light"?"black":"white"),n=r?.backgroundOpacity||.1,s=10,o=50-5-s/2,c=`<svg xmlns="http://www.w3.org/2000/svg" width="100px" height="100px">
      <circle cx="50" cy="50" r="${o}" stroke-width="${s}" stroke="${e<1?a:t}" opacity="${e<1?n:"1"}" fill="none" />
      ${e>0&&e<1?`<path d="${As(50,50,o,0,e*360)}" stroke="${t}" stroke-width="${s}" fill="none" />`:""}
    </svg>
  `.replaceAll(`
`,"");return`data:image/svg+xml,${encodeURIComponent(c)}`}async function ka(e,t,r){if(process.platform!=="darwin")throw new Error("AppleScript is only supported on macOS");let{humanReadableOutput:a,language:n,timeout:s,...i}=Array.isArray(t)?r||{}:t||{},o=a!==!1?[]:["-ss"];n==="JavaScript"&&o.push("-l","JavaScript"),Array.isArray(t)&&o.push("-",...t);let c=pa.default.spawn("osascript",o,{...i,env:{PATH:"/usr/local/bin:/usr/bin:/bin:/usr/sbin:/sbin"}}),u=xs(c,{timeout:s??1e4});c.stdin.end(e);let[{error:l,exitCode:f,signal:g,timedOut:k},$,m]=await $s(c,{encoding:"utf8"},u),w=da({stripFinalNewline:!0},$),S=da({stripFinalNewline:!0},m);return vs({stdout:w,stderr:S,error:l,exitCode:f,signal:g,timedOut:k,command:"osascript",options:r,parentError:new Error})}var Fn=require("react"),at=require("@raycast/api");var xa=require("@raycast/api"),T=(0,xa.getPreferenceValues)();var Aa=O(hr()),Me=new Aa.Logger({prefix:"[Brew]"}),L=Me.child("[Commands]"),Z=Me.child("[Cache]"),re=Me.child("[Actions]"),B=Me.child("[Fetch]"),oe=Me.child("[Search]"),ne=Me.child("[UI]");var Y=class extends Error{constructor(t,r){super(t),this.name="BrewError",this.brewCause=r?.cause}},ve=class extends Y{constructor(t,r){super(t,{cause:r?.cause}),this.name="NetworkError",this.statusCode=r?.statusCode,this.url=r?.url}},ht=class extends Y{constructor(t,r){super(t,r),this.name="ParseError"}},Ge=class extends Y{constructor(t,r){super(t,{cause:r?.cause}),this.name="BrewCommandError",this.command=r?.command,this.exitCode=r?.exitCode,this.stderr=r?.stderr}},Rt=class extends Y{constructor(t,r){super(t,{cause:r?.cause}),this.name="BrewNotFoundError",this.path=r?.path}};var de=class extends Y{constructor(t,r){super(t,{cause:r?.cause}),this.name="BrewLockError",this.command=r?.command}},mt=class extends Y{constructor(t,r){super(t,{cause:r?.cause}),this.name="DownloadTimeoutError",this.packageName=r?.packageName,this.phase=r?.phase,this.timeoutMs=r?.timeoutMs,this.elapsedMs=r?.elapsedMs}},Ae=class extends Y{constructor(t,r){super(t,{cause:r?.cause}),this.name="StaleProcessError",this.packageName=r?.packageName,this.lastPhase=r?.lastPhase,this.staleDurationMs=r?.staleDurationMs}},Ot=class extends Y{constructor(t,r){super(t,{cause:r?.cause}),this.name="PackageNotFoundError",this.packageName=r?.packageName,this.packageType=r?.packageType}},Nt=class extends Y{constructor(t,r){super(t,{cause:r?.cause}),this.name="PackageDisabledError",this.packageName=r?.packageName,this.packageType=r?.packageType,this.disabledDate=r?.disabledDate,this.reason=r?.reason}},Vt=class extends Y{constructor(t,r){super(t,{cause:r?.cause}),this.name="PackageConflictError",this.packageName=r?.packageName,this.conflictsWith=r?.conflictsWith}},Bt=class extends Y{constructor(t,r){super(t,{cause:r?.cause}),this.name="UnsupportedMacOSError",this.packageName=r?.packageName,this.requiredVersion=r?.requiredVersion,this.currentVersion=r?.currentVersion}};function jt(e){return e instanceof ve}function ce(e){return e instanceof de}function Ia(e){return e instanceof mt}function Ea(e){return e instanceof Ae}function Le(e){return jt(e)||ce(e)||Ia(e)||Ea(e)}var Ts=[/lockf:.*already locked/i,/another active Homebrew/i,/another brew process/i,/another.*brew.*update.*process/i,/Homebrew is already running/i,/Error: Another active Homebrew/i,/Error: Another.*brew.*process/i,/waiting for lock/i,/lock file/i,/has already locked/i,/brew upgrade.*process has already/i],Ds=/Error: (Cask|Formula) '([^']+)' has been disabled(?: because (.+?))?(?:! It was disabled on (\d{4}-\d{2}-\d{2}))?/i;function pt(e){return Ts.some(t=>t.test(e))}function mr(e){let t=e.match(Ds);return t?{packageType:t[1].toLowerCase(),packageName:t[2],reason:t[3]?.trim(),disabledDate:t[4]}:null}function se(e){return e instanceof Error?e:new Error(String(e))}function _e(e){if(e instanceof de)return"Another brew process is already running. Please wait for it to finish and try again.";if(e instanceof mt){let t=e.packageName?` for "${e.packageName}"`:"",r=e.phase?` during ${e.phase}`:"";return`Download timed out${t}${r}. Please try again.`}if(e instanceof Ae){let t=e.packageName?` for "${e.packageName}"`:"",r=e.lastPhase?` (stuck at ${e.lastPhase})`:"";return`Process appears stuck${t}${r}. The operation was cancelled.`}if(e instanceof Nt){let t=e.packageType??"package",a=`${t.charAt(0).toUpperCase()+t.slice(1)} "${e.packageName}" has been discontinued`;return e.reason&&(a+=`: ${e.reason}`),e.disabledDate&&(a+=` (disabled on ${e.disabledDate})`),a}if(e instanceof Vt){let t=e.conflictsWith?.join(", ")??"another package";return`"${e.packageName}" conflicts with ${t}. Please uninstall the conflicting package first.`}if(e instanceof Bt){let t=`"${e.packageName}" requires a different macOS version`;return e.requiredVersion&&(t+=` (requires ${e.requiredVersion})`),t}if(e instanceof ve)return e.statusCode?`Network error (HTTP ${e.statusCode}): ${e.message}`:`Network error: ${e.message}`;if(e instanceof Rt)return`Homebrew not found: ${e.message}`;if(e instanceof Ot){let t=e.packageType??"package";return`${t.charAt(0).toUpperCase()+t.slice(1)} not found: ${e.packageName??e.message}`}if(e instanceof Ge){if(e.exitCode===void 0||e.exitCode===null)return"Cancelled";if(e.stderr){let t=mr(e.stderr);if(t){let r=`${t.packageType.charAt(0).toUpperCase()+t.packageType.slice(1)} "${t.packageName}" has been discontinued`;return t.reason&&(r+=`: ${t.reason}`),t.disabledDate&&(r+=` (disabled on ${t.disabledDate})`),r}}return e.stderr??e.message}if(e instanceof Y)return e.message;if(e instanceof Error){if(e.name==="AbortError")return"Cancelled";let t=e;if(t.stderr){let r=mr(t.stderr);if(r){let a=`${r.packageType.charAt(0).toUpperCase()+r.packageType.slice(1)} "${r.packageName}" has been discontinued`;return r.reason&&(a+=`: ${r.reason}`),r.disabledDate&&(a+=` (disabled on ${r.disabledDate})`),a}return t.stderr}return e.message}return String(e)}var Ze=require("@raycast/api"),Dr=O(require("path")),Je=O(require("fs"));var Xa=require("fs/promises"),Er=require("stream"),Qa=O(Wt()),en=O(xr()),tn=O(za()),rn=O(Za()),Tr=require("stream/promises");var Ya=require("node:timers");async function Ar(e){return new Promise(t=>(0,Ya.setTimeout)(t,e))}var an=(()=>{try{Je.default.mkdirSync(Ze.environment.supportPath,{recursive:!0})}catch{Z.warn("Failed to create supportPath")}return Ze.environment.supportPath})(),Fr=Ze.environment.supportPath.split(Dr.default.sep).find(e=>!!e.startsWith("com.raycast"))??"com.raycast.macos";function bt(e){return Dr.default.join(an,e)}var fi=["name","tap","desc","homepage","versions","outdated","caveats","token","version","installed","auto_updates","depends_on","conflicts_with","license","aliases","dependencies","build_dependencies","installed","keg_only","linked_key","pinned"],Ir=2,di=1e3;async function Ye(e,t){return e.value?(t?.({url:e.url,bytesDownloaded:0,totalBytes:0,percent:100,complete:!0}),e.value):(e.fetch||(e.fetch=hi(e,t).then(r=>(e.value=r,r)).finally(()=>{e.fetch=void 0})),e.fetch)}async function hi(e,t){let r;for(let a=0;a<=Ir;a++)try{return await mi(e,a,t)}catch(n){if(r=n instanceof Error?n:new Error(String(n)),!Le(n)||a>=Ir)throw r;B.warn("Fetch failed, retrying",{url:e.url,attempt:a+1,maxRetries:Ir,error:r.message}),await Ar(di*(a+1))}throw r}async function mi(e,t,r){let a=Date.now();B.log("Fetching remote",{url:e.url,attempt:t});async function n(){let o=Date.now();B.log("Starting download",{url:e.url});try{let c=await fetch(e.url,{headers:{"Accept-Encoding":"identity"}});if(!c.ok||!c.body)throw new ve(`HTTP ${c.status}: ${c.statusText}`,{statusCode:c.status,url:e.url});let u=c.headers.get("content-length"),l=u?parseInt(u,10):0,f=0;r?.({url:e.url,bytesDownloaded:0,totalBytes:l,percent:0,complete:!1});let g=Je.default.createWriteStream(e.cachePath);try{if(r){let m=0,w=100,S=new TransformStream({transform(x,p){f+=x.length;let y=Date.now();if(l>0&&f>=l||y-m>=w){let C=l>0?Math.round(f/l*100):-1;m=y,r({url:e.url,bytesDownloaded:f,totalBytes:l,percent:Math.min(C,100),complete:!1})}p.enqueue(x)}}),v=c.body.pipeThrough(S);await(0,Tr.pipeline)(Er.Readable.fromWeb(v),g)}else await(0,Tr.pipeline)(Er.Readable.fromWeb(c.body),g)}catch(m){g.destroy();try{Je.default.unlinkSync(e.cachePath),B.log("Cleaned up partial cache file",{path:e.cachePath})}catch{}let w=m instanceof Error?m.message:String(m);throw r?.({url:e.url,bytesDownloaded:f,totalBytes:l,percent:-1,complete:!1,error:!0,errorMessage:w}),m}r?.({url:e.url,bytesDownloaded:f,totalBytes:l,percent:100,complete:!0});let k=Date.now()-o,$={path:e.cachePath,url:e.url,downloadDurationMs:k};if(l>0){let m=(l/1024).toFixed(2);$.responseSizeBytes=l,$.responseSizeKb=`${m} KB`}T.useInternalApi&&($.usingInternalApi=!0),Z.log("Cache updated from remote",$)}catch(c){let u=Date.now()-o;B.error("Download failed",{url:e.url,durationMs:u,error:c});let l=c instanceof Error?c.message:String(c);throw r?.({url:e.url,bytesDownloaded:0,totalBytes:0,percent:-1,complete:!1,error:!0,errorMessage:l}),jt(c)?c:new ve(`Failed to fetch ${e.url}`,{cause:c instanceof Error?c:void 0,url:e.url})}}async function s(){let o,c=0;try{o=await(0,Xa.stat)(e.cachePath);let u=await fetch(e.url,{method:"HEAD"});c=Date.parse(u.headers.get("last-modified")??"")}catch{Z.log("Cache miss",{path:e.cachePath})}!o||o.size==0||c>o.mtimeMs?await n():B.log("Using cached data (up to date)",{url:e.url,cacheAgeMs:Date.now()-o.mtimeMs})}async function i(){let o=Date.now();B.log("Parsing cache",{path:e.cachePath});let c=new RegExp(`\\b(${fi.join("|")})\\b`);return new Promise((u,l)=>{let f=[],g=0,k=100,$=w=>{r?.({url:e.url,bytesDownloaded:0,totalBytes:0,percent:100,complete:w,phase:"processing",itemsProcessed:f.length,totalItems:w?f.length:void 0})},m=(0,Qa.chain)([Je.default.createReadStream(e.cachePath),(0,en.parser)(),(0,tn.filter)({filter:c}),(0,rn.streamArray)()]);m.on("data",w=>{if(w&&typeof w=="object"&&"value"in w){f.push(w.value);let S=Date.now();r&&S-g>=k&&(g=S,$(!1))}}),m.on("end",()=>{let w=Date.now()-o,S=Date.now()-a;B.log("Fetch completed",{url:e.url,itemCount:f.length,parseDurationMs:w,totalDurationMs:S}),$(!0),u(f)}),m.on("error",w=>{let S=Date.now()-o;Z.warn("Cache parse error, removing corrupted cache",{path:e.cachePath,error:w.message,parseDurationMs:S}),Je.default.rmSync(e.cachePath),l(new ht("Failed to parse cached data",{cause:w}))})})}return s().then(i)}var X=require("@raycast/api");function yt(e){let t={style:X.Toast.Style.Animated,title:e.title,message:e.message},r;e.cancelable&&(r=new AbortController,t.primaryAction={title:"Cancel",onAction:()=>{r?.abort(),a.hide()}});let a=new X.Toast(t);return a.show(),{abort:r,updateMessage:n=>{a.message=n},updateTitle:n=>{a.title=n},showSuccessHUD:async n=>{T.closeAfterAction?(a.hide(),await(0,X.showHUD)(`\u2705 ${n}`)):(a.style=X.Toast.Style.Success,a.title=n,a.message=void 0,a.primaryAction=void 0)},showFailureHUD:async n=>{T.closeAfterAction?(a.hide(),await(0,X.showHUD)(`\u274C ${n}`)):(a.style=X.Toast.Style.Failure,a.title=n,a.message=void 0,a.primaryAction=void 0)},hide:()=>{a.hide()}}}async function Ne(e,t,r){if(t.name==="AbortError"){ne.log("Operation aborted by user");return}let a=t,n=_e(t),s=ce(t);ne.error(e,{errorType:t.name,message:t.message,stderr:a.stderr,code:a.code,recoverable:Le(t),isLockError:s});let i=s?"Brew is Busy":e,o={style:X.Toast.Style.Failure,title:i,message:n,primaryAction:{title:"Copy Logs",onAction:()=>{let u=s?`${i}
${n}

Tip: Check Activity Monitor or run 'ps aux | grep brew' in Terminal to see what's running.`:n;X.Clipboard.copy(u)}}};if(Le(t)&&r?.retryAction){let u=r.retryAction;o.secondaryAction={title:"Retry",onAction:async l=>{l.style=X.Toast.Style.Animated,l.title="Retrying...",l.message=void 0;try{await u(),l.style=X.Toast.Style.Success,l.title="Success"}catch(f){l.style=X.Toast.Style.Failure,l.title=ce(f)?"Brew is Busy":e,l.message=_e(f)}}}}await new X.Toast(o).show()}Array.prototype.first||(Array.prototype.first=function(){return this.at(0)});Array.prototype.last||(Array.prototype.last=function(){return this.at(-1)});Array.prototype.isTruncated||(Array.prototype.isTruncated=function(){return this.totalLength?this.length<this.totalLength:!1});String.ellipsis||(String.ellipsis="\u2026");var nn=O(hr()),Ve=new nn.Logger({prefix:"[Brew]"}).child("[Memory]"),kt={heapPercentWarning:70,heapPercentCritical:85,deltaWarningMB:50};function Xe(e){return e<1024?`${e} B`:e<1024*1024?`${(e/1024).toFixed(1)} KB`:`${(e/(1024*1024)).toFixed(1)} MB`}function pi(e){let t=e.match(/at\s+(.+?)\s+\((.+):(\d+):(\d+)\)/);if(t)return{functionName:t[1],fileName:t[2],lineNumber:parseInt(t[3],10),columnNumber:parseInt(t[4],10)};let r=e.match(/at\s+(.+):(\d+):(\d+)/);if(r)return{functionName:"<anonymous>",fileName:r[1],lineNumber:parseInt(r[2],10),columnNumber:parseInt(r[3],10)}}function gi(e=2){let t=new Error().stack;if(!t)return;let a=t.split(`
`)[e+1];if(a)return pi(a)}function bi(e=2,t=5){let r=new Error().stack;return r?r.split(`
`).slice(e+1,e+1+t).map(s=>s.trim()).join(`
`):""}function wt(e,t=!1){let r=process.memoryUsage(),a=r.heapTotal>0?r.heapUsed/r.heapTotal*100:0,n={timestamp:Date.now(),label:e,rss:r.rss,heapTotal:r.heapTotal,heapUsed:r.heapUsed,external:r.external,arrayBuffers:r.arrayBuffers,heapPercent:a,caller:gi(3)};return t&&(n.stack=bi(3)),n}function yi(e,t){return{rss:t.rss-e.rss,heapTotal:t.heapTotal-e.heapTotal,heapUsed:t.heapUsed-e.heapUsed,external:t.external-e.external,arrayBuffers:t.arrayBuffers-e.arrayBuffers}}function wi(e){return e>=kt.heapPercentCritical?"\u{1F534} CRITICAL":e>=kt.heapPercentWarning?"\u26A0\uFE0F HIGH":""}function xt(e){let t=wi(e.heapPercent),r={label:e.label,heapUsed:Xe(e.heapUsed),heapTotal:Xe(e.heapTotal),heapPercent:`${e.heapPercent.toFixed(1)}%`,rss:Xe(e.rss)};if(t&&(r.warning=t),e.caller){let{functionName:a,fileName:n,lineNumber:s}=e.caller,i=n.split("/").slice(-2).join("/");r.caller=`${a} (${i}:${s})`}return e.stack&&(r.stack=e.stack),r}function _t(e,t=!1){let r=wt(e,t);return Ve.log(e,xt(r)),r}function ki(e,t){t.heapPercent>=kt.heapPercentCritical?Ve.error(`${e} - CRITICAL memory usage`,{...xt(t),recommendation:"Consider reducing data size or clearing cache"}):t.heapPercent>=kt.heapPercentWarning&&Ve.warn(`${e} - High memory usage`,xt(t))}async function Mr(e,t,r={}){let{includeStack:a=!1,logAlways:n=!0}=r,s=wt(`Before ${e}`,a),i=Date.now();n&&Ve.log(`Starting: ${e}`,xt(s));let o;try{o=await t()}catch(k){let $=wt(`Error in ${e}`,!0);throw Ve.error(`Memory state at error in ${e}`,{...xt($),error:k instanceof Error?k.message:String(k)}),k}let c=wt(`After ${e}`,a),u=Date.now()-i,l=yi(s,c),f=l.heapUsed/(1024*1024),g=Math.abs(f)>=kt.deltaWarningMB;return(n||g)&&Ve.log(`Completed: ${e}`,{durationMs:u,heapDelta:Xe(l.heapUsed),heapBefore:Xe(s.heapUsed),heapAfter:Xe(c.heapUsed),heapPercent:`${c.heapPercent.toFixed(1)}%`,...g?{warning:`\u26A0\uFE0F Large heap change: ${f.toFixed(1)} MB`}:{}}),ki(e,c),{result:o,before:s,after:c,delta:l,durationMs:u}}var sn=require("child_process"),Lr=require("path"),on=require("os");var Qe=(()=>{if(T.customBrewPath&&T.customBrewPath.length>0)return(0,Lr.join)(T.customBrewPath,"..","..");try{return(0,sn.execSync)("brew --prefix",{encoding:"utf8"}).trim()}catch{return(0,on.cpus)()[0]?.model?.includes("Apple")?"/opt/homebrew":"/usr/local"}})(),pe=e=>(0,Lr.join)(Qe,e),Ie=()=>pe("bin/brew");var ln=require("child_process"),un=require("util"),fn=require("fs"),zt=O(require("fs/promises")),dn=require("path"),hn=require("@raycast/api");var xi=(0,un.promisify)(ln.exec),cn=!1;async function Se(e,t){try{let r=await Ht();return await xi(`${Ie()} ${e}`,{signal:t?.signal,env:r,maxBuffer:10*1024*1024})}catch(r){let a=r,n=a?.stderr||a?.stdout||"";throw pt(n)?(L.warn("Brew lock detected - another process is running",{command:e,stderr:a?.stderr}),new de("Another brew process is already running",{command:e,cause:a})):T.customBrewPath&&a&&a.code===127?(a.stderr=`Brew executable not found at: ${T.customBrewPath}`,a):r}}async function Ht(){let e=(0,dn.join)(hn.environment.assetsPath,"askpass.sh");try{await zt.access(e,fn.constants.X_OK)}catch{await zt.chmod(e,493)}let t={...process.env};t.SUDO_ASKPASS=e,t.HOMEBREW_BROWSER=Fr;let r=T.disableDownloadConcurrency;r&&(t.HOMEBREW_DOWNLOAD_CONCURRENCY="1");let a=T.useInternalApi;return a&&(t.HOMEBREW_USE_INTERNAL_API="1"),cn||(cn=!0,L.log("Homebrew 5.0 Configuration",{downloadConcurrencyEnabled:!r,downloadConcurrencyMode:r?"sequential (1)":"parallel (auto)",internalApiEnabled:a,verboseLogging:T.verboseLogging})),t}var mn=require("child_process");var Ur=300*1e3,pn=600*1e3;function gn(e){let t=e.trim();if(!t)return null;let r=t.replace(/^=+>\s*/,"");if(t.includes("Downloading"))return{phase:"downloading",message:r};let a=t.match(/#+\s*(\d+\.?\d*)%/);return a?{phase:"downloading",message:`Downloading... ${a[1]}%`,percentage:parseFloat(a[1])}:t.includes("Verifying")||t.includes("checksum")?{phase:"verifying",message:r}:t.includes("Pouring")||t.includes("Extracting")?{phase:"extracting",message:r}:t.includes("Installing")||t.includes("==> Installing")?{phase:"installing",message:r}:t.includes("Linking")||t.includes("==> Linking")?{phase:"linking",message:r}:t.includes("Cleaning")||t.includes("Removing")?{phase:"cleaning",message:r}:t.includes("==> Caveats")||t.includes("==> Summary")?{phase:"complete",message:r}:t.startsWith("==>")?{phase:"installing",message:r}:null}async function $t(e,t,r,a){let n=await Ht(),s=e.split(/\s+/).filter(Boolean),i=a?.staleTimeoutMs??Ur,o=a?.packageName,c=a?.verboseLogging??!1;return L.log("Executing brew with progress",{command:e,packageName:o,staleTimeoutMs:i}),new Promise((u,l)=>{let f=(0,mn.spawn)(Ie(),s,{env:n,stdio:["ignore","pipe","pipe"]}),g="",k="",$=Date.now(),m="starting",w=null,S=!1,v=()=>{w&&(clearInterval(w),w=null)},x=y=>{S||(S=!0,v(),f.kill("SIGTERM"),l(y))};w=setInterval(()=>{let b=Date.now()-$,C=m==="downloading"?pn:i;b>C?(L.warn("Stale process detected",{command:e,packageName:o,lastPhase:m,staleDurationMs:b,timeoutMs:C}),x(new Ae(`Process appears stuck during ${m}`,{packageName:o,lastPhase:m,staleDurationMs:b}))):c&&L.log("Stale check passed",{command:e,phase:m,timeSinceLastProgress:b,timeout:C})},3e4),r&&r.addEventListener("abort",()=>{if(S)return;S=!0,v(),f.kill("SIGTERM");let y=new Error("Cancelled");y.name="AbortError",l(y)}),t?.({phase:"starting",message:`Running: brew ${e.trim()}`});let p=(y,b)=>{$=Date.now();let C=y.split(`
`);for(let U of C){let F=gn(U);F?(F.phase!==m&&(L.log("Phase transition",{command:e,packageName:o,from:m,to:F.phase,message:F.message}),m=F.phase),t?.(F)):c&&U.trim()&&L.log(`Unparsed ${b}`,{line:U.trim()})}};f.stdout?.on("data",y=>{let b=y.toString();g+=b,p(b,"stdout")}),f.stderr?.on("data",y=>{let b=y.toString();if(k+=b,pt(b)){x(new de("Another brew process is already running",{command:e}));return}p(b,"stderr")}),f.on("close",y=>{v(),!S&&(L.log("Command completed",{command:e,packageName:o,exitCode:y,finalPhase:m}),y===0?(t?.({phase:"complete",message:"Operation completed successfully"}),u({stdout:g,stderr:k})):(t?.({phase:"error",message:`Command failed with exit code ${y}`}),l(new Ge(`brew ${e} failed with exit code ${y}`,{command:e,exitCode:y??void 0,stderr:k}))))}),f.on("error",y=>{v(),!S&&(t?.({phase:"error",message:y.message}),l(y))})})}var Ce=O(require("fs/promises")),Tn=require("child_process");var Kt=require("os"),xn=require("child_process"),be=O(require("fs")),_n=O(Wt()),$n=O(xr()),Sn=O(yn()),Cn=O(kn());var Pi={15:"sequoia",14:"sonoma",13:"ventura",12:"monterey",11:"big_sur"},vi={tahoe:26},St=null,ge=null;function qt(){if(St)return St;let e=Pn(),t=Ii();return St=`${e}_${t}`,B.log("Detected system tag",{systemTag:St,architecture:e,macOSVersion:t}),St}function Pn(){if(process.arch==="arm64")return"arm64";if(process.arch==="x64")return"x86_64";try{let e=(0,Kt.cpus)();if(!e||e.length===0)return B.warn("No CPUs detected, defaulting to x86_64"),"x86_64";let t=e[0];return!t||typeof t.model!="string"?(B.warn("CPU model is not a string, defaulting to x86_64",{cpuModel:typeof t?.model}),"x86_64"):t.model.includes("Apple")?"arm64":(t.model.includes("Intel")||B.warn("Unknown CPU model, defaulting to x86_64",{cpuModel:t.model}),"x86_64")}catch(e){return B.warn("CPU detection failed, defaulting to x86_64",{error:e instanceof Error?e.message:String(e)}),"x86_64"}}function Ai(){if(ge!==null)return ge;let e=process.env.HOMEBREW_MACOS_VERSION;if(e){let r=parseInt(e,10);if(!isNaN(r)&&r>=11&&r<=30)return ge=r,ge}try{let r=(0,xn.execSync)("sw_vers -productVersion",{encoding:"utf8",timeout:5e3,stdio:["pipe","pipe","pipe"]}).trim(),a=parseInt(r.split(".")[0],10);if(!isNaN(a)&&a>=11)return ge=a,ge}catch{}try{let r=(0,Kt.release)(),a=parseInt(r.split(".")[0],10);if(!isNaN(a)&&a>=20)return ge=a-9,ge}catch{}return ge=Pn()==="arm64"?15:14,ge}function Ii(){let e=Ai(),t=Pi[e];if(t)return t;for(let[r,a]of Object.entries(vi))if(e===a)return r;return e>15?(B.warn("Unknown macOS version, using sequoia as fallback",{detectedVersion:e}),"sequoia"):(B.warn("Unsupported macOS version detected",{detectedVersion:e,minimumSupported:11}),"big_sur")}var vn="https://formulae.brew.sh/api/internal";function Rr(){let e=qt();return`${vn}/formula.${e}.jws.json`}function An(){let e=qt();return`${vn}/cask.${e}.jws.json`}async function In(e,t){let r=Rr(),a=Date.now(),n=e+".jws.tmp";B.log("Downloading internal formulae API for cache",{url:r,cachePath:e}),await Mr("downloadAndCacheInternalFormulae",async()=>{t?.({url:r,bytesDownloaded:0,totalBytes:0,percent:0,complete:!1,phase:"downloading"});let s=await fetch(r);if(!s.ok||!s.body)throw new Error(`HTTP ${s.status}: ${s.statusText}`);let i=s.headers.get("content-length"),o=i?parseInt(i,10):0,c=0,u=0,l=100,f=be.createWriteStream(n),g=s.body.getReader();for(;;){let{done:S,value:v}=await g.read();if(S)break;f.write(Buffer.from(v)),c+=v.length;let x=Date.now();if(x-u>=l){u=x;let p=o>0?Math.round(c/o*100):-1;t?.({url:r,bytesDownloaded:c,totalBytes:o,percent:p,complete:!1,phase:"downloading"})}}await new Promise((S,v)=>{f.end(x=>{x?v(x):S()})}),_t("After formulae download to disk"),t?.({url:r,bytesDownloaded:c,totalBytes:o,percent:100,complete:!1,phase:"processing"});let k=e+".payload.tmp";await Ei(n,k),_t("After JWS payload extraction to disk");let $=0,m=be.createWriteStream(e);m.write("["),await new Promise((S,v)=>{let x=(0,_n.chain)([be.createReadStream(k),(0,$n.parser)(),(0,Sn.pick)({filter:"formulae"}),(0,Cn.streamObject)()]),p=!0;x.on("data",y=>{if(y&&y.key&&y.value){let b=Ti(y.key,y.value);p?(m.write(`
`),p=!1):m.write(`,
`),m.write(JSON.stringify(b)),$++;let C=Date.now();C-u>=l&&(u=C,t?.({url:r,bytesDownloaded:c,totalBytes:o,percent:100,complete:!1,phase:"processing",itemsProcessed:$}))}}),x.on("end",()=>{m.write(`
]`),m.end(y=>{y?v(y):S()})}),x.on("error",v)});try{be.unlinkSync(n),be.unlinkSync(k)}catch{}_t("After formulae cache write (streaming)");let w=Date.now()-a;B.log("Internal formulae cached",{url:r,cachePath:e,count:$,durationMs:w,downloadBytes:c}),t?.({url:r,bytesDownloaded:c,totalBytes:o,percent:100,complete:!0,phase:"processing",itemsProcessed:$,totalItems:$})},{logAlways:!0})}async function Ei(e,t){return new Promise((r,a)=>{let n=be.createReadStream(e,{encoding:"utf8",highWaterMark:16384}),s=be.createWriteStream(t,{highWaterMark:16*1024}),i="searching",o="",c="",u=!1,l=[],f=0,g=8*1024,k=()=>{l.length>0&&(s.write(l.join("")),l.length=0,f=0)},$=w=>{l.push(w),f+=w.length,f>=g&&k()},m='"payload":"';n.on("data",w=>{let S=typeof w=="string"?w:w.toString("utf8");if(i==="done")return;let v=-1;for(let x=0;x<S.length;x++){let p=S[x];if(i==="searching")o+=p,o.length>m.length&&(o=o.slice(-m.length)),o===m&&(i="in_payload",o="");else if(i==="in_payload")if(u)u=!1,p==="n"?$(`
`):p==="r"?$("\r"):p==="t"?$("	"):p==='"'?$('"'):p==="\\"?$("\\"):p==="/"?$("/"):p==="u"?c="\\u":$(p);else if(c.length>0){if(c+=p,c.length===6){try{let y=parseInt(c.slice(2),16);$(String.fromCharCode(y))}catch{$(c)}c=""}}else if(p==="\\")v>=0&&($(S.slice(v,x)),v=-1),u=!0;else if(p==='"'){v>=0&&($(S.slice(v,x)),v=-1),i="done",k(),s.end(),r();return}else v<0&&(v=x)}i==="in_payload"&&v>=0&&$(S.slice(v))}),n.on("end",()=>{i!=="done"&&(k(),s.end(),i==="searching"?a(new Error("No payload found in JWS file")):r())}),n.on("error",w=>{s.end(),a(w)}),s.on("error",a)})}function Ti(e,t){let[r,,,,a]=t;return{name:e,tap:"homebrew/core",homepage:"",versions:{stable:r,bottle:!0},outdated:!1,license:null,aliases:[],dependencies:a||[],build_dependencies:[],installed:[],keg_only:!1,linked_key:"",pinned:!1}}function Or(){let e=qt(),t=Rr(),r=An();Z.log("Internal API configuration",{systemTag:e,formulaUrl:t,caskUrl:r})}var et=bt("installedv2.json"),Gt=bt("formula.json"),Dn=bt("cask.json"),Di="https://formulae.brew.sh/api/formula.json",Fi="https://formulae.brew.sh/api/cask.json",Nr={url:Di,cachePath:Gt},Mi={url:Fi,cachePath:Dn};async function Vr(){try{let[e,t]=await Promise.all([Ce.stat(Gt),Ce.stat(Dn)]);return e.size>0&&t.size>0}catch{return!1}}async function Br(e,t){let r=Date.now(),a=await Li(e,t),n=Ui(a),s=Date.now()-r;return n&&L.log("Installed packages fetched",{formulaeCount:n.formulae.size,casksCount:n.casks.size,totalCount:n.formulae.size+n.casks.size,durationMs:s,fromCache:e}),n}async function Li(e,t){async function r(){return(await Se("info --json=v2 --installed",t?{signal:t}:void 0)).stdout}if(!e)return JSON.parse(await r());async function a(){let i=Date.now(),o=await r(),c=JSON.parse(o),u=Date.now()-i;try{await Ce.writeFile(et,o);let l=Buffer.byteLength(o,"utf8"),f=(l/1024).toFixed(2);Z.log("Updated installed cache",{path:et,formulaeCount:c.formulae.length,casksCount:c.casks.length,totalCount:c.formulae.length+c.casks.length,durationMs:u,responseSizeBytes:l,responseSizeKb:`${f} KB`,usingInternalApi:T.useInternalApi})}catch(l){Z.error("Failed to write installed cache",{path:et,formulaeCount:c.formulae.length,casksCount:c.casks.length,error:l})}return c}async function n(i){return(await Ce.stat(i)).mtimeMs}async function s(){let i=await n(et),o=await n(pe("var/homebrew/locks")),c=await n(pe("Caskroom")),u;try{u=await n(pe("var/homebrew/pinned"))}catch{u=0}let l=await n(pe("var/homebrew"));if(l<i&&c<i&&o<i&&u<i){let f=await Ce.readFile(et),g=JSON.parse(f.toString());return Z.log("Using cached installed data",{path:et,formulaeCount:g.formulae.length,casksCount:g.casks.length,totalCount:g.formulae.length+g.casks.length,cacheAgeMs:Date.now()-i}),g}else return Z.log("Cache invalidated, refreshing",{reason:"brew state changed",homebrewTime:l,caskroomTime:c,locksTime:o,pinnedTime:u,cacheTime:i}),await a()}try{return await s()}catch{return await a()}}function Ui(e){if(!e)return;let t=new Map;for(let a of e.formulae)t.set(a.name,a);let r=new Map;for(let a of e.casks)r.set(a.token,a);return{formulae:t,casks:r}}var En=!1,Ct=null;async function Ri(e,t){try{let r=await Ce.stat(t);if(r.size===0)return!0;let a=await fetch(e,{method:"HEAD"}),n=Date.parse(a.headers.get("last-modified")??"");return n>r.mtimeMs?(Z.log("Internal API cache outdated",{cachePath:t,cacheTime:r.mtimeMs,remoteTime:n}),!0):(Z.log("Internal API cache up to date",{cachePath:t,cacheAgeMs:Date.now()-r.mtimeMs}),!1)}catch{return!0}}async function jr(e){if(T.useInternalApi){En||(Or(),En=!0);try{let t="https://formulae.brew.sh/api/internal/formula."+Oi()+".jws.json";if(await Ri(t,Gt))if(Ct)L.log("Waiting for existing formulae cache update to complete"),await Ct;else{L.log("Updating formulae cache from internal API"),Ct=In(Gt,e);try{await Ct}finally{Ct=null}}return await Ye(Nr,e)}catch(t){return L.warn("Internal formulae API failed, falling back to public API",{error:t instanceof Error?t.message:String(t)}),await Ye(Nr,e)}}return await Ye(Nr,e)}async function Wr(e){return await Ye(Mi,e)}function Oi(){let e=process.arch==="arm64"?"arm64":"x86_64",t="sequoia";try{let r=(0,Tn.execSync)("sw_vers -productVersion",{encoding:"utf8",timeout:5e3,stdio:["pipe","pipe","pipe"]}).trim(),a=parseInt(r.split(".")[0],10);t={15:"sequoia",14:"sonoma",13:"ventura",12:"monterey",11:"big_sur"}[a]||"sequoia"}catch{}return`${e}_${t}`}async function Pt(e,t){let r=Date.now();L.log("Fetching formula info",{name:e});try{let a=await Se(`info --json=v2 ${e}`,t?{signal:t}:void 0),n=JSON.parse(a.stdout),s=Date.now()-r;if(n.formulae.length>0)return L.log("Formula info fetched",{name:e,durationMs:s}),n.formulae[0];L.warn("Formula not found",{name:e,durationMs:s});return}catch(a){L.error("Failed to fetch formula info",{name:e,error:a});return}}async function vt(e,t){let r=Date.now();L.log("Fetching cask info",{token:e});try{let a=await Se(`info --json=v2 ${e}`,t?{signal:t}:void 0),n=JSON.parse(a.stdout),s=Date.now()-r;if(n.casks.length>0)return L.log("Cask info fetched",{token:e,durationMs:s}),n.casks[0];L.warn("Cask not found",{token:e,durationMs:s});return}catch(a){L.error("Failed to fetch cask info",{token:e,error:a});return}}var At=require("path");function ie(e){return e.token!==void 0}function Ee(e){return ie(e)?e.token:e.name}function W(e){return ie(e)?e.name&&e.name[0]?e.name[0]:"Unknown":e.name}function Te(e,t=!1){return ie(e)?"--cask"+(t&&T.zapCask?" --zap":""):""}function le(e){return ie(e)?Ni(e):Vi(e)}function Ni(e){return e.installed?e.installed.length>0:!1}function Vi(e){return e.installed.length>0}function Jt(e){return ie(e)?Bi(e):ji(e)}function Bi(e){let t=pe((0,At.join)("Caskroom",e.token));return e.installed?(0,At.join)(t,e.installed):t}function ji(e){let t=pe((0,At.join)("Cellar",e.name)),r=e.installed[0];return r?(0,At.join)(t,r.version):t}function Zt(e){return ie(e)?Wi(e):zi(e)}function Wi(e){if(!e.installed)return"";let t=e.installed;return e.outdated&&(t+=" (O)"),t}function zi(e){let t=e.installed[0];if(!t)return"";let r=t.version,a="";return t.installed_as_dependency&&(a+="D"),e.pinned&&(a+="P"),e.outdated&&(a+="O"),a&&(r+=` (${a})`),r}function Yt(e,t,r){let a=e.toLowerCase().includes(r),n=t.toLowerCase().includes(r);return a&&!n?-1:n&&!a?1:e.localeCompare(t)}function tt(e){let t=Ee(e);return`${Ie()} install ${Te(e)} ${t}`.replace(/ +/g," ")}function rt(e){let t=Ee(e);return`${Ie()} uninstall ${Te(e,!0)} ${t}`.replace(/ +/g," ")}var zr;async function Hr(e,t,r,a){oe.log("Searching",{query:e,limit:t}),zr=e;let n,s;a?.({phase:"casks"});let i=await Wr(l=>{n=l,a?.({phase:"casks",casksProgress:l,formulaeProgress:s})});if(r?.aborted){let l=new Error("Aborted");throw l.name="AbortError",l}a?.({phase:"formulae",casksProgress:n,formulaeProgress:s});let o=await jr(l=>{s=l,a?.({phase:"formulae",casksProgress:n,formulaeProgress:l})});if(r?.aborted){let l=new Error("Aborted");throw l.name="AbortError",l}if(zr.length>0){let l=zr.toLowerCase();o=o?.filter(f=>f.name.toLowerCase().includes(l)||f.desc?.toLowerCase().includes(l)).sort((f,g)=>Yt(f.name,g.name,l)),i=i?.filter(f=>f.token.toLowerCase().includes(l)||f.name.some(g=>g.toLowerCase().includes(l))||f.desc?.toLowerCase().includes(l)).sort((f,g)=>Yt(f.token,g.token,l))}let c=o.length,u=i.length;return t&&(o=o.slice(0,t),i=i.slice(0,t)),o.totalLength=c,i.totalLength=u,oe.log("Search completed",{query:e,formulaeResults:o.length,casksResults:i.length,totalFormulae:c,totalCasks:u,truncated:o.length<c||i.length<u}),a?.({phase:"complete",formulaeProgress:s?{...s,totalItems:c}:void 0,casksProgress:n?{...n,totalItems:u}:void 0}),{formulae:o,casks:i}}async function Kr(e,t,r){let a=Ee(e),n=ie(e);re.log("Installing package with progress",{identifier:a,type:n?"cask":"formula"}),await $t(`install ${Te(e)} ${a}`,t,r),n?e.installed=e.version:e.installed=[{version:e.versions.stable,installed_as_dependency:!1,installed_on_request:!0}],re.log("Package installed successfully",{identifier:a})}async function qr(e,t){let r=Ee(e);re.log("Uninstalling package",{identifier:r,type:ie(e)?"cask":"formula",zap:T.zapCask}),await Se(`rm ${Te(e,!0)} ${r}`,t?{signal:t}:void 0),re.log("Package uninstalled successfully",{identifier:r})}async function Gr(e,t,r){let a=Ee(e);re.log("Upgrading package with progress",{identifier:a,type:ie(e)?"cask":"formula"}),await $t(`upgrade ${Te(e)} ${a}`,t,r),re.log("Package upgraded successfully",{identifier:a})}async function Jr(e){re.log("Pinning formula",{name:e.name}),await Se(`pin ${e.name}`),e.pinned=!0,re.log("Formula pinned successfully",{name:e.name})}async function Zr(e){re.log("Unpinning formula",{name:e.name}),await Se(`unpin ${e.name}`),e.pinned=!1,re.log("Formula unpinned successfully",{name:e.name})}function Mn(){let e=(0,Fn.useRef)(void 0),t=Ke(async()=>await Br(!0),[],{keepPreviousData:!0,onWillExecute:async()=>{e.current=await(0,at.showToast)({style:at.Toast.Style.Animated,title:"Loading Installed Packages\u2026"})},onData:()=>{e.current?.hide()},onError:async r=>{e.current?.hide(),L.error("Failed to fetch installed packages",{errorType:r.name,message:r.message,isLockError:ce(r)});let a=ce(r),n=_e(r);await(0,at.showToast)({style:at.Toast.Style.Failure,title:a?"Brew is Busy":"Failed to fetch installed packages",message:a?"Another brew process is running. Please wait and try again.":n,primaryAction:{title:"Retry",onAction:s=>{s.hide(),t.revalidate()}}})}});return t}var te=require("react"),Xt=require("@raycast/api");var Gi={started:!1,complete:!1,bytesDownloaded:0,totalBytes:0,percent:0,itemsProcessed:0,totalItems:0};function Ln(e){let{searchText:t,limit:r=200,installed:a}=e,n=(0,te.useRef)(!1),[s,i]=(0,te.useState)(null);(0,te.useEffect)(()=>{let b=new AbortController;return Vr().then(C=>{b.signal.aborted||(i(C),oe.log("Cache check complete",{cacheExists:C}))}).catch(C=>{C.name!=="AbortError"&&oe.error("Cache check failed",{error:C instanceof Error?C.message:String(C)})}),()=>{b.abort()}},[]);let[o,c]=(0,te.useState)({phase:"casks"}),u=(0,te.useRef)(0),l=100,f=(0,te.useRef)(null),{isLoading:g,data:k,mutate:$}=Ke(async b=>(oe.log("Starting search",{query:b,isInitialLoad:!n.current}),c({phase:"casks"}),u.current=0,await Hr(b,r,f.current?.signal,U=>{try{if(f.current?.signal.aborted)return;let F=Date.now(),Pe=U.phase==="complete",j=U.casksProgress?.complete===!0,G=U.formulaeProgress?.complete===!0;(Pe||j||G||F-u.current>=l)&&(u.current=F,c(U))}catch(F){oe.error("Progress callback error",{error:F instanceof Error?F.message:String(F)})}})),[t],{abortable:f,keepPreviousData:!0,onError:async b=>{if(b.name==="AbortError")return;oe.error("Search failed",{errorType:b.name,message:b.message,isLockError:ce(b)});let C=ce(b),U=_e(b);await(0,Xt.showToast)({style:Xt.Toast.Style.Failure,title:C?"Brew is Busy":"Search failed",message:C?"Another brew process is running. Please wait and try again.":U})}});(0,te.useEffect)(()=>{k&&!n.current&&(oe.log("Initial data loaded",{formulaeCount:k.formulae.length,casksCount:k.casks.length}),n.current=!0)},[k]);let m=(0,te.useMemo)(()=>{if(!k)return;let b=k.formulae.map(F=>({...F})),C=k.casks.map(F=>({...F}));b.totalLength=k.formulae.totalLength,C.totalLength=k.casks.totalLength;let U={formulae:b,casks:C};return Ji(U,a),U},[k,a]),w=!n.current&&!k,S=g||w,v=b=>b?{started:!0,complete:b.complete,bytesDownloaded:b.bytesDownloaded,totalBytes:b.totalBytes,percent:b.percent,itemsProcessed:b.itemsProcessed??0,totalItems:b.totalItems??0}:Gi,x=(0,te.useMemo)(()=>{let b=v(o.casksProgress),C=v(o.formulaeProgress);return b.started=!0,(o.phase==="formulae"||o.phase==="parsing"||o.phase==="complete")&&(C.started=!0),o.phase==="formulae"||o.phase==="parsing"||o.phase==="complete"?(b.complete=!0,b.percent=100):b.complete=!1,o.phase==="parsing"||o.phase==="complete"?(C.complete=!0,C.percent=100):o.phase==="formulae"&&(C.complete=!1),{isLoading:S,isInitialLoad:w,phase:o.phase,casksProgress:b,formulaeProgress:C}},[S,w,o]),p=s,y=(0,te.useMemo)(()=>{let b=o.casksProgress?.totalItems,C=o.formulaeProgress?.totalItems;if(b!==void 0&&C!==void 0&&b>0&&C>0)return{formulae:C,casks:b};if(k){let U=k.formulae.totalLength??k.formulae.length,F=k.casks.totalLength??k.casks.length;if(U>0||F>0)return{formulae:U,casks:F}}},[o.casksProgress?.totalItems,o.formulaeProgress?.totalItems,k]);return{isLoading:S,isInitialLoad:w,hasCacheFiles:p,loadingState:x,data:m,mutate:$,indexTotals:y}}function Ji(e,t){if(!(!e||!t)){for(let r of e.formulae){let a=t.formulae instanceof Map?t.formulae.get(r.name):void 0;a&&Yi(a)?(r.installed=a.installed,r.outdated=a.outdated,r.pinned=a.pinned):(r.installed=[],r.outdated=!1,r.pinned=!1)}for(let r of e.casks){let a=t.casks instanceof Map?t.casks.get(r.token):void 0;a&&Zi(a)?(r.installed=a.installed,r.outdated=a.outdated):(r.installed=void 0,r.outdated=!1)}}}function Zi(e){return e.token!=null}function Yi(e){return e.pinned!=null}function Un(e,t){return t?t.formulae instanceof Map&&t.formulae.get(e)!=null||t.casks instanceof Map&&t.casks.get(e)!=null:!1}var It=require("@raycast/api"),nt=require("react/jsx-runtime");function Rn(e){return(0,nt.jsxs)(It.List.Dropdown,{tooltip:"Filter by formula or cask",onChange:t=>{e.onSelect(t)},storeValue:!0,children:[(0,nt.jsx)(It.List.Dropdown.Item,{value:"all",title:"All"}),(0,nt.jsx)(It.List.Dropdown.Item,{value:"formulae",title:"Formulae"}),(0,nt.jsx)(It.List.Dropdown.Item,{value:"casks",title:"Casks"})]})}function On(e){return`Search ${e==="all"?"formulae or casks":e==="casks"?"casks":"formulae"} by name${String.ellipsis}`}var V=require("@raycast/api");var h=require("@raycast/api");var Et=require("@raycast/api");var De={alacritty:"Alacritty",ghostty:"Ghostty",hyper:"Hyper",iterm:"iTerm",kitty:"kitty",terminal:"Terminal",warp:"Warp",wezterm:"WezTerm"},Nn={alacritty:{fileIcon:"/Applications/Alacritty.app"},ghostty:{fileIcon:"/Applications/Ghostty.app"},hyper:{fileIcon:"/Applications/Hyper.app"},iterm:{fileIcon:"/Applications/iTerm.app"},kitty:{fileIcon:"/Applications/kitty.app"},terminal:{fileIcon:"/System/Applications/Utilities/Terminal.app"},warp:{fileIcon:"/Applications/Warp.app"},wezterm:{fileIcon:"/Applications/WezTerm.app"}},Xi={alacritty:"org.alacritty",ghostty:"com.mitchellh.ghostty",hyper:"co.zeit.hyper",iterm:"com.googlecode.iterm2",kitty:"org.kovidgoyal.kitty",terminal:"com.apple.terminal",warp:"dev.warp.Warp-Stable",wezterm:"com.github.wez.wezterm"},st=(e,t)=>`
    tell application "${t}" to activate
    tell application "System Events" to tell process "${t}"
        keystroke "t" using command down
        delay 0.5
        keystroke "${e}"
        keystroke return
    end tell
  `,Vn={alacritty:e=>st(e,De.alacritty),ghostty:e=>st(e,De.ghostty),hyper:e=>st(e,De.hyper),iterm:e=>`
    tell application "iTerm"
      set newWindow to create window with default profile command "bash -c '${e}; read -n 1 -s -r -p \\"Press any key to exit - will not quit\\" ; echo' ; exit"
    end tell
    `,kitty:e=>st(e,De.kitty),terminal:e=>`
    tell application "Terminal"
      do shell script "open -a 'Terminal'"
      do script "echo ; ${e} ; bash -c 'read -n 1 -s -r -p \\"Press any key to exit - will not quit\\"' ; exit" in selected tab of the front window
    end tell
  `,warp:e=>st(e,De.warp),wezterm:e=>st(e,De.wezterm)},Qt=()=>{let{data:e}=Ke(async t=>(await(0,Et.getApplications)()).some(a=>a.bundleId?.toLowerCase()===Xi[t].toLowerCase()),[T.terminalApp],{failureToastOptions:{title:"Failed to check if Terminal App is installed"}});return{terminalIcon:e?Nn[T.terminalApp]:Nn.terminal,terminalName:e?De[T.terminalApp]:De.terminal,runCommandInTerminal:async t=>{await(0,Et.closeMainWindow)(),await new Promise(a=>setTimeout(a,400));let r=e?Vn[T.terminalApp](t):Vn.terminal(t);await ka(r),await(0,Et.closeMainWindow)()}}};var M=require("@raycast/api");var Bn=()=>ur("exclude-dependencies",!1);var it=require("react/jsx-runtime");function Yr(e){return(0,it.jsx)(M.Action,{title:"Install",icon:M.Icon.Plus,shortcut:{modifiers:["cmd"],key:"i"},onAction:async()=>{e.onAction(await Qi(e.formula))}})}function Xr(e){return(0,it.jsx)(M.Action,{title:"Uninstall",icon:M.Icon.Trash,shortcut:M.Keyboard.Shortcut.Common.Remove,style:M.Action.Style.Destructive,onAction:async()=>{let t=await eo(e.formula);e.onAction(t)}})}function Qr(e){return(0,it.jsx)(M.Action,{title:"Upgrade",icon:M.Icon.Hammer,shortcut:{modifiers:["cmd","shift"],key:"u"},onAction:async()=>{let t=await to(e.formula);e.onAction(t)}})}function jn(e){let t=e.formula.pinned;return(0,it.jsx)(M.Action,{title:t?"Unpin":"Pin",icon:M.Icon.Pin,shortcut:M.Keyboard.Shortcut.Common.Pin,onAction:async()=>{t?e.onAction(await ao(e.formula)):e.onAction(await ro(e.formula))}})}function Wn(e){let[t,r]=Bn();return(0,it.jsx)(M.Action,{title:t?"Show Dependencies":"Hide Dependencies",icon:t?M.Icon.Eye:M.Icon.EyeDisabled,shortcut:{modifiers:["cmd"],key:"d"},onAction:()=>{let a=no(t,r);e.onAction(a)}})}async function Qi(e){let t=W(e),r=yt({title:`Installing ${t}`,message:"",cancelable:!0});try{return await Kr(e,a=>{r.updateMessage(a.message)},r.abort?.signal),await r.showSuccessHUD(`Installed ${t}`),!0}catch(a){let n=se(a);return await r.showFailureHUD(`Failed to install ${t}`),Ne("Install failed",n),!1}}async function eo(e){let t=W(e),r=yt({title:`Uninstalling ${t}`,message:"",cancelable:!0});try{return await qr(e,r.abort?.signal),await r.showSuccessHUD(`Uninstalled ${t}`),!0}catch(a){let n=se(a);return await r.showFailureHUD(`Failed to uninstall ${t}`),Ne("Uninstall failed",n),!1}}async function to(e){let t=W(e),r=yt({title:`Upgrading ${t}`,message:"",cancelable:!0});try{return await Gr(e,a=>{r.updateMessage(a.message)},r.abort?.signal),await r.showSuccessHUD(`Upgraded ${t}`),!0}catch(a){let n=se(a);return await r.showFailureHUD(`Failed to upgrade ${t}`),Ne("Upgrade failed",n),!1}}async function ro(e){(0,M.showToast)(M.Toast.Style.Animated,`Pinning ${W(e)}`);try{return await Jr(e),e.pinned=!0,(0,M.showToast)(M.Toast.Style.Success,`Pinned ${W(e)}`),!0}catch(t){return Ne("Pin formula failed",se(t)),!1}}async function ao(e){(0,M.showToast)(M.Toast.Style.Animated,`Unpinning ${W(e)}`);try{return await Zr(e),e.pinned=!1,(0,M.showToast)(M.Toast.Style.Success,`Unpinned ${W(e)}`),!0}catch(t){return Ne("Unpin formula failed",se(t)),!1}}function no(e,t){return t(!e),!0}var lt=require("react"),H=require("@raycast/api");var ot=require("@raycast/api"),ea=require("react/jsx-runtime");function ct({title:e,dependencies:t,isInstalled:r}){return!t||t.length===0?null:(0,ea.jsx)(ot.Detail.Metadata.TagList,{title:e,children:t.map(a=>(0,ea.jsx)(ot.Detail.Metadata.TagList.Item,{text:a,color:r(a)?ot.Color.Green:ot.Color.SecondaryText},a))})}var Q=require("react/jsx-runtime");function zn(e){return!e.homepage||!e.tap||!e.desc}function ta({cask:e,isInstalled:t,onAction:r}){let{pop:a}=(0,H.useNavigation)(),[n,s]=(0,lt.useState)(e),[i,o]=(0,lt.useState)(!1);return(0,lt.useEffect)(()=>{ne.log("Viewing cask info",{token:e.token,name:W(e),hasMinimalData:zn(e),installed:e.installed,version:e.version})},[e]),(0,lt.useEffect)(()=>{if(!zn(e))return;(async()=>{o(!0);let u=await(0,H.showToast)({style:H.Toast.Style.Animated,title:`Loading ${W(e)} info...`}),l=new AbortController,f=setTimeout(()=>l.abort(),1e4);try{let g=await vt(e.token,l.signal);clearTimeout(f),g?(e.installed&&(g.installed=e.installed),s(g),ne.log("Cask info loaded",{token:g.token,name:W(g),desc:g.desc?.substring(0,50)}),u.hide()):(u.style=H.Toast.Style.Failure,u.title="Failed to load cask info")}catch(g){clearTimeout(f);let k=se(g).name==="AbortError";ne.error("Failed to load cask info",{token:e.token,error:g,timeout:k}),u.style=H.Toast.Style.Failure,u.title=k?"Cask info load timed out":"Failed to load cask info"}finally{o(!1)}})()},[e]),(0,Q.jsx)(H.Detail,{isLoading:i,markdown:co(n),navigationTitle:`Cask Info: ${W(n)}`,metadata:(0,Q.jsxs)(H.Detail.Metadata,{children:[n.homepage?(0,Q.jsx)(H.Detail.Metadata.Link,{title:"Homepage",text:n.homepage,target:n.homepage}):(0,Q.jsx)(H.Detail.Metadata.Label,{title:"Homepage",text:"Loading..."}),(0,Q.jsx)(H.Detail.Metadata.Label,{title:"Tap",text:n.tap||"Loading..."}),(0,Q.jsx)(oo,{cask:n}),(0,Q.jsx)(io,{cask:n}),(0,Q.jsx)(ct,{title:"Conflicts With",dependencies:n.conflicts_with?.cask,isInstalled:t}),(0,Q.jsx)(H.Detail.Metadata.Label,{title:"Auto Updates",text:n.auto_updates?"Yes":"No"})]}),actions:(0,Q.jsx)(er,{cask:n,showDetails:!1,isInstalled:t,onAction:c=>{a(),r(c)}})})}function io({cask:e}){let t=e.depends_on?.macos;return t?(0,Q.jsx)(H.Detail.Metadata.TagList,{title:"macOS Version",children:Object.keys(t).map(r=>{let a=t[r];return a?(0,Q.jsx)(H.Detail.Metadata.TagList.Item,{text:`${r} ${a.join(", ")}`},r):null})}):null}function oo({cask:e}){let t=e.installed?`${e.installed} (installed)`:e.version;return t?(0,Q.jsx)(H.Detail.Metadata.Label,{title:"Version",text:t}):null}function co(e){return`
# ${W(e)}
${e.desc}

${lo(e)}
  `}function lo(e){return e.caveats?`#### Caveats
${e.caveats}
    `:""}var ut=require("react"),K=require("@raycast/api");var ee=require("react/jsx-runtime");function Hn(e){return!e.homepage||!e.tap||!e.desc}function ra(e){let{pop:t}=(0,K.useNavigation)(),[r,a]=(0,ut.useState)(e.formula),[n,s]=(0,ut.useState)(!1);return(0,ut.useEffect)(()=>{ne.log("Viewing formula info",{name:e.formula.name,hasMinimalData:Hn(e.formula),installed:e.formula.installed?.length>0,version:e.formula.versions.stable})},[e.formula]),(0,ut.useEffect)(()=>{if(!Hn(e.formula))return;(async()=>{s(!0);let o=await(0,K.showToast)({style:K.Toast.Style.Animated,title:`Loading ${e.formula.name} info...`}),c=new AbortController,u=setTimeout(()=>c.abort(),1e4);try{let l=await Pt(e.formula.name,c.signal);clearTimeout(u),l?(e.formula.installed?.length>0&&(l.installed=e.formula.installed),a(l),ne.log("Formula info loaded",{name:l.name,desc:l.desc?.substring(0,50),dependencies:l.dependencies?.length??0}),o.hide()):(o.style=K.Toast.Style.Failure,o.title="Failed to load formula info")}catch(l){clearTimeout(u);let f=se(l).name==="AbortError";ne.error("Failed to load formula info",{name:e.formula.name,error:l,timeout:f}),o.style=K.Toast.Style.Failure,o.title=f?"Formula info load timed out":"Failed to load formula info"}finally{s(!1)}})()},[e.formula]),(0,ee.jsx)(K.Detail,{isLoading:n,markdown:uo(r),metadata:(0,ee.jsxs)(K.Detail.Metadata,{children:[r.homepage?(0,ee.jsx)(K.Detail.Metadata.Link,{title:"Homepage",text:r.homepage,target:r.homepage}):(0,ee.jsx)(K.Detail.Metadata.Label,{title:"Homepage",text:"Loading..."}),r.license&&(0,ee.jsx)(K.Detail.Metadata.Label,{title:"License",text:r.license}),(0,ee.jsx)(K.Detail.Metadata.Label,{title:"Versions",text:fo(r)}),r.versions.head&&(0,ee.jsx)(K.Detail.Metadata.Label,{title:"",text:r.versions.head}),(0,ee.jsx)(ct,{title:"Dependencies",dependencies:r.dependencies,isInstalled:e.isInstalled}),(0,ee.jsx)(ct,{title:"Build Dependencies",dependencies:r.build_dependencies,isInstalled:e.isInstalled}),(0,ee.jsx)(ct,{title:"Conflicts With",dependencies:r.conflicts_with,isInstalled:e.isInstalled}),r.pinned&&(0,ee.jsx)(K.Detail.Metadata.Label,{title:"Pinned",text:"Yes"}),r.keg_only&&(0,ee.jsx)(K.Detail.Metadata.Label,{title:"Keg Only",text:"Yes"})]}),actions:(0,ee.jsx)(tr,{formula:r,showDetails:!1,isInstalled:e.isInstalled,onAction:i=>{t(),e.onAction(i)}})})}function uo(e){return`
# ${e.name}
${e.desc}

${ho(e)}
  `}function fo(e){let t=e.versions,r=[];return t.bottle&&r.push("bottled"),le(e)&&r.push("installed"),e.installed.first()?.installed_as_dependency&&r.push("dependency"),`${t.stable} ${r?`(${r.join(", ")})`:""}`}function ho(e){let t="";return e.keg_only&&(t+=`
${e.name} is keg-only, which means it is not symlinked into ${Qe}.
    `),e.caveats&&(t+=`
${e.caveats}
    `),t?`#### Caveats
${t}
    `:""}var d=require("react/jsx-runtime"),aa=e=>(0,d.jsx)(h.ActionPanel.Section,{children:(0,d.jsx)(h.Action.Push,{target:(0,d.jsx)(h.Detail,{navigationTitle:"Debug Info",markdown:"```json\n"+JSON.stringify(e.obj,null,2)+"\n```",actions:(0,d.jsx)(h.ActionPanel,{children:(0,d.jsx)(h.Action.CopyToClipboard,{title:"Copy JSON",content:JSON.stringify(e.obj,null,2)})})}),title:"Debug",icon:h.Icon.MagnifyingGlass})});function er(e){let{cask:t}=e,{terminalName:r,terminalIcon:a,runCommandInTerminal:n}=Qt();function s(){return(0,d.jsxs)(h.ActionPanel,{children:[(0,d.jsxs)(h.ActionPanel.Section,{children:[e.showDetails&&(0,d.jsx)(h.Action.Push,{title:"Show Details",icon:h.Icon.Document,target:(0,d.jsx)(ta,{cask:t,isInstalled:e.isInstalled,onAction:e.onAction})}),t.outdated&&(0,d.jsx)(Qr,{formula:t,onAction:e.onAction}),(0,d.jsx)(h.Action.ShowInFinder,{path:Jt(t)})]}),(0,d.jsxs)(h.ActionPanel.Section,{children:[(0,d.jsx)(h.Action.OpenInBrowser,{title:"Open Cask",url:`https://formulae.brew.sh/cask/${t.token}`}),(0,d.jsx)(h.Action.CopyToClipboard,{title:"Copy Cask URL",content:`https://formulae.brew.sh/cask/${t.token}`})]}),(0,d.jsxs)(h.ActionPanel.Section,{children:[(0,d.jsx)(h.Action.OpenInBrowser,{title:"Open Homepage",url:t.homepage}),(0,d.jsx)(h.Action.CopyToClipboard,{title:"Copy Homepage URL",content:t.homepage})]}),(0,d.jsxs)(h.ActionPanel.Section,{children:[(0,d.jsx)(Xr,{formula:t,onAction:e.onAction}),(0,d.jsx)(h.Action.CopyToClipboard,{title:"Copy Uninstall Command",content:rt(t),shortcut:{modifiers:["cmd","opt"],key:"c"}}),(0,d.jsx)(h.Action,{title:`Run Uninstall in ${r}`,icon:a,style:h.Action.Style.Destructive,onAction:()=>n(rt(t))})]}),(0,d.jsxs)(h.ActionPanel.Section,{children:[(0,d.jsx)(h.Action.CopyToClipboard,{title:"Copy Cask Name",content:t.token,shortcut:{modifiers:["cmd","shift"],key:"c"}}),(0,d.jsx)(h.Action.CopyToClipboard,{title:"Copy Tap Name",content:t.tap})]}),(0,d.jsx)(aa,{obj:t})]})}function i(){return(0,d.jsxs)(h.ActionPanel,{children:[(0,d.jsxs)(h.ActionPanel.Section,{children:[e.showDetails&&(0,d.jsx)(h.Action.Push,{title:"Show Details",icon:h.Icon.Document,target:(0,d.jsx)(ta,{cask:t,isInstalled:e.isInstalled,onAction:e.onAction})}),(0,d.jsx)(Yr,{formula:t,onAction:e.onAction})]}),(0,d.jsxs)(h.ActionPanel.Section,{children:[(0,d.jsx)(h.Action.CopyToClipboard,{title:"Copy Tap Name",content:t.tap}),(0,d.jsx)(h.Action.CopyToClipboard,{title:"Copy Cask Name",content:t.token,shortcut:{modifiers:["cmd","shift"],key:"c"}}),(0,d.jsx)(h.Action.CopyToClipboard,{title:"Copy Install Command",content:tt(t),shortcut:{modifiers:["cmd","opt"],key:"c"}}),(0,d.jsx)(h.Action,{title:`Run Install in ${r}`,icon:a,onAction:()=>n(tt(t))})]}),(0,d.jsxs)(h.ActionPanel.Section,{children:[(0,d.jsx)(h.Action.OpenInBrowser,{title:"Open Cask",url:`https://formulae.brew.sh/cask/${t.token}`}),(0,d.jsx)(h.Action.CopyToClipboard,{title:"Copy Cask URL",content:`https://formulae.brew.sh/cask/${t.token}`})]}),(0,d.jsxs)(h.ActionPanel.Section,{children:[(0,d.jsx)(h.Action.OpenInBrowser,{title:"Open Homepage",url:t.homepage}),(0,d.jsx)(h.Action.CopyToClipboard,{title:"Copy Homepage URL",content:t.homepage})]})]})}return le(e.cask)?s():i()}function tr(e){let{formula:t}=e,{terminalName:r,terminalIcon:a,runCommandInTerminal:n}=Qt();function s(){return(0,d.jsxs)(h.ActionPanel,{children:[(0,d.jsxs)(h.ActionPanel.Section,{children:[e.showDetails&&(0,d.jsx)(h.Action.Push,{title:"Show Details",icon:h.Icon.Document,target:(0,d.jsx)(ra,{formula:t,isInstalled:e.isInstalled,onAction:e.onAction})}),t.outdated&&(0,d.jsx)(Qr,{formula:t,onAction:e.onAction}),(0,d.jsx)(h.Action.ShowInFinder,{path:Jt(t)}),(0,d.jsx)(jn,{formula:t,onAction:e.onAction}),(0,d.jsx)(Wn,{onAction:e.onAction})]}),(0,d.jsxs)(h.ActionPanel.Section,{children:[(0,d.jsx)(h.Action.OpenInBrowser,{title:"Open Formula",url:`https://formulae.brew.sh/formula/${t.name}`}),(0,d.jsx)(h.Action.CopyToClipboard,{title:"Copy Formula URL",content:`https://formulae.brew.sh/formula/${t.name}`})]}),(0,d.jsxs)(h.ActionPanel.Section,{children:[(0,d.jsx)(h.Action.OpenInBrowser,{title:"Open Homepage",url:t.homepage}),(0,d.jsx)(h.Action.CopyToClipboard,{title:"Copy Homepage URL",content:t.homepage})]}),(0,d.jsxs)(h.ActionPanel.Section,{children:[(0,d.jsx)(Xr,{formula:t,onAction:e.onAction}),(0,d.jsx)(h.Action.CopyToClipboard,{title:"Copy Uninstall Command",content:rt(t),shortcut:{modifiers:["cmd","opt"],key:"c"}}),(0,d.jsx)(h.Action,{title:`Run Uninstall in ${r}`,style:h.Action.Style.Destructive,icon:a,onAction:()=>n(rt(t))})]}),(0,d.jsx)(aa,{obj:t})]})}function i(){return(0,d.jsxs)(h.ActionPanel,{children:[(0,d.jsxs)(h.ActionPanel.Section,{children:[e.showDetails&&(0,d.jsx)(h.Action.Push,{title:"Show Details",icon:h.Icon.Document,target:(0,d.jsx)(ra,{formula:t,isInstalled:e.isInstalled,onAction:e.onAction})}),(0,d.jsx)(Yr,{formula:t,onAction:e.onAction})]}),(0,d.jsxs)(h.ActionPanel.Section,{children:[(0,d.jsx)(h.Action.CopyToClipboard,{title:"Copy Formula Name",content:t.name,shortcut:{modifiers:["cmd","shift"],key:"c"}}),(0,d.jsx)(h.Action.CopyToClipboard,{title:"Copy Install Command",content:tt(t),shortcut:{modifiers:["cmd","opt"],key:"c"}}),(0,d.jsx)(h.Action,{title:`Run Install in ${r}`,icon:a,onAction:()=>n(tt(t))})]}),(0,d.jsxs)(h.ActionPanel.Section,{children:[(0,d.jsx)(h.Action.OpenInBrowser,{title:"Open Formula",url:`https://formulae.brew.sh/formula/${t.name}`}),(0,d.jsx)(h.Action.CopyToClipboard,{title:"Copy Formula URL",content:`https://formulae.brew.sh/formula/${t.name}`})]}),(0,d.jsxs)(h.ActionPanel.Section,{children:[(0,d.jsx)(h.Action.OpenInBrowser,{title:"Open Homepage",url:t.homepage}),(0,d.jsx)(h.Action.CopyToClipboard,{title:"Copy Homepage URL",content:t.homepage})]}),(0,d.jsx)(aa,{obj:t})]})}return le(e.formula)?s():i()}var ye=require("react"),A=require("@raycast/api");var _=require("react/jsx-runtime");function mo(e){return!e.homepage||!e.tap||!e.desc}function po(e){return!e.homepage||!e.tap||!e.desc}function Kn({formula:e,isInstalled:t}){let[r,a]=(0,ye.useState)(e),[n,s]=(0,ye.useState)(!1);return(0,ye.useEffect)(()=>{a(e)},[e]),(0,ye.useEffect)(()=>{if(!mo(e))return;let i=!1,o=new AbortController,c=async()=>{s(!0);try{let l=await Pt(e.name,o.signal);!i&&l&&(e.installed?.length>0&&(l.installed=e.installed),a(l))}catch{}finally{i||s(!1)}},u=setTimeout(()=>o.abort(),1e4);return c(),()=>{i=!0,clearTimeout(u),o.abort()}},[e]),(0,_.jsx)(A.List.Item.Detail,{isLoading:n,markdown:yo(r),metadata:(0,_.jsxs)(A.List.Item.Detail.Metadata,{children:[r.homepage?(0,_.jsx)(A.List.Item.Detail.Metadata.Link,{title:"Homepage",text:r.homepage,target:r.homepage}):(0,_.jsx)(A.List.Item.Detail.Metadata.Label,{title:"Homepage",text:"\u2014"}),(0,_.jsx)(A.List.Item.Detail.Metadata.Separator,{}),r.license&&(0,_.jsxs)(_.Fragment,{children:[(0,_.jsx)(A.List.Item.Detail.Metadata.Label,{title:"License",text:r.license}),(0,_.jsx)(A.List.Item.Detail.Metadata.Separator,{})]}),(0,_.jsx)(A.List.Item.Detail.Metadata.Label,{title:"Version",text:ko(r)}),r.versions.head&&(0,_.jsxs)(_.Fragment,{children:[(0,_.jsx)(A.List.Item.Detail.Metadata.Separator,{}),(0,_.jsx)(A.List.Item.Detail.Metadata.Label,{title:"Head",text:r.versions.head})]}),(0,_.jsx)(rr,{title:"Dependencies",dependencies:r.dependencies,isInstalled:t}),(0,_.jsx)(rr,{title:"Build Dependencies",dependencies:r.build_dependencies,isInstalled:t}),(0,_.jsx)(rr,{title:"Conflicts With",dependencies:r.conflicts_with,isInstalled:t}),r.pinned&&(0,_.jsxs)(_.Fragment,{children:[(0,_.jsx)(A.List.Item.Detail.Metadata.Separator,{}),(0,_.jsx)(A.List.Item.Detail.Metadata.Label,{title:"Pinned",text:"Yes"})]}),r.keg_only&&(0,_.jsxs)(_.Fragment,{children:[(0,_.jsx)(A.List.Item.Detail.Metadata.Separator,{}),(0,_.jsx)(A.List.Item.Detail.Metadata.Label,{title:"Keg Only",text:"Yes"})]})]})})}function qn({cask:e,isInstalled:t}){let[r,a]=(0,ye.useState)(e),[n,s]=(0,ye.useState)(!1);return(0,ye.useEffect)(()=>{a(e)},[e]),(0,ye.useEffect)(()=>{if(!po(e))return;let i=!1,o=new AbortController,c=async()=>{s(!0);try{let l=await vt(e.token,o.signal);!i&&l&&(e.installed&&(l.installed=e.installed),a(l))}catch{}finally{i||s(!1)}},u=setTimeout(()=>o.abort(),1e4);return c(),()=>{i=!0,clearTimeout(u),o.abort()}},[e]),(0,_.jsx)(A.List.Item.Detail,{isLoading:n,markdown:wo(r),metadata:(0,_.jsxs)(A.List.Item.Detail.Metadata,{children:[r.homepage?(0,_.jsx)(A.List.Item.Detail.Metadata.Link,{title:"Homepage",text:r.homepage,target:r.homepage}):(0,_.jsx)(A.List.Item.Detail.Metadata.Label,{title:"Homepage",text:"\u2014"}),(0,_.jsx)(A.List.Item.Detail.Metadata.Separator,{}),(0,_.jsx)(A.List.Item.Detail.Metadata.Label,{title:"Tap",text:r.tap||"\u2014"}),(0,_.jsx)(A.List.Item.Detail.Metadata.Separator,{}),(0,_.jsx)(bo,{cask:r}),(0,_.jsx)(go,{cask:r}),(0,_.jsx)(rr,{title:"Conflicts With",dependencies:r.conflicts_with?.cask,isInstalled:t}),(0,_.jsx)(A.List.Item.Detail.Metadata.Separator,{}),(0,_.jsx)(A.List.Item.Detail.Metadata.Label,{title:"Auto Updates",text:r.auto_updates?"Yes":"No"})]})})}function rr({title:e,dependencies:t,isInstalled:r}){return!t||t.length===0?null:(0,_.jsxs)(_.Fragment,{children:[(0,_.jsx)(A.List.Item.Detail.Metadata.Separator,{}),(0,_.jsx)(A.List.Item.Detail.Metadata.TagList,{title:e,children:t.map(a=>(0,_.jsx)(A.List.Item.Detail.Metadata.TagList.Item,{text:a,color:r(a)?A.Color.Green:A.Color.SecondaryText},a))})]})}function go({cask:e}){let t=e.depends_on?.macos;return t?(0,_.jsxs)(_.Fragment,{children:[(0,_.jsx)(A.List.Item.Detail.Metadata.Separator,{}),(0,_.jsx)(A.List.Item.Detail.Metadata.TagList,{title:"macOS Version",children:Object.keys(t).map(r=>{let a=t[r];return a?(0,_.jsx)(A.List.Item.Detail.Metadata.TagList.Item,{text:`${r} ${a.join(", ")}`},r):null})})]}):null}function bo({cask:e}){let t=e.installed?`${e.installed} (installed)`:e.version;return t?(0,_.jsx)(A.List.Item.Detail.Metadata.Label,{title:"Version",text:t}):null}function yo(e){return`# ${e.name}
${e.desc||""}

${xo(e)}`}function wo(e){return`# ${W(e)}
${e.desc||""}

${_o(e)}`}function ko(e){let t=e.versions,r=[];return t.bottle&&r.push("bottled"),le(e)&&r.push("installed"),e.installed.first()?.installed_as_dependency&&r.push("dependency"),`${t.stable} ${r.length>0?`(${r.join(", ")})`:""}`}function xo(e){let t="";return e.keg_only&&(t+=`${e.name} is keg-only, which means it is not symlinked into ${Qe}.
`),e.caveats&&(t+=`${e.caveats}
`),t?`#### Caveats
${t}`:""}function _o(e){return e.caveats?`#### Caveats
${e.caveats}`:""}var q=require("react/jsx-runtime"),Jn={light:"#00000066",dark:"#FFFFFF66"};function Zn(e){let t=e.formulae,r=e.casks,a=t.length>0||r.length>0,n=e.showMetadataPanel??!1;return(0,q.jsxs)(V.List,{searchBarPlaceholder:e.searchBarPlaceholder,searchBarAccessory:e.searchBarAccessory,onSearchTextChange:e.onSearchTextChange,isLoading:e.isLoading,filtering:e.filtering??!0,isShowingDetail:n,throttle:!0,children:[!a&&(e.isLoading||!e.dataFetched)&&(0,q.jsx)(V.List.EmptyView,{icon:dt(.5),title:"Loading Packages",description:"Fetching casks and formulae from Homebrew..."}),!a&&!e.isLoading&&e.dataFetched&&(0,q.jsx)(V.List.EmptyView,{icon:V.Icon.MagnifyingGlass,title:"No Results",description:"No packages found"}),t.length>0&&(0,q.jsxs)(V.List.Section,{title:"Formulae",children:[t.map(s=>(0,q.jsx)($o,{formula:s,isInstalled:e.isInstalled,onAction:e.onAction,showMetadataPanel:n},`formula-${s.name}`)),t.isTruncated()&&(0,q.jsx)(Gn,{})]}),r.length>0&&(0,q.jsxs)(V.List.Section,{title:"Casks",children:[r.map(s=>(0,q.jsx)(So,{cask:s,isInstalled:e.isInstalled,onAction:e.onAction,showMetadataPanel:n},`cask-${s.token}`)),r.isTruncated()&&(0,q.jsx)(Gn,{})]})]})}function $o(e){let t=e.formula,r=e.showMetadataPanel??!1,a=t.versions.stable,n=Jn,s,i=V.Icon.Circle;le(t)&&(a=Zt(t),n=t.outdated?V.Color.Red:V.Color.Green,i=V.Icon.CheckCircle,s=t.outdated?"Outdated":"Up to date");let o={source:i,tintColor:n};return(0,q.jsx)(V.List.Item,{title:t.name,subtitle:r?void 0:t.desc,accessories:r?void 0:[{text:a}],icon:s?{value:o,tooltip:s}:o,detail:r?(0,q.jsx)(Kn,{formula:t,isInstalled:e.isInstalled}):void 0,actions:(0,q.jsx)(tr,{formula:t,showDetails:!r,isInstalled:e.isInstalled,onAction:e.onAction})})}function So(e){let t=e.cask,r=e.showMetadataPanel??!1,a=t.version,n=Jn,s,i=V.Icon.Circle;le(t)&&(a=Zt(t),n=t.outdated?V.Color.Red:V.Color.Green,i=V.Icon.CheckCircle,s=t.outdated?"Outdated":"Up to date");let o={source:i,tintColor:n};return(0,q.jsx)(V.List.Item,{title:W(t),subtitle:r?void 0:t.desc,accessories:r?void 0:[{text:a}],icon:s?{value:o,tooltip:s}:o,detail:r?(0,q.jsx)(qn,{cask:t,isInstalled:e.isInstalled}):void 0,actions:(0,q.jsx)(er,{cask:t,showDetails:!r,isInstalled:e.isInstalled,onAction:e.onAction})})}function Gn(){return(0,q.jsx)(V.List.Item,{title:"",icon:V.Icon.Dot})}var we=require("react/jsx-runtime");function es(e){if(e===0)return"0 B";let t=1024,r=["B","KB","MB","GB"],a=Math.floor(Math.log(e)/Math.log(t));return`${(e/Math.pow(t,a)).toFixed(1)} ${r[a]}`}function ft(e){return e.toLocaleString()}function Yn(e,t){if(e.complete)return"";if(t&&e.itemsProcessed>0)return`${ft(e.itemsProcessed)} processed`;if(t)return"Processing...";if(!e.started)return"";if(e.bytesDownloaded>0){let r=es(e.bytesDownloaded),a=e.percent>0?Math.min(e.percent,100):0;return a>0?`${a}% downloaded (${r})`:`${r} downloaded`}return"Starting..."}function Xn(e,t,r){return e.complete&&e.totalItems>0?`${ft(e.totalItems)} ${r}`:e.complete?"Done":t&&e.itemsProcessed>0&&e.totalItems>0?`${ft(e.itemsProcessed)} of ${ft(e.totalItems)} ${r}`:t?"Processing...":e.started?e.totalBytes>0?`${es(e.totalBytes)} Total`:"Downloading...":"Waiting"}function Qn(e,t=!1){if(e.complete)return{source:R.Icon.CheckCircle,tintColor:R.Color.Green};if(t)return dt(.9,R.Color.PrimaryText);if(!e.started)return{source:R.Icon.Circle,tintColor:R.Color.SecondaryText};let r=e.percent>0?Math.min(e.percent,100):0,a=r>0?r/100:.05;return dt(a,R.Color.PrimaryText)}function ts(){let[e,t]=(0,We.useState)(""),[r,a]=(0,We.useState)("all"),{showMetadataPanel:n}=(0,R.getPreferenceValues)(),s=n&&!T.useInternalApi,{isLoading:i,data:o,revalidate:c}=Mn(),{isLoading:u,hasCacheFiles:l,loadingState:f,data:g,indexTotals:k}=Ln({searchText:e,installed:o}),$=r!="casks"?g?.formulae??[]:[],m=r!="formulae"?g?.casks??[]:[],w=(0,We.useRef)(!1),S=f.phase;if((0,We.useEffect)(()=>{if(S==="complete"&&!w.current&&g){w.current=!0;let x=k?.formulae||0,p=k?.casks||0;(0,R.showToast)({style:R.Toast.Style.Success,title:"Package Index Ready",message:`${ft(x)} formulae and ${ft(p)} casks loaded`})}},[S,g]),f.isInitialLoad&&l===null)return(0,we.jsx)(R.List,{navigationTitle:"Search",searchBarPlaceholder:"Checking cache...",isLoading:!0,children:(0,we.jsx)(R.List.EmptyView,{icon:R.Icon.MagnifyingGlass,title:"Loading..."})});if(l===!1&&S!=="complete"){let{phase:x,casksProgress:p,formulaeProgress:y}=f,b=p.percent>=100||p.bytesDownloaded>0&&p.totalBytes>0&&p.bytesDownloaded>=p.totalBytes,C=y.percent>=100||y.bytesDownloaded>0&&y.totalBytes>0&&y.bytesDownloaded>=y.totalBytes,U=x==="casks"&&b&&!p.complete,F=x==="formulae"&&C&&!y.complete,Pe=x==="casks",j="Loading package index...";U?j="Processing casks...":F?j="Processing formulae...":x==="casks"&&p.percent>0?j=`Downloading casks... ${Math.min(p.percent,100)}%`:x==="formulae"&&y.percent>0?j=`Downloading formulae... ${Math.min(y.percent,100)}%`:x==="casks"?j="Downloading casks...":x==="formulae"?j="Downloading formulae...":x==="parsing"&&(j="Processing package data...");let G=Yn(p,U),ke=Pe?"":Yn(y,F),ue="Download Formulae";F?ue="Processing Formulae":!Pe&&y.started&&(ue="Downloading Formulae");let I="Waiting";Pe?I=U?"Waiting on Casks processing...":"Waiting on Casks to finish...":I=Xn(y,F,"formulae");let xe=Pe?{source:R.Icon.Circle,tintColor:R.Color.SecondaryText}:Qn(y,F);return(0,we.jsx)(R.List,{navigationTitle:"First-time setup",searchBarPlaceholder:j,isLoading:!0,children:(0,we.jsxs)(R.List.Section,{title:"Initializing...",children:[(0,we.jsx)(R.List.Item,{icon:Qn(p,U),title:U?"Processing Casks":"Downloading Casks",subtitle:G,accessories:[{text:Xn(p,U,"casks")}]}),(0,we.jsx)(R.List.Item,{icon:xe,title:ue,subtitle:ke,accessories:[{text:I}]})]})})}return(0,we.jsx)(Zn,{formulae:$,casks:m,searchBarPlaceholder:On(r),searchBarAccessory:(0,we.jsx)(Rn,{onSelect:a}),isLoading:i||u,onSearchTextChange:x=>t(x.trim()),filtering:!1,isInstalled:x=>Un(x,o),onAction:()=>c(),dataFetched:f.phase==="complete",showMetadataPanel:s})}
