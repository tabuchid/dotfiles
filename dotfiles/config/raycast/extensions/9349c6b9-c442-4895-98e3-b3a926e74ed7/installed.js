"use strict";var ln=Object.create;var dt=Object.defineProperty;var un=Object.getOwnPropertyDescriptor;var fn=Object.getOwnPropertyNames;var dn=Object.getPrototypeOf,hn=Object.prototype.hasOwnProperty;var V=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports),mn=(t,e)=>{for(var r in e)dt(t,r,{get:e[r],enumerable:!0})},vr=(t,e,r,a)=>{if(e&&typeof e=="object"||typeof e=="function")for(let n of fn(e))!hn.call(t,n)&&n!==r&&dt(t,n,{get:()=>e[n],enumerable:!(a=un(e,n))||a.enumerable});return t};var I=(t,e,r)=>(r=t!=null?ln(dn(t)):{},vr(e||!t||!t.__esModule?dt(r,"default",{value:t,enumerable:!0}):r,t)),pn=t=>vr(dt({},"__esModule",{value:!0}),t);var Rt=V(ht=>{"use strict";Object.defineProperty(ht,"__esModule",{value:!0});ht.redactString=Lt;ht.sanitizeArgs=gn;function Ar(t){return t.replace(/([A-Za-z0-9._%+-])[^@\s]*(@[A-Za-z0-9.-]+\.[A-Za-z]{2,})/g,(e,r,a)=>`${r}***${a}`)}function Lt(t){let e=t;return e=e.replace(/bearer\s+[^\s"']+/gi,"Bearer ***"),e=e.replace(/(password|pass|pwd|secret|token|auth|authorization|key)\s*[:=]\s*[^\s&"']+/gi,"$1=***"),e=e.replace(/((?:code|2fa|two[-\s]?factor|otp)\s*[:=\s]+)(\d{4,8})/gi,(r,a)=>`${a}******`),e=e.replace(/[a-f0-9]{32,}/gi,"***"),e=e.replace(/[A-Za-z0-9+/]{20,}={0,2}/g,"***"),e=Ar(e),e}function Er(t,e){let r=t.toLowerCase();if(e==null)return e;if(typeof e=="string")return["password","pass","pwd","secret","token","auth","authorization","applepassword"].includes(r)?"***":["code","otp","2fa","twofactor","two_factor"].includes(r)?"******":["email","appleid","apple_id","username","user"].includes(r)?Ar(e):Lt(e);if(typeof e=="number")return["code","otp","2fa"].includes(r)?0:e;if(typeof e=="object")try{let a=JSON.stringify(e,(n,s)=>Er(n,s));return JSON.parse(a)}catch{return e}return e}function gn(t){return t.map(e=>{if(typeof e=="string")return Lt(e);if(typeof e=="object"&&e!==null)try{let r=JSON.stringify(e,(a,n)=>Er(a,n));return JSON.parse(r)}catch{return e}return e})}});var Tr=V(Te=>{"use strict";Object.defineProperty(Te,"__esModule",{value:!0});Te.logger=Te.Logger=void 0;var bn=require("@raycast/api"),Ir=Rt(),mt=class t{constructor(e={}){this.config={isVerboseEnabled:e.isVerboseEnabled||this.defaultVerboseCheck,prefix:e.prefix||"",enableRedaction:e.enableRedaction??!0}}defaultVerboseCheck(){try{return(0,bn.getPreferenceValues)().verboseLogging||!1}catch(e){return console.error("[Logger] Failed to read preferences for verbose logging:",e),!1}}static getInstance(){return t.instance||(t.instance=new t),t.instance}formatMessage(e){return this.config.prefix?`${this.config.prefix} ${e}`:e}processLogData(e,r){let a=this.formatMessage(e);return this.config.enableRedaction?[(0,Ir.redactString)(a),(0,Ir.sanitizeArgs)(r)]:[a,r]}log(e,...r){if(this.config.isVerboseEnabled()){let[a,n]=this.processLogData(e,r);console.log(a,...n)}}error(e,...r){let[a,n]=this.processLogData(e,r);console.error(a,...n)}warn(e,...r){let[a,n]=this.processLogData(e,r);console.warn(a,...n)}child(e){let r=this.config.prefix?`${this.config.prefix} ${e}`:e;return new t({...this.config,prefix:r})}};Te.Logger=mt;Te.logger=mt.getInstance()});var Ut=V(ee=>{"use strict";Object.defineProperty(ee,"__esModule",{value:!0});ee.sanitizeArgs=ee.redactString=ee.logger=ee.Logger=void 0;var Dr=Tr();Object.defineProperty(ee,"Logger",{enumerable:!0,get:function(){return Dr.Logger}});Object.defineProperty(ee,"logger",{enumerable:!0,get:function(){return Dr.logger}});var Fr=Rt();Object.defineProperty(ee,"redactString",{enumerable:!0,get:function(){return Fr.redactString}});Object.defineProperty(ee,"sanitizeArgs",{enumerable:!0,get:function(){return Fr.sanitizeArgs}})});var kt=V((Ri,Vr)=>{"use strict";var{Readable:Mi,Writable:Li,Duplex:kn,Transform:Nr}=require("stream"),_n=Symbol.for("object-stream.none"),jt=Symbol.for("object-stream.final"),Wt=Symbol.for("object-stream.many"),xn=t=>({[jt]:t}),$n=t=>({[Wt]:t}),Sn=t=>t&&typeof t=="object"&&jt in t,Cn=t=>t&&typeof t=="object"&&Wt in t,vn=t=>t[jt],Pn=t=>t[Wt],An=async(t,e)=>{for(;;){let r=t.next();if(r&&typeof r.then=="function"&&(r=await r),r.done)break;let a=r.value;a&&typeof a.then=="function"&&(a=await a),P.sanitize(a,e)}},En=t=>new Nr({writableObjectMode:!0,readableObjectMode:!0,transform(e,r,a){try{let n=t.call(this,e,r);if(n&&typeof n.then=="function"){n.then(s=>(P.sanitize(s,this),a(null)),s=>a(s));return}if(n&&typeof n.next=="function"){An(n,this).then(()=>a(null),s=>a(s));return}P.sanitize(n,this),a(null)}catch(n){a(n)}}}),In=t=>new Nr({writableObjectMode:!0,readableObjectMode:!0,transform(e,r,a){try{let n=e;for(let s=0;s<t.length;++s){let i=t[s].call(this,n,r);if(i===P.none){a(null);return}if(P.isFinal(i)){n=P.getFinalValue(i);break}n=i}P.sanitize(n,this),a(null)}catch(n){a(n)}}}),Ur=t=>t&&typeof t.pipe=="function"&&typeof t.on=="function"&&(!t._writableState||(typeof t._readableState=="object"?t._readableState.readable:null)!==!1)&&(!t._writableState||t._readableState),Or=t=>t&&typeof t.write=="function"&&typeof t.on=="function"&&(!t._readableState||(typeof t._writableState=="object"?t._writableState.writable:null)!==!1),Tn=t=>t&&typeof t.pipe=="function"&&t._readableState&&typeof t.on=="function"&&typeof t.write=="function",P=class t extends kn{constructor(e,r){if(super(r||{writableObjectMode:!0,readableObjectMode:!0}),!(e instanceof Array)||!e.length)throw Error("Chain's argument should be a non-empty array.");this.streams=e.filter(a=>a).map((a,n,s)=>{if(typeof a=="function"||a instanceof Array)return t.convertToTransform(a);if(Tn(a)||!n&&Ur(a)||n===s.length-1&&Or(a))return a;throw Error("Arguments should be functions, arrays or streams.")}).filter(a=>a),this.input=this.streams[0],this.output=this.streams.reduce((a,n)=>a&&a.pipe(n)||n),Or(this.input)||(this._write=(a,n,s)=>s(null),this._final=a=>a(null),this.input.on("end",()=>this.end())),Ur(this.output)?(this.output.on("data",a=>!this.push(a)&&this.output.pause()),this.output.on("end",()=>this.push(null))):(this._read=()=>{},this.resume(),this.output.on("finish",()=>this.push(null))),(!r||!r.skipEvents)&&this.streams.forEach(a=>a.on("error",n=>this.emit("error",n)))}_write(e,r,a){let n=null;try{this.input.write(e,r,s=>a(s||n))}catch(s){n=s}}_final(e){let r=null;try{this.input.end(null,null,a=>e(a||r))}catch(a){r=a}}_read(){this.output.resume()}static make(e,r){return new t(e,r)}static sanitize(e,r){t.isFinal(e)?e=t.getFinalValue(e):t.isMany(e)&&(e=t.getManyValues(e)),e!=null&&e!==t.none&&(e instanceof Array?e.forEach(a=>a!=null&&r.push(a)):r.push(e))}static convertToTransform(e){return typeof e=="function"?En(e):e instanceof Array&&e.length?In(e):null}};P.none=_n;P.final=xn;P.isFinal=Sn;P.getFinalValue=vn;P.many=$n;P.isMany=Cn;P.getManyValues=Pn;P.chain=P.make;P.make.Constructor=P;Vr.exports=P});var jr=V((Ui,Br)=>{"use strict";var{Transform:Dn}=require("stream"),{StringDecoder:Fn}=require("string_decoder"),zt=class extends Dn{constructor(e){super(Object.assign({},e,{writableObjectMode:!1})),this._buffer=""}_transform(e,r,a){typeof e=="string"?this._transform=this._transformString:(this._stringDecoder=new Fn,this._transform=this._transformBuffer),this._transform(e,r,a)}_transformBuffer(e,r,a){this._buffer+=this._stringDecoder.write(e),this._processBuffer(a)}_transformString(e,r,a){this._buffer+=e.toString(),this._processBuffer(a)}_processBuffer(e){this._buffer&&(this.push(this._buffer,"utf8"),this._buffer=""),e(null)}_flushInput(){this._stringDecoder&&(this._buffer+=this._stringDecoder.end())}_flush(e){this._flushInput(),this._processBuffer(e)}};Br.exports=zt});var Ht=V((Oi,Wr)=>{"use strict";var Mn=jr(),p={value1:/^(?:[\"\{\[\]\-\d]|true\b|false\b|null\b|\s{1,256})/,string:/^(?:[^\x00-\x1f\"\\]{1,256}|\\[bfnrt\"\\\/]|\\u[\da-fA-F]{4}|\")/,key1:/^(?:[\"\}]|\s{1,256})/,colon:/^(?:\:|\s{1,256})/,comma:/^(?:[\,\]\}]|\s{1,256})/,ws:/^\s{1,256}/,numberStart:/^\d/,numberDigit:/^\d{0,256}/,numberFraction:/^[\.eE]/,numberExponent:/^[eE]/,numberExpSign:/^[-+]/},Ln=16,F=!0;try{new RegExp(".","y"),F=!1}catch{}!F&&Object.keys(p).forEach(t=>{let e=p[t].source.slice(1);e.slice(0,3)==="(?:"&&e.slice(-1)===")"&&(e=e.slice(3,-1)),p[t]=new RegExp(e,"y")});p.numberFracStart=p.numberExpStart=p.numberStart;p.numberFracDigit=p.numberExpDigit=p.numberDigit;var Rn={true:!0,false:!1,null:null},re={object:"objectStop",array:"arrayStop","":"done"},Un=t=>String.fromCharCode(parseInt(t.slice(2),16)),On={b:"\b",f:"\f",n:`
`,r:"\r",t:"	",'"':'"',"\\":"\\","/":"/"},xe=class t extends Mn{static make(e){return new t(e)}constructor(e){super(Object.assign({},e,{readableObjectMode:!0})),this._packKeys=this._packStrings=this._packNumbers=this._streamKeys=this._streamStrings=this._streamNumbers=!0,e&&("packValues"in e&&(this._packKeys=this._packStrings=this._packNumbers=e.packValues),"packKeys"in e&&(this._packKeys=e.packKeys),"packStrings"in e&&(this._packStrings=e.packStrings),"packNumbers"in e&&(this._packNumbers=e.packNumbers),"streamValues"in e&&(this._streamKeys=this._streamStrings=this._streamNumbers=e.streamValues),"streamKeys"in e&&(this._streamKeys=e.streamKeys),"streamStrings"in e&&(this._streamStrings=e.streamStrings),"streamNumbers"in e&&(this._streamNumbers=e.streamNumbers),this._jsonStreaming=e.jsonStreaming),!this._packKeys&&(this._streamKeys=!0),!this._packStrings&&(this._streamStrings=!0),!this._packNumbers&&(this._streamNumbers=!0),this._done=!1,this._expect=this._jsonStreaming?"done":"value",this._stack=[],this._parent="",this._open_number=!1,this._accumulator=""}_flush(e){this._done=!0,super._flush(r=>{if(r)return e(r);this._open_number&&(this._streamNumbers&&this.push({name:"endNumber"}),this._open_number=!1,this._packNumbers&&(this.push({name:"numberValue",value:this._accumulator}),this._accumulator="")),e(null)})}_processBuffer(e){let r,a,n=0;e:for(;;)switch(this._expect){case"value1":case"value":if(p.value1.lastIndex=n,r=p.value1.exec(this._buffer),!r){if(this._done||n+Ln<this._buffer.length)return n<this._buffer.length?e(new Error("Parser cannot parse input: expected a value")):e(new Error("Parser has expected a value"));break e}switch(a=r[0],a){case'"':this._streamStrings&&this.push({name:"startString"}),this._expect="string";break;case"{":this.push({name:"startObject"}),this._stack.push(this._parent),this._parent="object",this._expect="key1";break;case"[":this.push({name:"startArray"}),this._stack.push(this._parent),this._parent="array",this._expect="value1";break;case"]":if(this._expect!=="value1")return e(new Error("Parser cannot parse input: unexpected token ']'"));this._open_number&&(this._streamNumbers&&this.push({name:"endNumber"}),this._open_number=!1,this._packNumbers&&(this.push({name:"numberValue",value:this._accumulator}),this._accumulator="")),this.push({name:"endArray"}),this._parent=this._stack.pop(),this._expect=re[this._parent];break;case"-":this._open_number=!0,this._streamNumbers&&(this.push({name:"startNumber"}),this.push({name:"numberChunk",value:"-"})),this._packNumbers&&(this._accumulator="-"),this._expect="numberStart";break;case"0":this._open_number=!0,this._streamNumbers&&(this.push({name:"startNumber"}),this.push({name:"numberChunk",value:"0"})),this._packNumbers&&(this._accumulator="0"),this._expect="numberFraction";break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":this._open_number=!0,this._streamNumbers&&(this.push({name:"startNumber"}),this.push({name:"numberChunk",value:a})),this._packNumbers&&(this._accumulator=a),this._expect="numberDigit";break;case"true":case"false":case"null":if(this._buffer.length-n===a.length&&!this._done)break e;this.push({name:a+"Value",value:Rn[a]}),this._expect=re[this._parent];break}F?this._buffer=this._buffer.slice(a.length):n+=a.length;break;case"keyVal":case"string":if(p.string.lastIndex=n,r=p.string.exec(this._buffer),!r){if(n<this._buffer.length&&(this._done||this._buffer.length-n>=6))return e(new Error("Parser cannot parse input: escaped characters"));if(this._done)return e(new Error("Parser has expected a string value"));break e}if(a=r[0],a==='"')this._expect==="keyVal"?(this._streamKeys&&this.push({name:"endKey"}),this._packKeys&&(this.push({name:"keyValue",value:this._accumulator}),this._accumulator=""),this._expect="colon"):(this._streamStrings&&this.push({name:"endString"}),this._packStrings&&(this.push({name:"stringValue",value:this._accumulator}),this._accumulator=""),this._expect=re[this._parent]);else if(a.length>1&&a.charAt(0)==="\\"){let s=a.length==2?On[a.charAt(1)]:Un(a);(this._expect==="keyVal"?this._streamKeys:this._streamStrings)&&this.push({name:"stringChunk",value:s}),(this._expect==="keyVal"?this._packKeys:this._packStrings)&&(this._accumulator+=s)}else(this._expect==="keyVal"?this._streamKeys:this._streamStrings)&&this.push({name:"stringChunk",value:a}),(this._expect==="keyVal"?this._packKeys:this._packStrings)&&(this._accumulator+=a);F?this._buffer=this._buffer.slice(a.length):n+=a.length;break;case"key1":case"key":if(p.key1.lastIndex=n,r=p.key1.exec(this._buffer),!r){if(n<this._buffer.length||this._done)return e(new Error("Parser cannot parse input: expected an object key"));break e}if(a=r[0],a==='"')this._streamKeys&&this.push({name:"startKey"}),this._expect="keyVal";else if(a==="}"){if(this._expect!=="key1")return e(new Error("Parser cannot parse input: unexpected token '}'"));this.push({name:"endObject"}),this._parent=this._stack.pop(),this._expect=re[this._parent]}F?this._buffer=this._buffer.slice(a.length):n+=a.length;break;case"colon":if(p.colon.lastIndex=n,r=p.colon.exec(this._buffer),!r){if(n<this._buffer.length||this._done)return e(new Error("Parser cannot parse input: expected ':'"));break e}a=r[0],a===":"&&(this._expect="value"),F?this._buffer=this._buffer.slice(a.length):n+=a.length;break;case"arrayStop":case"objectStop":if(p.comma.lastIndex=n,r=p.comma.exec(this._buffer),!r){if(n<this._buffer.length||this._done)return e(new Error("Parser cannot parse input: expected ','"));break e}if(this._open_number&&(this._streamNumbers&&this.push({name:"endNumber"}),this._open_number=!1,this._packNumbers&&(this.push({name:"numberValue",value:this._accumulator}),this._accumulator="")),a=r[0],a===",")this._expect=this._expect==="arrayStop"?"value":"key";else if(a==="}"||a==="]"){if(a==="}"?this._expect==="arrayStop":this._expect!=="arrayStop")return e(new Error("Parser cannot parse input: expected '"+(this._expect==="arrayStop"?"]":"}")+"'"));this.push({name:a==="}"?"endObject":"endArray"}),this._parent=this._stack.pop(),this._expect=re[this._parent]}F?this._buffer=this._buffer.slice(a.length):n+=a.length;break;case"numberStart":if(p.numberStart.lastIndex=n,r=p.numberStart.exec(this._buffer),!r){if(n<this._buffer.length||this._done)return e(new Error("Parser cannot parse input: expected a starting digit"));break e}a=r[0],this._streamNumbers&&this.push({name:"numberChunk",value:a}),this._packNumbers&&(this._accumulator+=a),this._expect=a==="0"?"numberFraction":"numberDigit",F?this._buffer=this._buffer.slice(a.length):n+=a.length;break;case"numberDigit":if(p.numberDigit.lastIndex=n,r=p.numberDigit.exec(this._buffer),!r){if(n<this._buffer.length||this._done)return e(new Error("Parser cannot parse input: expected a digit"));break e}if(a=r[0],a)this._streamNumbers&&this.push({name:"numberChunk",value:a}),this._packNumbers&&(this._accumulator+=a),F?this._buffer=this._buffer.slice(a.length):n+=a.length;else{if(n<this._buffer.length){this._expect="numberFraction";break}if(this._done){this._expect=re[this._parent];break}break e}break;case"numberFraction":if(p.numberFraction.lastIndex=n,r=p.numberFraction.exec(this._buffer),!r){if(n<this._buffer.length||this._done){this._expect=re[this._parent];break}break e}a=r[0],this._streamNumbers&&this.push({name:"numberChunk",value:a}),this._packNumbers&&(this._accumulator+=a),this._expect=a==="."?"numberFracStart":"numberExpSign",F?this._buffer=this._buffer.slice(a.length):n+=a.length;break;case"numberFracStart":if(p.numberFracStart.lastIndex=n,r=p.numberFracStart.exec(this._buffer),!r){if(n<this._buffer.length||this._done)return e(new Error("Parser cannot parse input: expected a fractional part of a number"));break e}a=r[0],this._streamNumbers&&this.push({name:"numberChunk",value:a}),this._packNumbers&&(this._accumulator+=a),this._expect="numberFracDigit",F?this._buffer=this._buffer.slice(a.length):n+=a.length;break;case"numberFracDigit":if(p.numberFracDigit.lastIndex=n,r=p.numberFracDigit.exec(this._buffer),a=r[0],a)this._streamNumbers&&this.push({name:"numberChunk",value:a}),this._packNumbers&&(this._accumulator+=a),F?this._buffer=this._buffer.slice(a.length):n+=a.length;else{if(n<this._buffer.length){this._expect="numberExponent";break}if(this._done){this._expect=re[this._parent];break}break e}break;case"numberExponent":if(p.numberExponent.lastIndex=n,r=p.numberExponent.exec(this._buffer),!r){if(n<this._buffer.length){this._expect=re[this._parent];break}if(this._done){this._expect="done";break}break e}a=r[0],this._streamNumbers&&this.push({name:"numberChunk",value:a}),this._packNumbers&&(this._accumulator+=a),this._expect="numberExpSign",F?this._buffer=this._buffer.slice(a.length):n+=a.length;break;case"numberExpSign":if(p.numberExpSign.lastIndex=n,r=p.numberExpSign.exec(this._buffer),!r){if(n<this._buffer.length){this._expect="numberExpStart";break}if(this._done)return e(new Error("Parser has expected an exponent value of a number"));break e}a=r[0],this._streamNumbers&&this.push({name:"numberChunk",value:a}),this._packNumbers&&(this._accumulator+=a),this._expect="numberExpStart",F?this._buffer=this._buffer.slice(a.length):n+=a.length;break;case"numberExpStart":if(p.numberExpStart.lastIndex=n,r=p.numberExpStart.exec(this._buffer),!r){if(n<this._buffer.length||this._done)return e(new Error("Parser cannot parse input: expected an exponent part of a number"));break e}a=r[0],this._streamNumbers&&this.push({name:"numberChunk",value:a}),this._packNumbers&&(this._accumulator+=a),this._expect="numberExpDigit",F?this._buffer=this._buffer.slice(a.length):n+=a.length;break;case"numberExpDigit":if(p.numberExpDigit.lastIndex=n,r=p.numberExpDigit.exec(this._buffer),a=r[0],a)this._streamNumbers&&this.push({name:"numberChunk",value:a}),this._packNumbers&&(this._accumulator+=a),F?this._buffer=this._buffer.slice(a.length):n+=a.length;else{if(n<this._buffer.length||this._done){this._expect=re[this._parent];break}break e}break;case"done":if(p.ws.lastIndex=n,r=p.ws.exec(this._buffer),!r){if(n<this._buffer.length){if(this._jsonStreaming){this._expect="value";break}return e(new Error("Parser cannot parse input: unexpected characters"))}break e}a=r[0],this._open_number&&(this._streamNumbers&&this.push({name:"endNumber"}),this._open_number=!1,this._packNumbers&&(this.push({name:"numberValue",value:this._accumulator}),this._accumulator="")),F?this._buffer=this._buffer.slice(a.length):n+=a.length;break}!F&&(this._buffer=this._buffer.slice(n)),e(null)}};xe.parser=xe.make;xe.make.Constructor=xe;Wr.exports=xe});var Hr=V((Ni,zr)=>{"use strict";var Nn=t=>t.on("data",e=>t.emit(e.name,e.value));zr.exports=Nn});var Gt=V((Vi,Kr)=>{"use strict";var Kt=Ht(),Vn=Hr(),qt=t=>Vn(new Kt(t));qt.Parser=Kt;qt.parser=Kt.parser;Kr.exports=qt});var Yt=V((Bi,qr)=>{"use strict";var{Transform:Bn}=require("stream"),ae=class t extends Bn{static stringFilter(e,r){return a=>{let n=a.join(r);return n.length===e.length&&n===e||n.length>e.length&&n.substr(0,e.length)===e&&n.substr(e.length,r.length)===r}}static regExpFilter(e,r){return a=>e.test(a.join(r))}static arrayReplacement(e){return()=>e}constructor(e){super(Object.assign({},e,{writableObjectMode:!0,readableObjectMode:!0})),this._transform=this._check,this._stack=[];let r=e&&e.filter,a=e&&e.pathSeparator||".";typeof r=="string"?this._filter=t.stringFilter(r,a):typeof r=="function"?this._filter=r:r instanceof RegExp&&(this._filter=t.regExpFilter(r,a));let n=e&&e.replacement;typeof n=="function"?this._replacement=n:this._replacement=t.arrayReplacement(n||t.defaultReplacement),this._allowEmptyReplacement=e&&e.allowEmptyReplacement,this._streamKeys=!0,e&&("streamValues"in e&&(this._streamKeys=e.streamValues),"streamKeys"in e&&(this._streamKeys=e.streamKeys)),this._once=e&&e.once,this._previousToken=""}_check(e,r,a){switch(e.name){case"startObject":case"startArray":case"startString":case"startNumber":case"nullValue":case"trueValue":case"falseValue":typeof this._stack[this._stack.length-1]=="number"&&++this._stack[this._stack.length-1];break;case"keyValue":this._stack[this._stack.length-1]=e.value;break;case"numberValue":this._previousToken!=="endNumber"&&typeof this._stack[this._stack.length-1]=="number"&&++this._stack[this._stack.length-1];break;case"stringValue":this._previousToken!=="endString"&&typeof this._stack[this._stack.length-1]=="number"&&++this._stack[this._stack.length-1];break}if(this._previousToken=e.name,this._checkChunk(e))return a(null);switch(e.name){case"startObject":this._stack.push(null);break;case"startArray":this._stack.push(-1);break;case"endObject":case"endArray":this._stack.pop();break}a(null)}_passObject(e,r,a){switch(this.push(e),e.name){case"startObject":case"startArray":++this._depth;break;case"endObject":case"endArray":--this._depth;break}this._depth||(this._transform=this._once?this._skip:this._check),a(null)}_pass(e,r,a){this.push(e),a(null)}_skipObject(e,r,a){switch(e.name){case"startObject":case"startArray":++this._depth;break;case"endObject":case"endArray":--this._depth;break}this._depth||(this._transform=this._once?this._pass:this._check),a(null)}_skip(e,r,a){a(null)}};ae.defaultReplacement=[{name:"nullValue",value:null}];var Jt=(t,e)=>function(r,a,n){if(this._expected){let s=this._expected;if(this._expected="",this._transform=this._once?this._skip:this._check,s===r.name)this.push(r);else return this._transform(r,a,n)}else this.push(r),r.name===t&&(this._expected=e);n(null)};ae.prototype._passNumber=Jt("endNumber","numberValue");ae.prototype._passString=Jt("endString","stringValue");ae.prototype._passKey=Jt("endKey","keyValue");var Zt=(t,e)=>function(r,a,n){if(this._expected){let s=this._expected;if(this._expected="",this._transform=this._once?this._pass:this._check,s!==r.name)return this._transform(r,a,n)}else r.name===t&&(this._expected=e);n(null)};ae.prototype._skipNumber=Zt("endNumber","numberValue");ae.prototype._skipString=Zt("endString","stringValue");ae.prototype._skipKey=Zt("endKey","keyValue");qr.exports=ae});var tt=V((ji,Gr)=>{"use strict";var{chain:jn}=kt(),Wn=Ht(),zn=(t,e)=>jn([new Wn(e),t(e)],Object.assign({},e,{writableObjectMode:!1,readableObjectMode:!0}));Gr.exports=zn});var Zr=V((Wi,Jr)=>{"use strict";var Hn=Yt(),Kn=tt(),$e=class t extends Hn{static make(e){return new t(e)}static withParser(e){return Kn(t.make,e)}constructor(e){super(e),this._once=!1,this._lastStack=[]}_flush(e){this._syncStack(),e(null)}_checkChunk(e){switch(e.name){case"startObject":this._filter(this._stack,e)&&(this._syncStack(),this.push(e),this._lastStack.push(null));break;case"startArray":this._filter(this._stack,e)&&(this._syncStack(),this.push(e),this._lastStack.push(-1));break;case"nullValue":case"trueValue":case"falseValue":case"stringValue":case"numberValue":this._filter(this._stack,e)&&(this._syncStack(),this.push(e));break;case"startString":this._filter(this._stack,e)?(this._syncStack(),this.push(e),this._transform=this._passString):this._transform=this._skipString;break;case"startNumber":this._filter(this._stack,e)?(this._syncStack(),this.push(e),this._transform=this._passNumber):this._transform=this._skipNumber;break}return!1}_syncStack(){let e=this._stack,r=this._lastStack,a=e.length,n=r.length,s=0;for(let i=Math.min(a,n);s<i&&e[s]===r[s];++s);for(let i=n-1;i>s;--i)this.push({name:typeof r[i]=="number"?"endArray":"endObject"});if(s<n)if(s<a){if(typeof e[s]=="string"){let i=e[s];this._streamKeys&&(this.push({name:"startKey"}),this.push({name:"stringChunk",value:i}),this.push({name:"endKey"})),this.push({name:"keyValue",value:i})}++s}else this.push({name:typeof r[s]=="number"?"endArray":"endObject"});for(let i=s;i<a;++i){let o=e[i];typeof o=="number"?o>=0&&this.push({name:"startArray"}):typeof o=="string"&&(this.push({name:"startObject"}),this._streamKeys&&(this.push({name:"startKey"}),this.push({name:"stringChunk",value:o}),this.push({name:"endKey"})),this.push({name:"keyValue",value:o}))}this._lastStack=Array.prototype.concat.call(e)}};$e.filter=$e.make;$e.make.Constructor=$e;Jr.exports=$e});var Qr=V((zi,Xr)=>{"use strict";var qn=require("events"),Yr=t=>function(){this.done?this.done=!1:this.stack.push(this.current,this.key),this.current=new t,this.key=null},le=class t extends qn{static connectTo(e,r){return new t(r).connectTo(e)}constructor(e){super(),this.stack=[],this.current=this.key=null,this.done=!0,e&&(this.reviver=typeof e.reviver=="function"&&e.reviver,this.reviver&&(this.stringValue=this._saveValue=this._saveValueWithReviver),e.numberAsString&&(this.numberValue=this.stringValue))}connectTo(e){return e.on("data",r=>{this[r.name]&&(this[r.name](r.value),this.done&&this.emit("done",this))}),this}get depth(){return(this.stack.length>>1)+(this.done?0:1)}get path(){let e=[];for(let r=0;r<this.stack.length;r+=2){let a=this.stack[r+1];e.push(a===null?this.stack[r].length:a)}return e}dropToLevel(e){if(e<this.depth)if(e){let r=e-1<<1;this.current=this.stack[r],this.key=this.stack[r+1],this.stack.splice(r)}else this.stack=[],this.current=this.key=null,this.done=!0;return this}consume(e){return this[e.name]&&this[e.name](e.value),this}keyValue(e){this.key=e}numberValue(e){this._saveValue(parseFloat(e))}nullValue(){this._saveValue(null)}trueValue(){this._saveValue(!0)}falseValue(){this._saveValue(!1)}endObject(){if(this.stack.length){let e=this.current;this.key=this.stack.pop(),this.current=this.stack.pop(),this._saveValue(e)}else this.done=!0}_saveValue(e){this.done?this.current=e:this.current instanceof Array?this.current.push(e):(this.current[this.key]=e,this.key=null)}_saveValueWithReviver(e){this.done?this.current=this.reviver("",e):this.current instanceof Array?(e=this.reviver(""+this.current.length,e),this.current.push(e),e===void 0&&delete this.current[this.current.length-1]):(e=this.reviver(this.key,e),e!==void 0&&(this.current[this.key]=e),this.key=null)}};le.prototype.stringValue=le.prototype._saveValue;le.prototype.startObject=Yr(Object);le.prototype.startArray=Yr(Array);le.prototype.endArray=le.prototype.endObject;Xr.exports=le});var er=V((Hi,ea)=>{"use strict";var{Transform:Gn}=require("stream"),Jn=Qr(),Xt=class{constructor(e){this.depth=e}startObject(){++this.depth}endObject(){--this.depth}startArray(){++this.depth}endArray(){--this.depth}},Qt=class extends Gn{constructor(e){super(Object.assign({},e,{writableObjectMode:!0,readableObjectMode:!0})),e&&(this.objectFilter=e.objectFilter,this.includeUndecided=e.includeUndecided),typeof this.objectFilter!="function"&&(this._filter=this._transform),this._transform=this._wait||this._filter,this._assembler=new Jn(e)}_transform(e,r,a){this._assembler[e.name]&&(this._assembler[e.name](e.value),this._assembler.depth===this._level&&this._push()),a(null)}_filter(e,r,a){if(this._assembler[e.name]){this._assembler[e.name](e.value);let n=this.objectFilter(this._assembler);if(n)return this._assembler.depth===this._level&&(this._push(),this._transform=this._filter),this._transform=this._accept,a(null);if(n===!1)return this._saved_assembler=this._assembler,this._assembler=new Xt(this._saved_assembler.depth),this._saved_assembler.dropToLevel(this._level),this._assembler.depth===this._level&&(this._assembler=this._saved_assembler,this._transform=this._filter),this._transform=this._reject,a(null);this._assembler.depth===this._level&&this._push(!this.includeUndecided)}a(null)}_accept(e,r,a){this._assembler[e.name]&&(this._assembler[e.name](e.value),this._assembler.depth===this._level&&(this._push(),this._transform=this._filter)),a(null)}_reject(e,r,a){this._assembler[e.name]&&(this._assembler[e.name](e.value),this._assembler.depth===this._level&&(this._assembler=this._saved_assembler,this._transform=this._filter)),a(null)}};ea.exports=Qt});var ra=V((Ki,ta)=>{"use strict";var Zn=er(),Yn=tt(),Se=class t extends Zn{static make(e){return new t(e)}static withParser(e){return Yn(t.make,e)}constructor(e){super(e),this._level=1,this._counter=0}_wait(e,r,a){return e.name!=="startArray"?a(new Error("Top-level object should be an array.")):(this._transform=this._filter,this._transform(e,r,a))}_push(e){this._assembler.current.length&&(e?(++this._counter,this._assembler.current.pop()):this.push({key:this._counter++,value:this._assembler.current.pop()}))}};Se.streamArray=Se.make;Se.make.Constructor=Se;ta.exports=Se});var ya=V((wo,ba)=>{"use strict";var is=Yt(),os=tt(),ve=class t extends is{static make(e){return new t(e)}static withParser(e){return os(t.make,e)}_checkChunk(e){switch(e.name){case"startObject":case"startArray":if(this._filter(this._stack,e))return this.push(e),this._transform=this._passObject,this._depth=1,!0;break;case"startString":if(this._filter(this._stack,e))return this.push(e),this._transform=this._passString,!0;break;case"startNumber":if(this._filter(this._stack,e))return this.push(e),this._transform=this._passNumber,!0;break;case"nullValue":case"trueValue":case"falseValue":case"stringValue":case"numberValue":if(this._filter(this._stack,e))return this.push(e),this._transform=this._once?this._skip:this._check,!0;break}return!1}};ve.pick=ve.make;ve.make.Constructor=ve;ba.exports=ve});var ka=V((ko,wa)=>{"use strict";var cs=er(),ls=tt(),Pe=class t extends cs{static make(e){return new t(e)}static withParser(e){return ls(t.make,e)}constructor(e){super(e),this._level=1,this._lastKey=null}_wait(e,r,a){return e.name!=="startObject"?a(new Error("Top-level object should be an object.")):(this._transform=this._filter,this._transform(e,r,a))}_push(e){this._lastKey===null?this._lastKey=this._assembler.key:(!e&&this.push({key:this._lastKey,value:this._assembler.current[this._lastKey]}),this._assembler.current={},this._lastKey=null)}};Pe.streamObject=Pe.make;Pe.make.Constructor=Pe;wa.exports=Pe});var vi={};mn(vi,{default:()=>nn});module.exports=pn(vi);var an=require("react");var _a=require("react"),fe=require("@raycast/api");var Pr=require("@raycast/api"),$=(0,Pr.getPreferenceValues)();var Mr=I(Ut()),_e=new Mr.Logger({prefix:"[Brew]"}),v=_e.child("[Commands]"),oe=_e.child("[Cache]"),G=_e.child("[Actions]"),Ot=_e.child("[Fetch]"),Nt=_e.child("[Search]"),O=_e.child("[UI]");var K=class extends Error{constructor(e,r){super(e),this.name="BrewError",this.brewCause=r?.cause}},De=class extends K{constructor(e,r){super(e,{cause:r?.cause}),this.name="NetworkError",this.statusCode=r?.statusCode,this.url=r?.url}};var Fe=class extends K{constructor(e,r){super(e,{cause:r?.cause}),this.name="BrewCommandError",this.command=r?.command,this.exitCode=r?.exitCode,this.stderr=r?.stderr}},pt=class extends K{constructor(e,r){super(e,{cause:r?.cause}),this.name="BrewNotFoundError",this.path=r?.path}};var te=class extends K{constructor(e,r){super(e,{cause:r?.cause}),this.name="BrewLockError",this.command=r?.command}},Qe=class extends K{constructor(e,r){super(e,{cause:r?.cause}),this.name="DownloadTimeoutError",this.packageName=r?.packageName,this.phase=r?.phase,this.timeoutMs=r?.timeoutMs,this.elapsedMs=r?.elapsedMs}},me=class extends K{constructor(e,r){super(e,{cause:r?.cause}),this.name="StaleProcessError",this.packageName=r?.packageName,this.lastPhase=r?.lastPhase,this.staleDurationMs=r?.staleDurationMs}},gt=class extends K{constructor(e,r){super(e,{cause:r?.cause}),this.name="PackageNotFoundError",this.packageName=r?.packageName,this.packageType=r?.packageType}},bt=class extends K{constructor(e,r){super(e,{cause:r?.cause}),this.name="PackageDisabledError",this.packageName=r?.packageName,this.packageType=r?.packageType,this.disabledDate=r?.disabledDate,this.reason=r?.reason}},yt=class extends K{constructor(e,r){super(e,{cause:r?.cause}),this.name="PackageConflictError",this.packageName=r?.packageName,this.conflictsWith=r?.conflictsWith}},wt=class extends K{constructor(e,r){super(e,{cause:r?.cause}),this.name="UnsupportedMacOSError",this.packageName=r?.packageName,this.requiredVersion=r?.requiredVersion,this.currentVersion=r?.currentVersion}};function Bt(t){return t instanceof De}function ce(t){return t instanceof te}function Lr(t){return t instanceof Qe}function Rr(t){return t instanceof me}function Me(t){return Bt(t)||ce(t)||Lr(t)||Rr(t)}var yn=[/lockf:.*already locked/i,/another active Homebrew/i,/another brew process/i,/another.*brew.*update.*process/i,/Homebrew is already running/i,/Error: Another active Homebrew/i,/Error: Another.*brew.*process/i,/waiting for lock/i,/lock file/i,/has already locked/i,/brew upgrade.*process has already/i],wn=/Error: (Cask|Formula) '([^']+)' has been disabled(?: because (.+?))?(?:! It was disabled on (\d{4}-\d{2}-\d{2}))?/i;function et(t){return yn.some(e=>e.test(t))}function Vt(t){let e=t.match(wn);return e?{packageType:e[1].toLowerCase(),packageName:e[2],reason:e[3]?.trim(),disabledDate:e[4]}:null}function J(t){return t instanceof Error?t:new Error(String(t))}function pe(t){if(t instanceof te)return"Another brew process is already running. Please wait for it to finish and try again.";if(t instanceof Qe){let e=t.packageName?` for "${t.packageName}"`:"",r=t.phase?` during ${t.phase}`:"";return`Download timed out${e}${r}. Please try again.`}if(t instanceof me){let e=t.packageName?` for "${t.packageName}"`:"",r=t.lastPhase?` (stuck at ${t.lastPhase})`:"";return`Process appears stuck${e}${r}. The operation was cancelled.`}if(t instanceof bt){let e=t.packageType??"package",a=`${e.charAt(0).toUpperCase()+e.slice(1)} "${t.packageName}" has been discontinued`;return t.reason&&(a+=`: ${t.reason}`),t.disabledDate&&(a+=` (disabled on ${t.disabledDate})`),a}if(t instanceof yt){let e=t.conflictsWith?.join(", ")??"another package";return`"${t.packageName}" conflicts with ${e}. Please uninstall the conflicting package first.`}if(t instanceof wt){let e=`"${t.packageName}" requires a different macOS version`;return t.requiredVersion&&(e+=` (requires ${t.requiredVersion})`),e}if(t instanceof De)return t.statusCode?`Network error (HTTP ${t.statusCode}): ${t.message}`:`Network error: ${t.message}`;if(t instanceof pt)return`Homebrew not found: ${t.message}`;if(t instanceof gt){let e=t.packageType??"package";return`${e.charAt(0).toUpperCase()+e.slice(1)} not found: ${t.packageName??t.message}`}if(t instanceof Fe){if(t.exitCode===void 0||t.exitCode===null)return"Cancelled";if(t.stderr){let e=Vt(t.stderr);if(e){let r=`${e.packageType.charAt(0).toUpperCase()+e.packageType.slice(1)} "${e.packageName}" has been discontinued`;return e.reason&&(r+=`: ${e.reason}`),e.disabledDate&&(r+=` (disabled on ${e.disabledDate})`),r}}return t.stderr??t.message}if(t instanceof K)return t.message;if(t instanceof Error){if(t.name==="AbortError")return"Cancelled";let e=t;if(e.stderr){let r=Vt(e.stderr);if(r){let a=`${r.packageType.charAt(0).toUpperCase()+r.packageType.slice(1)} "${r.packageName}" has been discontinued`;return r.reason&&(a+=`: ${r.reason}`),r.disabledDate&&(a+=` (disabled on ${r.disabledDate})`),a}return e.stderr}return t.message}return String(t)}var Le=require("@raycast/api"),tr=I(require("path")),aa=I(require("fs"));var es=I(kt()),ts=I(Gt()),rs=I(Zr()),as=I(ra());var na=(()=>{try{aa.default.mkdirSync(Le.environment.supportPath,{recursive:!0})}catch{oe.warn("Failed to create supportPath")}return Le.environment.supportPath})(),rr=Le.environment.supportPath.split(tr.default.sep).find(t=>!!t.startsWith("com.raycast"))??"com.raycast.macos";function rt(t){return tr.default.join(na,t)}var j=require("@raycast/api");function at(t){let e={style:j.Toast.Style.Animated,title:t.title,message:t.message},r;t.cancelable&&(r=new AbortController,e.primaryAction={title:"Cancel",onAction:()=>{r?.abort(),a.hide()}});let a=new j.Toast(e);return a.show(),{abort:r,updateMessage:n=>{a.message=n},updateTitle:n=>{a.title=n},showSuccessHUD:async n=>{$.closeAfterAction?(a.hide(),await(0,j.showHUD)(`\u2705 ${n}`)):(a.style=j.Toast.Style.Success,a.title=n,a.message=void 0,a.primaryAction=void 0)},showFailureHUD:async n=>{$.closeAfterAction?(a.hide(),await(0,j.showHUD)(`\u274C ${n}`)):(a.style=j.Toast.Style.Failure,a.title=n,a.message=void 0,a.primaryAction=void 0)},hide:()=>{a.hide()}}}async function Ce(t,e,r){if(e.name==="AbortError"){O.log("Operation aborted by user");return}let a=e,n=pe(e),s=ce(e);O.error(t,{errorType:e.name,message:e.message,stderr:a.stderr,code:a.code,recoverable:Me(e),isLockError:s});let i=s?"Brew is Busy":t,o={style:j.Toast.Style.Failure,title:i,message:n,primaryAction:{title:"Copy Logs",onAction:()=>{let d=s?`${i}
${n}

Tip: Check Activity Monitor or run 'ps aux | grep brew' in Terminal to see what's running.`:n;j.Clipboard.copy(d)}}};if(Me(e)&&r?.retryAction){let d=r.retryAction;o.secondaryAction={title:"Retry",onAction:async u=>{u.style=j.Toast.Style.Animated,u.title="Retrying...",u.message=void 0;try{await d(),u.style=j.Toast.Style.Success,u.title="Success"}catch(m){u.style=j.Toast.Style.Failure,u.title=ce(m)?"Brew is Busy":t,u.message=pe(m)}}}}await new j.Toast(o).show()}Array.prototype.first||(Array.prototype.first=function(){return this.at(0)});Array.prototype.last||(Array.prototype.last=function(){return this.at(-1)});Array.prototype.isTruncated||(Array.prototype.isTruncated=function(){return this.totalLength?this.length<this.totalLength:!1});String.ellipsis||(String.ellipsis="\u2026");var sa=I(Ut()),ns=new sa.Logger({prefix:"[Brew]"}).child("[Memory]");var ia=require("child_process"),ar=require("path"),oa=require("os");var Re=(()=>{if($.customBrewPath&&$.customBrewPath.length>0)return(0,ar.join)($.customBrewPath,"..","..");try{return(0,ia.execSync)("brew --prefix",{encoding:"utf8"}).trim()}catch{return(0,oa.cpus)()[0]?.model?.includes("Apple")?"/opt/homebrew":"/usr/local"}})(),ne=t=>(0,ar.join)(Re,t),ge=()=>ne("bin/brew");var la=require("child_process"),ua=require("util"),fa=require("fs"),_t=I(require("fs/promises")),da=require("path"),ha=require("@raycast/api");var ss=(0,ua.promisify)(la.exec),ca=!1;async function ue(t,e){try{let r=await xt();return await ss(`${ge()} ${t}`,{signal:e?.signal,env:r,maxBuffer:10*1024*1024})}catch(r){let a=r,n=a?.stderr||a?.stdout||"";throw et(n)?(v.warn("Brew lock detected - another process is running",{command:t,stderr:a?.stderr}),new te("Another brew process is already running",{command:t,cause:a})):$.customBrewPath&&a&&a.code===127?(a.stderr=`Brew executable not found at: ${$.customBrewPath}`,a):r}}async function xt(){let t=(0,da.join)(ha.environment.assetsPath,"askpass.sh");try{await _t.access(t,fa.constants.X_OK)}catch{await _t.chmod(t,493)}let e={...process.env};e.SUDO_ASKPASS=t,e.HOMEBREW_BROWSER=rr;let r=$.disableDownloadConcurrency;r&&(e.HOMEBREW_DOWNLOAD_CONCURRENCY="1");let a=$.useInternalApi;return a&&(e.HOMEBREW_USE_INTERNAL_API="1"),ca||(ca=!0,v.log("Homebrew 5.0 Configuration",{downloadConcurrencyEnabled:!r,downloadConcurrencyMode:r?"sequential (1)":"parallel (auto)",internalApiEnabled:a,verboseLogging:$.verboseLogging})),e}var ma=require("child_process");var nr=300*1e3,pa=600*1e3;function ga(t){let e=t.trim();if(!e)return null;let r=e.replace(/^=+>\s*/,"");if(e.includes("Downloading"))return{phase:"downloading",message:r};let a=e.match(/#+\s*(\d+\.?\d*)%/);return a?{phase:"downloading",message:`Downloading... ${a[1]}%`,percentage:parseFloat(a[1])}:e.includes("Verifying")||e.includes("checksum")?{phase:"verifying",message:r}:e.includes("Pouring")||e.includes("Extracting")?{phase:"extracting",message:r}:e.includes("Installing")||e.includes("==> Installing")?{phase:"installing",message:r}:e.includes("Linking")||e.includes("==> Linking")?{phase:"linking",message:r}:e.includes("Cleaning")||e.includes("Removing")?{phase:"cleaning",message:r}:e.includes("==> Caveats")||e.includes("==> Summary")?{phase:"complete",message:r}:e.startsWith("==>")?{phase:"installing",message:r}:null}async function nt(t,e,r,a){let n=await xt(),s=t.split(/\s+/).filter(Boolean),i=a?.staleTimeoutMs??nr,o=a?.packageName,l=a?.verboseLogging??!1;return v.log("Executing brew with progress",{command:t,packageName:o,staleTimeoutMs:i}),new Promise((d,u)=>{let m=(0,ma.spawn)(ge(),s,{env:n,stdio:["ignore","pipe","pipe"]}),b="",B="",H=Date.now(),y="starting",D=null,U=!1,ie=()=>{D&&(clearInterval(D),D=null)},N=_=>{U||(U=!0,ie(),m.kill("SIGTERM"),u(_))};D=setInterval(()=>{let E=Date.now()-H,Q=y==="downloading"?pa:i;E>Q?(v.warn("Stale process detected",{command:t,packageName:o,lastPhase:y,staleDurationMs:E,timeoutMs:Q}),N(new me(`Process appears stuck during ${y}`,{packageName:o,lastPhase:y,staleDurationMs:E}))):l&&v.log("Stale check passed",{command:t,phase:y,timeSinceLastProgress:E,timeout:Q})},3e4),r&&r.addEventListener("abort",()=>{if(U)return;U=!0,ie(),m.kill("SIGTERM");let _=new Error("Cancelled");_.name="AbortError",u(_)}),e?.({phase:"starting",message:`Running: brew ${t.trim()}`});let C=(_,E)=>{H=Date.now();let Q=_.split(`
`);for(let Xe of Q){let de=ga(Xe);de?(de.phase!==y&&(v.log("Phase transition",{command:t,packageName:o,from:y,to:de.phase,message:de.message}),y=de.phase),e?.(de)):l&&Xe.trim()&&v.log(`Unparsed ${E}`,{line:Xe.trim()})}};m.stdout?.on("data",_=>{let E=_.toString();b+=E,C(E,"stdout")}),m.stderr?.on("data",_=>{let E=_.toString();if(B+=E,et(E)){N(new te("Another brew process is already running",{command:t}));return}C(E,"stderr")}),m.on("close",_=>{ie(),!U&&(v.log("Command completed",{command:t,packageName:o,exitCode:_,finalPhase:y}),_===0?(e?.({phase:"complete",message:"Operation completed successfully"}),d({stdout:b,stderr:B})):(e?.({phase:"error",message:`Command failed with exit code ${_}`}),u(new Fe(`brew ${t} failed with exit code ${_}`,{command:t,exitCode:_??void 0,stderr:B}))))}),m.on("error",_=>{ie(),!U&&(e?.({phase:"error",message:_.message}),u(_))})})}var Oe=I(require("fs/promises"));var ds=I(kt()),hs=I(Gt()),ms=I(ya()),ps=I(ka());var Ue=rt("installedv2.json"),To=rt("formula.json"),Do=rt("cask.json");async function sr(t,e){let r=Date.now(),a=await ys(t,e),n=ws(a),s=Date.now()-r;return n&&v.log("Installed packages fetched",{formulaeCount:n.formulae.size,casksCount:n.casks.size,totalCount:n.formulae.size+n.casks.size,durationMs:s,fromCache:t}),n}async function ys(t,e){async function r(){return(await ue("info --json=v2 --installed",e?{signal:e}:void 0)).stdout}if(!t)return JSON.parse(await r());async function a(){let i=Date.now(),o=await r(),l=JSON.parse(o),d=Date.now()-i;try{await Oe.writeFile(Ue,o);let u=Buffer.byteLength(o,"utf8"),m=(u/1024).toFixed(2);oe.log("Updated installed cache",{path:Ue,formulaeCount:l.formulae.length,casksCount:l.casks.length,totalCount:l.formulae.length+l.casks.length,durationMs:d,responseSizeBytes:u,responseSizeKb:`${m} KB`,usingInternalApi:$.useInternalApi})}catch(u){oe.error("Failed to write installed cache",{path:Ue,formulaeCount:l.formulae.length,casksCount:l.casks.length,error:u})}return l}async function n(i){return(await Oe.stat(i)).mtimeMs}async function s(){let i=await n(Ue),o=await n(ne("var/homebrew/locks")),l=await n(ne("Caskroom")),d;try{d=await n(ne("var/homebrew/pinned"))}catch{d=0}let u=await n(ne("var/homebrew"));if(u<i&&l<i&&o<i&&d<i){let m=await Oe.readFile(Ue),b=JSON.parse(m.toString());return oe.log("Using cached installed data",{path:Ue,formulaeCount:b.formulae.length,casksCount:b.casks.length,totalCount:b.formulae.length+b.casks.length,cacheAgeMs:Date.now()-i}),b}else return oe.log("Cache invalidated, refreshing",{reason:"brew state changed",homebrewTime:u,caskroomTime:l,locksTime:o,pinnedTime:d,cacheTime:i}),await a()}try{return await s()}catch{return await a()}}function ws(t){if(!t)return;let e=new Map;for(let a of t.formulae)e.set(a.name,a);let r=new Map;for(let a of t.casks)r.set(a.token,a);return{formulae:e,casks:r}}async function st(t,e){let r=Date.now();v.log("Fetching formula info",{name:t});try{let a=await ue(`info --json=v2 ${t}`,e?{signal:e}:void 0),n=JSON.parse(a.stdout),s=Date.now()-r;if(n.formulae.length>0)return v.log("Formula info fetched",{name:t,durationMs:s}),n.formulae[0];v.warn("Formula not found",{name:t,durationMs:s});return}catch(a){v.error("Failed to fetch formula info",{name:t,error:a});return}}async function it(t,e){let r=Date.now();v.log("Fetching cask info",{token:t});try{let a=await ue(`info --json=v2 ${t}`,e?{signal:e}:void 0),n=JSON.parse(a.stdout),s=Date.now()-r;if(n.casks.length>0)return v.log("Cask info fetched",{token:t,durationMs:s}),n.casks[0];v.warn("Cask not found",{token:t,durationMs:s});return}catch(a){v.error("Failed to fetch cask info",{token:t,error:a});return}}var ot=require("path");function Z(t){return t.token!==void 0}function be(t){return Z(t)?t.token:t.name}function T(t){return Z(t)?t.name&&t.name[0]?t.name[0]:"Unknown":t.name}function ye(t,e=!1){return Z(t)?"--cask"+(e&&$.zapCask?" --zap":""):""}function X(t){return Z(t)?ks(t):_s(t)}function ks(t){return t.installed?t.installed.length>0:!1}function _s(t){return t.installed.length>0}function $t(t){return Z(t)?xs(t):$s(t)}function xs(t){let e=ne((0,ot.join)("Caskroom",t.token));return t.installed?(0,ot.join)(e,t.installed):e}function $s(t){let e=ne((0,ot.join)("Cellar",t.name)),r=t.installed[0];return r?(0,ot.join)(e,r.version):e}function St(t){return Z(t)?Ss(t):Cs(t)}function Ss(t){if(!t.installed)return"";let e=t.installed;return t.outdated&&(e+=" (O)"),e}function Cs(t){let e=t.installed[0];if(!e)return"";let r=e.version,a="";return e.installed_as_dependency&&(a+="D"),t.pinned&&(a+="P"),t.outdated&&(a+="O"),a&&(r+=` (${a})`),r}function Ne(t){let e=be(t);return`${ge()} install ${ye(t)} ${e}`.replace(/ +/g," ")}function Ve(t){let e=be(t);return`${ge()} uninstall ${ye(t,!0)} ${e}`.replace(/ +/g," ")}async function ir(t,e,r){let a=be(t),n=Z(t);G.log("Installing package with progress",{identifier:a,type:n?"cask":"formula"}),await nt(`install ${ye(t)} ${a}`,e,r),n?t.installed=t.version:t.installed=[{version:t.versions.stable,installed_as_dependency:!1,installed_on_request:!0}],G.log("Package installed successfully",{identifier:a})}async function or(t,e){let r=be(t);G.log("Uninstalling package",{identifier:r,type:Z(t)?"cask":"formula",zap:$.zapCask}),await ue(`rm ${ye(t,!0)} ${r}`,e?{signal:e}:void 0),G.log("Package uninstalled successfully",{identifier:r})}async function cr(t,e,r){let a=be(t);G.log("Upgrading package with progress",{identifier:a,type:Z(t)?"cask":"formula"}),await nt(`upgrade ${ye(t)} ${a}`,e,r),G.log("Package upgraded successfully",{identifier:a})}async function lr(t){G.log("Pinning formula",{name:t.name}),await ue(`pin ${t.name}`),t.pinned=!0,G.log("Formula pinned successfully",{name:t.name})}async function ur(t){G.log("Unpinning formula",{name:t.name}),await ue(`unpin ${t.name}`),t.pinned=!1,G.log("Formula unpinned successfully",{name:t.name})}var Be=require("react/jsx-runtime"),Ct=class extends _a.Component{constructor(e){super(e),this.state={hasError:!1}}static getDerivedStateFromError(e){return{hasError:!0,error:e}}componentDidCatch(e,r){O.error("React error boundary caught error",{error:e.message,stack:e.stack,componentStack:r.componentStack}),this.setState({errorInfo:r})}render(){if(this.state.hasError){if(this.props.fallback)return this.props.fallback;let{error:e,errorInfo:r}=this.state,a=["# An Error Occurred","","Something went wrong while rendering this view.","","## Error Message","```",e?.message??"Unknown error","```","",e?.stack?["## Stack Trace","```",e.stack,"```",""].join(`
`):"",r?.componentStack?["## Component Stack","```",r.componentStack,"```"].join(`
`):""].join(`
`);return(0,Be.jsx)(fe.Detail,{markdown:a,actions:(0,Be.jsxs)(fe.ActionPanel,{children:[(0,Be.jsx)(fe.Action,{title:"Reload",icon:fe.Icon.ArrowClockwise,onAction:()=>this.setState({hasError:!1,error:void 0,errorInfo:void 0})}),(0,Be.jsx)(fe.Action.CopyToClipboard,{title:"Copy Error Details",content:a})]})})}return this.props.children}};var ct=require("@raycast/api"),je=require("react/jsx-runtime");function xa(t){return(0,je.jsxs)(ct.List.Dropdown,{tooltip:"Filter by formula or cask",onChange:e=>{t.onSelect(e)},storeValue:!0,children:[(0,je.jsx)(ct.List.Dropdown.Item,{value:"all",title:"All"}),(0,je.jsx)(ct.List.Dropdown.Item,{value:"formulae",title:"Formulae"}),(0,je.jsx)(ct.List.Dropdown.Item,{value:"casks",title:"Casks"})]})}function $a(t){return`Search ${t==="all"?"formulae or casks":t==="casks"?"casks":"formulae"} by name${String.ellipsis}`}var A=require("@raycast/api");var w=I(require("react")),k=require("@raycast/api");var Sa=Object.prototype.hasOwnProperty;function vt(t,e){var r,a;if(t===e)return!0;if(t&&e&&(r=t.constructor)===e.constructor){if(r===Date)return t.getTime()===e.getTime();if(r===RegExp)return t.toString()===e.toString();if(r===Array){if((a=t.length)===e.length)for(;a--&&vt(t[a],e[a]););return a===-1}if(!r||typeof t=="object"){a=0;for(r in t)if(Sa.call(t,r)&&++a&&!Sa.call(e,r)||!(r in e)||!vt(t[r],e[r]))return!1;return Object.keys(e).length===a}}return t!==t&&e!==e}var Ae=I(require("node:fs")),At=I(require("node:path")),Fa=I(require("node:crypto")),Ma=I(require("node:child_process")),La=require("node:buffer"),ze=I(require("node:stream")),Ra=require("node:util");var Ua=require("react/jsx-runtime");var fr=globalThis;function Ms(t){let e=(0,w.useRef)(t),r=(0,w.useRef)(0);return vt(t,e.current)||(e.current=t,r.current+=1),(0,w.useMemo)(()=>e.current,[r.current])}function Y(t){let e=(0,w.useRef)(t);return e.current=t,e}function Ls(t,e){let r=t instanceof Error?t.message:String(t);return(0,k.showToast)({style:k.Toast.Style.Failure,title:e?.title??"Something went wrong",message:e?.message??r,primaryAction:e?.primaryAction??Ca(t),secondaryAction:e?.primaryAction?Ca(t):void 0})}var Ca=t=>{let e=!0,r="[Extension Name]...",a="";try{let i=JSON.parse((0,Ae.readFileSync)((0,At.join)(k.environment.assetsPath,"..","package.json"),"utf8"));r=`[${i.title}]...`,a=`https://raycast.com/${i.owner||i.author}/${i.name}`,(!i.owner||i.access==="public")&&(e=!1)}catch{}let n=k.environment.isDevelopment||e,s=t instanceof Error?t?.stack||t?.message||"":String(t);return{title:n?"Copy Logs":"Report Error",onAction(i){i.hide(),n?k.Clipboard.copy(s):(0,k.open)(`https://github.com/raycast/extensions/issues/new?&labels=extension%2Cbug&template=extension_bug_report.yml&title=${encodeURIComponent(r)}&extension-url=${encodeURI(a)}&description=${encodeURIComponent(`#### Error:
\`\`\`
${s}
\`\`\`
`)}`)}}};function Rs(t,e,r){let a=(0,w.useRef)(0),[n,s]=(0,w.useState)({isLoading:!0}),i=Y(t),o=Y(r?.abortable),l=Y(e||[]),d=Y(r?.onError),u=Y(r?.onData),m=Y(r?.onWillExecute),b=Y(r?.failureToastOptions),B=Y(n.data),H=(0,w.useRef)(null),y=(0,w.useRef)({page:0}),D=(0,w.useRef)(!1),U=(0,w.useRef)(!0),ie=(0,w.useRef)(50),N=(0,w.useCallback)(()=>(o.current&&(o.current.current?.abort(),o.current.current=new AbortController),++a.current),[o]),C=(0,w.useCallback)((...he)=>{let q=N();m.current?.(he),s(x=>({...x,isLoading:!0}));let Ee=Us(i.current)(...he);function Ie(x){return x.name=="AbortError"||q===a.current&&(d.current?d.current(x):k.environment.launchType!==k.LaunchType.Background&&Ls(x,{title:"Failed to fetch latest data",primaryAction:{title:"Retry",onAction(ke){ke.hide(),H.current?.(...l.current||[])}},...b.current}),s({error:x,isLoading:!1})),x}return typeof Ee=="function"?(D.current=!0,Ee(y.current).then(({data:x,hasMore:ke,cursor:on})=>(q===a.current&&(y.current&&(y.current.cursor=on,y.current.lastItem=x?.[x.length-1]),u.current&&u.current(x,y.current),ke&&(ie.current=x.length),U.current=ke,s(cn=>y.current.page===0?{data:x,isLoading:!1}:{data:(cn.data||[])?.concat(x),isLoading:!1})),x),x=>(U.current=!1,Ie(x)))):(D.current=!1,Ee.then(x=>(q===a.current&&(u.current&&u.current(x),s({data:x,isLoading:!1})),x),Ie))},[u,d,l,i,s,H,m,y,b,N]);H.current=C;let _=(0,w.useCallback)(()=>{y.current={page:0};let he=l.current||[];return C(...he)},[C,l]),E=(0,w.useCallback)(async(he,q)=>{let Ee;try{if(q?.optimisticUpdate){N(),typeof q?.rollbackOnError!="function"&&q?.rollbackOnError!==!1&&(Ee=structuredClone(B.current?.value));let Ie=q.optimisticUpdate;s(x=>({...x,data:Ie(x.data)}))}return await he}catch(Ie){if(typeof q?.rollbackOnError=="function"){let x=q.rollbackOnError;s(ke=>({...ke,data:x(ke.data)}))}else q?.optimisticUpdate&&q?.rollbackOnError!==!1&&s(x=>({...x,data:Ee}));throw Ie}finally{q?.shouldRevalidateAfter!==!1&&(k.environment.launchType===k.LaunchType.Background||k.environment.commandMode==="menu-bar"?await _():_())}},[_,B,s,N]),Q=(0,w.useCallback)(()=>{y.current.page+=1;let he=l.current||[];C(...he)},[y,l,C]);(0,w.useEffect)(()=>{y.current={page:0},r?.execute!==!1?C(...e||[]):N()},[Ms([e,r?.execute,C]),o,y]),(0,w.useEffect)(()=>()=>{N()},[N]);let Xe=r?.execute!==!1?n.isLoading:!1,de={...n,isLoading:Xe},sn=D.current?{pageSize:ie.current,hasMore:U.current,onLoadMore:Q}:void 0;return{...de,revalidate:_,mutate:E,pagination:sn}}function Us(t){return t===Promise.all||t===Promise.race||t===Promise.resolve||t===Promise.reject?t.bind(Promise):t}function va(t){return typeof t!="function"?!1:/^function\s+\w*\s*\(\s*\)\s*{\s+\[native code\]\s+}$/i.exec(Function.prototype.toString.call(t))!==null}function Os(t){return t instanceof URLSearchParams?t.toString():t}function Oa(t,e=[]){function r(a){return"update"in t?t.update(a,"utf8"):t.write(a)}return{dispatch:function(a){a=Os(a),a===null?this._null():this["_"+typeof a](a)},_object:function(a){let n=/\[object (.*)\]/i,s=Object.prototype.toString.call(a),i=n.exec(s)?.[1]??"unknown:["+s+"]";i=i.toLowerCase();let o=null;if((o=e.indexOf(a))>=0){this.dispatch("[CIRCULAR:"+o+"]");return}else e.push(a);if(Buffer.isBuffer(a))return r("buffer:"),r(a.toString("utf8"));if(i!=="object"&&i!=="function"&&i!=="asyncfunction")if(this["_"+i])this["_"+i](a);else throw new Error('Unknown object type "'+i+'"');else{let l=Object.keys(a);l=l.sort(),va(a)||l.splice(0,0,"prototype","__proto__","constructor"),r("object:"+l.length+":");let d=this;return l.forEach(function(u){d.dispatch(u),r(":"),d.dispatch(a[u]),r(",")})}},_array:function(a,n){n=typeof n<"u"?n:!1;let s=this;if(r("array:"+a.length+":"),!n||a.length<=1){a.forEach(function(l){s.dispatch(l)});return}let i=[],o=a.map(function(l){let d=Ns(),u=e.slice();return Oa(d,u).dispatch(l),i=i.concat(u.slice(e.length)),d.read().toString()});e=e.concat(i),o.sort(),this._array(o,!1)},_date:function(a){r("date:"+a.toJSON())},_symbol:function(a){r("symbol:"+a.toString())},_error:function(a){r("error:"+a.toString())},_boolean:function(a){r("bool:"+a.toString())},_string:function(a){r("string:"+a.length+":"),r(a.toString())},_function:function(a){r("fn:"),va(a)?this.dispatch("[native]"):this.dispatch(a.toString()),this.dispatch("function-name:"+String(a.name)),this._object(a)},_number:function(a){r("number:"+a.toString())},_xml:function(a){r("xml:"+a.toString())},_null:function(){r("Null")},_undefined:function(){r("Undefined")},_regexp:function(a){r("regex:"+a.toString())},_uint8array:function(a){r("uint8array:"),this.dispatch(Array.prototype.slice.call(a))},_uint8clampedarray:function(a){r("uint8clampedarray:"),this.dispatch(Array.prototype.slice.call(a))},_int8array:function(a){r("int8array:"),this.dispatch(Array.prototype.slice.call(a))},_uint16array:function(a){r("uint16array:"),this.dispatch(Array.prototype.slice.call(a))},_int16array:function(a){r("int16array:"),this.dispatch(Array.prototype.slice.call(a))},_uint32array:function(a){r("uint32array:"),this.dispatch(Array.prototype.slice.call(a))},_int32array:function(a){r("int32array:"),this.dispatch(Array.prototype.slice.call(a))},_float32array:function(a){r("float32array:"),this.dispatch(Array.prototype.slice.call(a))},_float64array:function(a){r("float64array:"),this.dispatch(Array.prototype.slice.call(a))},_arraybuffer:function(a){r("arraybuffer:"),this.dispatch(new Uint8Array(a))},_url:function(a){r("url:"+a.toString())},_map:function(a){r("map:");let n=Array.from(a);this._array(n,!0)},_set:function(a){r("set:");let n=Array.from(a);this._array(n,!0)},_file:function(a){r("file:"),this.dispatch([a.name,a.size,a.type,a.lastModified])},_blob:function(){throw Error(`Hashing Blob objects is currently not supported
(see https://github.com/puleos/object-hash/issues/26)
Use "options.replacer" or "options.ignoreUnknown"
`)},_domwindow:function(){r("domwindow")},_bigint:function(a){r("bigint:"+a.toString())},_process:function(){r("process")},_timer:function(){r("timer")},_pipe:function(){r("pipe")},_tcp:function(){r("tcp")},_udp:function(){r("udp")},_tty:function(){r("tty")},_statwatcher:function(){r("statwatcher")},_securecontext:function(){r("securecontext")},_connection:function(){r("connection")},_zlib:function(){r("zlib")},_context:function(){r("context")},_nodescript:function(){r("nodescript")},_httpparser:function(){r("httpparser")},_dataview:function(){r("dataview")},_signal:function(){r("signal")},_fsevent:function(){r("fsevent")},_tlswrap:function(){r("tlswrap")}}}function Ns(){return{buf:"",write:function(t){this.buf+=t},end:function(t){this.buf+=t},read:function(){return this.buf}}}function Vs(t,e){let r=this[t];return r instanceof Date?`__raycast_cached_date__${r.toISOString()}`:Buffer.isBuffer(r)?`__raycast_cached_buffer__${r.toString("base64")}`:e}function Bs(t,e){return typeof e=="string"&&e.startsWith("__raycast_cached_date__")?new Date(e.replace("__raycast_cached_date__","")):typeof e=="string"&&e.startsWith("__raycast_cached_buffer__")?Buffer.from(e.replace("__raycast_cached_buffer__",""),"base64"):e}function Pa(t){let e=Fa.default.createHash("sha1");return Oa(e).dispatch(t),e.digest("hex")}var js=Symbol("cache without namespace"),Aa=new Map;function yr(t,e,r){let a=r?.cacheNamespace||js,n=Aa.get(a)||Aa.set(a,new k.Cache({namespace:r?.cacheNamespace})).get(a);if(!n)throw new Error("Missing cache");let s=Y(t),i=Y(e),o=(0,w.useSyncExternalStore)(n.subscribe,()=>{try{return n.get(s.current)}catch(m){console.error("Could not get Cache data:",m);return}}),l=(0,w.useMemo)(()=>{if(typeof o<"u"){if(o==="undefined")return;try{return JSON.parse(o,Bs)}catch(m){return console.warn("The cached data is corrupted",m),i.current}}else return i.current},[o,i]),d=Y(l),u=(0,w.useCallback)(m=>{let b=typeof m=="function"?m(d.current):m;if(typeof b>"u")n.set(s.current,"undefined");else{let B=JSON.stringify(b,Vs);n.set(s.current,B)}return b},[n,s,d]);return[l,u]}var We=Symbol();function lt(t,e,r){let{initialData:a,keepPreviousData:n,internal_cacheKeySuffix:s,...i}=r||{},o=(0,w.useRef)(null),[l,d]=yr(Pa(e||[])+s,We,{cacheNamespace:Pa(t)}),u=(0,w.useRef)(l!==We?l:a),m=(0,w.useRef)(void 0),{mutate:b,revalidate:B,...H}=Rs(t,e||[],{...i,onData(N,C){m.current=C,i.onData&&i.onData(N,C),!(C&&C.page>0)&&(o.current="promise",u.current=N,d(N))}}),y,D=H.pagination;m.current&&m.current.page>0&&H.data?y=H.data:o.current==="promise"?y=u.current:n&&l!==We?(y=l,D&&(D.hasMore=!0,D.pageSize=l.length)):n&&l===We?y=u.current:l!==We?(y=l,D&&(D.hasMore=!0,D.pageSize=l.length)):y=a;let U=Y(y),ie=(0,w.useCallback)(async(N,C)=>{let _;try{if(C?.optimisticUpdate){typeof C?.rollbackOnError!="function"&&C?.rollbackOnError!==!1&&(_=structuredClone(U.current));let E=C.optimisticUpdate(U.current);o.current="cache",u.current=E,d(E)}return await b(N,{shouldRevalidateAfter:C?.shouldRevalidateAfter})}catch(E){if(typeof C?.rollbackOnError=="function"){let Q=C.rollbackOnError(U.current);o.current="cache",u.current=Q,d(Q)}else C?.optimisticUpdate&&C?.rollbackOnError!==!1&&(o.current="cache",u.current=_,d(_));throw E}},[d,b,U,u,o]);return(0,w.useEffect)(()=>{l!==We&&(o.current="cache",u.current=l)},[l]),{data:y,isLoading:H.isLoading,error:H.error,mutate:m.current&&m.current.page>0?b:ie,pagination:D,revalidate:B}}var Pt=t=>!!t&&typeof t=="object"&&typeof t.removeListener=="function"&&typeof t.emit=="function"&&typeof t.reallyExit=="function"&&typeof t.listeners=="function"&&typeof t.kill=="function"&&typeof t.pid=="number"&&typeof t.on=="function",dr=Symbol.for("signal-exit emitter"),mr=class{constructor(){if(this.emitted={afterExit:!1,exit:!1},this.listeners={afterExit:[],exit:[]},this.count=0,this.id=Math.random(),fr[dr])return fr[dr];Object.defineProperty(fr,dr,{value:this,writable:!1,enumerable:!1,configurable:!1})}on(e,r){this.listeners[e].push(r)}removeListener(e,r){let a=this.listeners[e],n=a.indexOf(r);n!==-1&&(n===0&&a.length===1?a.length=0:a.splice(n,1))}emit(e,r,a){if(this.emitted[e])return!1;this.emitted[e]=!0;let n=!1;for(let s of this.listeners[e])n=s(r,a)===!0||n;return e==="exit"&&(n=this.emit("afterExit",r,a)||n),n}},pr=class{onExit(){return()=>{}}load(){}unload(){}},gr=class{#o;#t;#e;#s;#i;#n;#a;#r;constructor(e){this.#o=process.platform==="win32"?"SIGINT":"SIGHUP",this.#t=new mr,this.#n={},this.#a=!1,this.#r=[],this.#r.push("SIGHUP","SIGINT","SIGTERM"),globalThis.process.platform!=="win32"&&this.#r.push("SIGALRM","SIGABRT","SIGVTALRM","SIGXCPU","SIGXFSZ","SIGUSR2","SIGTRAP","SIGSYS","SIGQUIT","SIGIOT"),globalThis.process.platform==="linux"&&this.#r.push("SIGIO","SIGPOLL","SIGPWR","SIGSTKFLT"),this.#e=e,this.#n={};for(let r of this.#r)this.#n[r]=()=>{let a=this.#e.listeners(r),{count:n}=this.#t,s=e;if(typeof s.__signal_exit_emitter__=="object"&&typeof s.__signal_exit_emitter__.count=="number"&&(n+=s.__signal_exit_emitter__.count),a.length===n){this.unload();let i=this.#t.emit("exit",null,r),o=r==="SIGHUP"?this.#o:r;i||e.kill(e.pid,o)}};this.#i=e.reallyExit,this.#s=e.emit}onExit(e,r){if(!Pt(this.#e))return()=>{};this.#a===!1&&this.load();let a=r?.alwaysLast?"afterExit":"exit";return this.#t.on(a,e),()=>{this.#t.removeListener(a,e),this.#t.listeners.exit.length===0&&this.#t.listeners.afterExit.length===0&&this.unload()}}load(){if(!this.#a){this.#a=!0,this.#t.count+=1;for(let e of this.#r)try{let r=this.#n[e];r&&this.#e.on(e,r)}catch{}this.#e.emit=(e,...r)=>this.#l(e,...r),this.#e.reallyExit=e=>this.#c(e)}}unload(){this.#a&&(this.#a=!1,this.#r.forEach(e=>{let r=this.#n[e];if(!r)throw new Error("Listener not defined for signal: "+e);try{this.#e.removeListener(e,r)}catch{}}),this.#e.emit=this.#s,this.#e.reallyExit=this.#i,this.#t.count-=1)}#c(e){return Pt(this.#e)?(this.#e.exitCode=e||0,this.#t.emit("exit",this.#e.exitCode,null),this.#i.call(this.#e,this.#e.exitCode)):0}#l(e,...r){let a=this.#s;if(e==="exit"&&Pt(this.#e)){typeof r[0]=="number"&&(this.#e.exitCode=r[0]);let n=a.call(this.#e,e,...r);return this.#t.emit("exit",this.#e.exitCode,null),n}else return a.call(this.#e,e,...r)}},hr=null,Ws=(t,e)=>(hr||(hr=Pt(process)?new gr(process):new pr),hr.onExit(t,e));function zs(t,{timeout:e}={}){let r=new Promise((o,l)=>{t.on("exit",(d,u)=>{o({exitCode:d,signal:u,timedOut:!1})}),t.on("error",d=>{l(d)}),t.stdin&&t.stdin.on("error",d=>{l(d)})}),a=Ws(()=>{t.kill()});if(e===0||e===void 0)return r.finally(()=>a());let n,s=new Promise((o,l)=>{n=setTimeout(()=>{t.kill("SIGTERM"),l(Object.assign(new Error("Timed out"),{timedOut:!0,signal:"SIGTERM"}))},e)}),i=r.finally(()=>{clearTimeout(n)});return Promise.race([s,i]).finally(()=>a())}var br=class extends Error{constructor(){super("The output is too big"),this.name="MaxBufferError"}};function Hs(t){let{encoding:e}=t,r=e==="buffer",a=new ze.default.PassThrough({objectMode:!1});e&&e!=="buffer"&&a.setEncoding(e);let n=0,s=[];return a.on("data",i=>{s.push(i),n+=i.length}),a.getBufferedValue=()=>r?Buffer.concat(s,n):s.join(""),a.getBufferedLength=()=>n,a}async function Ea(t,e){let r=Hs(e);return await new Promise((a,n)=>{let s=i=>{i&&r.getBufferedLength()<=La.constants.MAX_LENGTH&&(i.bufferedData=r.getBufferedValue()),n(i)};(async()=>{try{await(0,Ra.promisify)(ze.default.pipeline)(t,r),a()}catch(i){s(i)}})(),r.on("data",()=>{r.getBufferedLength()>8e7&&s(new br)})}),r.getBufferedValue()}async function Ia(t,e){t.destroy();try{return await e}catch(r){return r.bufferedData}}async function Ks({stdout:t,stderr:e},{encoding:r},a){let n=Ea(t,{encoding:r}),s=Ea(e,{encoding:r});try{return await Promise.all([a,n,s])}catch(i){return Promise.all([{error:i,exitCode:null,signal:i.signal,timedOut:i.timedOut||!1},Ia(t,n),Ia(e,s)])}}function qs(t){let e=typeof t=="string"?`
`:10,r=typeof t=="string"?"\r":13;return t[t.length-1]===e&&(t=t.slice(0,-1)),t[t.length-1]===r&&(t=t.slice(0,-1)),t}function Ta(t,e){return t.stripFinalNewline?qs(e):e}function Gs({timedOut:t,timeout:e,signal:r,exitCode:a}){return t?`timed out after ${e} milliseconds`:r!=null?`was killed with ${r}`:a!=null?`failed with exit code ${a}`:"failed"}function Js({stdout:t,stderr:e,error:r,signal:a,exitCode:n,command:s,timedOut:i,options:o,parentError:l}){let u=`Command ${Gs({timedOut:i,timeout:o?.timeout,signal:a,exitCode:n})}: ${s}`,m=r?`${u}
${r.message}`:u,b=[m,e,t].filter(Boolean).join(`
`);return r?r.originalMessage=r.message:r=l,r.message=b,r.shortMessage=m,r.command=s,r.exitCode=n,r.signal=a,r.stdout=t,r.stderr=e,"bufferedData"in r&&delete r.bufferedData,r}function Zs({stdout:t,stderr:e,error:r,exitCode:a,signal:n,timedOut:s,command:i,options:o,parentError:l}){if(r||a!==0||n!==null)throw Js({error:r,exitCode:a,signal:n,stdout:t,stderr:e,command:i,timedOut:s,options:o,parentError:l});return t}function Da(t,e,r,a){let n=(a-90)*Math.PI/180;return{x:t+r*Math.cos(n),y:e+r*Math.sin(n)}}function Ys(t,e,r,a,n){let s=Da(t,e,r,n),i=Da(t,e,r,a),o=n-a<=180?"0":"1";return["M",s.x,s.y,"A",r,r,0,o,0,i.x,i.y].join(" ")}function Na(t,e=k.Color.Red,r){let a=r?.background||(k.environment.appearance==="light"?"black":"white"),n=r?.backgroundOpacity||.1,s=10,o=50-5-s/2,l=`<svg xmlns="http://www.w3.org/2000/svg" width="100px" height="100px">
      <circle cx="50" cy="50" r="${o}" stroke-width="${s}" stroke="${t<1?a:e}" opacity="${t<1?n:"1"}" fill="none" />
      ${t>0&&t<1?`<path d="${Ys(50,50,o,0,t*360)}" stroke="${e}" stroke-width="${s}" fill="none" />`:""}
    </svg>
  `.replaceAll(`
`,"");return`data:image/svg+xml,${encodeURIComponent(l)}`}async function Va(t,e,r){if(process.platform!=="darwin")throw new Error("AppleScript is only supported on macOS");let{humanReadableOutput:a,language:n,timeout:s,...i}=Array.isArray(e)?r||{}:e||{},o=a!==!1?[]:["-ss"];n==="JavaScript"&&o.push("-l","JavaScript"),Array.isArray(e)&&o.push("-",...e);let l=Ma.default.spawn("osascript",o,{...i,env:{PATH:"/usr/local/bin:/usr/bin:/bin:/usr/sbin:/sbin"}}),d=zs(l,{timeout:s??1e4});l.stdin.end(t);let[{error:u,exitCode:m,signal:b,timedOut:B},H,y]=await Ks(l,{encoding:"utf8"},d),D=Ta({stripFinalNewline:!0},H),U=Ta({stripFinalNewline:!0},y);return Zs({stdout:D,stderr:U,error:u,exitCode:m,signal:b,timedOut:B,command:"osascript",options:r,parentError:new Error})}var f=require("@raycast/api");var ut=require("@raycast/api");var we={alacritty:"Alacritty",ghostty:"Ghostty",hyper:"Hyper",iterm:"iTerm",kitty:"kitty",terminal:"Terminal",warp:"Warp",wezterm:"WezTerm"},Ba={alacritty:{fileIcon:"/Applications/Alacritty.app"},ghostty:{fileIcon:"/Applications/Ghostty.app"},hyper:{fileIcon:"/Applications/Hyper.app"},iterm:{fileIcon:"/Applications/iTerm.app"},kitty:{fileIcon:"/Applications/kitty.app"},terminal:{fileIcon:"/System/Applications/Utilities/Terminal.app"},warp:{fileIcon:"/Applications/Warp.app"},wezterm:{fileIcon:"/Applications/WezTerm.app"}},Xs={alacritty:"org.alacritty",ghostty:"com.mitchellh.ghostty",hyper:"co.zeit.hyper",iterm:"com.googlecode.iterm2",kitty:"org.kovidgoyal.kitty",terminal:"com.apple.terminal",warp:"dev.warp.Warp-Stable",wezterm:"com.github.wez.wezterm"},He=(t,e)=>`
    tell application "${e}" to activate
    tell application "System Events" to tell process "${e}"
        keystroke "t" using command down
        delay 0.5
        keystroke "${t}"
        keystroke return
    end tell
  `,ja={alacritty:t=>He(t,we.alacritty),ghostty:t=>He(t,we.ghostty),hyper:t=>He(t,we.hyper),iterm:t=>`
    tell application "iTerm"
      set newWindow to create window with default profile command "bash -c '${t}; read -n 1 -s -r -p \\"Press any key to exit - will not quit\\" ; echo' ; exit"
    end tell
    `,kitty:t=>He(t,we.kitty),terminal:t=>`
    tell application "Terminal"
      do shell script "open -a 'Terminal'"
      do script "echo ; ${t} ; bash -c 'read -n 1 -s -r -p \\"Press any key to exit - will not quit\\"' ; exit" in selected tab of the front window
    end tell
  `,warp:t=>He(t,we.warp),wezterm:t=>He(t,we.wezterm)},Et=()=>{let{data:t}=lt(async e=>(await(0,ut.getApplications)()).some(a=>a.bundleId?.toLowerCase()===Xs[e].toLowerCase()),[$.terminalApp],{failureToastOptions:{title:"Failed to check if Terminal App is installed"}});return{terminalIcon:t?Ba[$.terminalApp]:Ba.terminal,terminalName:t?we[$.terminalApp]:we.terminal,runCommandInTerminal:async e=>{await(0,ut.closeMainWindow)(),await new Promise(a=>setTimeout(a,400));let r=t?ja[$.terminalApp](e):ja.terminal(e);await Va(r),await(0,ut.closeMainWindow)()}}};var S=require("@raycast/api");var It=()=>yr("exclude-dependencies",!1);var Ke=require("react/jsx-runtime");function wr(t){return(0,Ke.jsx)(S.Action,{title:"Install",icon:S.Icon.Plus,shortcut:{modifiers:["cmd"],key:"i"},onAction:async()=>{t.onAction(await Qs(t.formula))}})}function kr(t){return(0,Ke.jsx)(S.Action,{title:"Uninstall",icon:S.Icon.Trash,shortcut:S.Keyboard.Shortcut.Common.Remove,style:S.Action.Style.Destructive,onAction:async()=>{let e=await ei(t.formula);t.onAction(e)}})}function _r(t){return(0,Ke.jsx)(S.Action,{title:"Upgrade",icon:S.Icon.Hammer,shortcut:{modifiers:["cmd","shift"],key:"u"},onAction:async()=>{let e=await ti(t.formula);t.onAction(e)}})}function Wa(t){let e=t.formula.pinned;return(0,Ke.jsx)(S.Action,{title:e?"Unpin":"Pin",icon:S.Icon.Pin,shortcut:S.Keyboard.Shortcut.Common.Pin,onAction:async()=>{e?t.onAction(await ai(t.formula)):t.onAction(await ri(t.formula))}})}function za(t){let[e,r]=It();return(0,Ke.jsx)(S.Action,{title:e?"Show Dependencies":"Hide Dependencies",icon:e?S.Icon.Eye:S.Icon.EyeDisabled,shortcut:{modifiers:["cmd"],key:"d"},onAction:()=>{let a=ni(e,r);t.onAction(a)}})}async function Qs(t){let e=T(t),r=at({title:`Installing ${e}`,message:"",cancelable:!0});try{return await ir(t,a=>{r.updateMessage(a.message)},r.abort?.signal),await r.showSuccessHUD(`Installed ${e}`),!0}catch(a){let n=J(a);return await r.showFailureHUD(`Failed to install ${e}`),Ce("Install failed",n),!1}}async function ei(t){let e=T(t),r=at({title:`Uninstalling ${e}`,message:"",cancelable:!0});try{return await or(t,r.abort?.signal),await r.showSuccessHUD(`Uninstalled ${e}`),!0}catch(a){let n=J(a);return await r.showFailureHUD(`Failed to uninstall ${e}`),Ce("Uninstall failed",n),!1}}async function ti(t){let e=T(t),r=at({title:`Upgrading ${e}`,message:"",cancelable:!0});try{return await cr(t,a=>{r.updateMessage(a.message)},r.abort?.signal),await r.showSuccessHUD(`Upgraded ${e}`),!0}catch(a){let n=J(a);return await r.showFailureHUD(`Failed to upgrade ${e}`),Ce("Upgrade failed",n),!1}}async function ri(t){(0,S.showToast)(S.Toast.Style.Animated,`Pinning ${T(t)}`);try{return await lr(t),t.pinned=!0,(0,S.showToast)(S.Toast.Style.Success,`Pinned ${T(t)}`),!0}catch(e){return Ce("Pin formula failed",J(e)),!1}}async function ai(t){(0,S.showToast)(S.Toast.Style.Animated,`Unpinning ${T(t)}`);try{return await ur(t),t.pinned=!1,(0,S.showToast)(S.Toast.Style.Success,`Unpinned ${T(t)}`),!0}catch(e){return Ce("Unpin formula failed",J(e)),!1}}function ni(t,e){return e(!t),!0}var Je=require("react"),M=require("@raycast/api");var qe=require("@raycast/api"),xr=require("react/jsx-runtime");function Ge({title:t,dependencies:e,isInstalled:r}){return!e||e.length===0?null:(0,xr.jsx)(qe.Detail.Metadata.TagList,{title:t,children:e.map(a=>(0,xr.jsx)(qe.Detail.Metadata.TagList.Item,{text:a,color:r(a)?qe.Color.Green:qe.Color.SecondaryText},a))})}var W=require("react/jsx-runtime");function Ha(t){return!t.homepage||!t.tap||!t.desc}function $r({cask:t,isInstalled:e,onAction:r}){let{pop:a}=(0,M.useNavigation)(),[n,s]=(0,Je.useState)(t),[i,o]=(0,Je.useState)(!1);return(0,Je.useEffect)(()=>{O.log("Viewing cask info",{token:t.token,name:T(t),hasMinimalData:Ha(t),installed:t.installed,version:t.version})},[t]),(0,Je.useEffect)(()=>{if(!Ha(t))return;(async()=>{o(!0);let d=await(0,M.showToast)({style:M.Toast.Style.Animated,title:`Loading ${T(t)} info...`}),u=new AbortController,m=setTimeout(()=>u.abort(),1e4);try{let b=await it(t.token,u.signal);clearTimeout(m),b?(t.installed&&(b.installed=t.installed),s(b),O.log("Cask info loaded",{token:b.token,name:T(b),desc:b.desc?.substring(0,50)}),d.hide()):(d.style=M.Toast.Style.Failure,d.title="Failed to load cask info")}catch(b){clearTimeout(m);let B=J(b).name==="AbortError";O.error("Failed to load cask info",{token:t.token,error:b,timeout:B}),d.style=M.Toast.Style.Failure,d.title=B?"Cask info load timed out":"Failed to load cask info"}finally{o(!1)}})()},[t]),(0,W.jsx)(M.Detail,{isLoading:i,markdown:ci(n),navigationTitle:`Cask Info: ${T(n)}`,metadata:(0,W.jsxs)(M.Detail.Metadata,{children:[n.homepage?(0,W.jsx)(M.Detail.Metadata.Link,{title:"Homepage",text:n.homepage,target:n.homepage}):(0,W.jsx)(M.Detail.Metadata.Label,{title:"Homepage",text:"Loading..."}),(0,W.jsx)(M.Detail.Metadata.Label,{title:"Tap",text:n.tap||"Loading..."}),(0,W.jsx)(oi,{cask:n}),(0,W.jsx)(ii,{cask:n}),(0,W.jsx)(Ge,{title:"Conflicts With",dependencies:n.conflicts_with?.cask,isInstalled:e}),(0,W.jsx)(M.Detail.Metadata.Label,{title:"Auto Updates",text:n.auto_updates?"Yes":"No"})]}),actions:(0,W.jsx)(Tt,{cask:n,showDetails:!1,isInstalled:e,onAction:l=>{a(),r(l)}})})}function ii({cask:t}){let e=t.depends_on?.macos;return e?(0,W.jsx)(M.Detail.Metadata.TagList,{title:"macOS Version",children:Object.keys(e).map(r=>{let a=e[r];return a?(0,W.jsx)(M.Detail.Metadata.TagList.Item,{text:`${r} ${a.join(", ")}`},r):null})}):null}function oi({cask:t}){let e=t.installed?`${t.installed} (installed)`:t.version;return e?(0,W.jsx)(M.Detail.Metadata.Label,{title:"Version",text:e}):null}function ci(t){return`
# ${T(t)}
${t.desc}

${li(t)}
  `}function li(t){return t.caveats?`#### Caveats
${t.caveats}
    `:""}var Ze=require("react"),L=require("@raycast/api");var z=require("react/jsx-runtime");function Ka(t){return!t.homepage||!t.tap||!t.desc}function Sr(t){let{pop:e}=(0,L.useNavigation)(),[r,a]=(0,Ze.useState)(t.formula),[n,s]=(0,Ze.useState)(!1);return(0,Ze.useEffect)(()=>{O.log("Viewing formula info",{name:t.formula.name,hasMinimalData:Ka(t.formula),installed:t.formula.installed?.length>0,version:t.formula.versions.stable})},[t.formula]),(0,Ze.useEffect)(()=>{if(!Ka(t.formula))return;(async()=>{s(!0);let o=await(0,L.showToast)({style:L.Toast.Style.Animated,title:`Loading ${t.formula.name} info...`}),l=new AbortController,d=setTimeout(()=>l.abort(),1e4);try{let u=await st(t.formula.name,l.signal);clearTimeout(d),u?(t.formula.installed?.length>0&&(u.installed=t.formula.installed),a(u),O.log("Formula info loaded",{name:u.name,desc:u.desc?.substring(0,50),dependencies:u.dependencies?.length??0}),o.hide()):(o.style=L.Toast.Style.Failure,o.title="Failed to load formula info")}catch(u){clearTimeout(d);let m=J(u).name==="AbortError";O.error("Failed to load formula info",{name:t.formula.name,error:u,timeout:m}),o.style=L.Toast.Style.Failure,o.title=m?"Formula info load timed out":"Failed to load formula info"}finally{s(!1)}})()},[t.formula]),(0,z.jsx)(L.Detail,{isLoading:n,markdown:ui(r),metadata:(0,z.jsxs)(L.Detail.Metadata,{children:[r.homepage?(0,z.jsx)(L.Detail.Metadata.Link,{title:"Homepage",text:r.homepage,target:r.homepage}):(0,z.jsx)(L.Detail.Metadata.Label,{title:"Homepage",text:"Loading..."}),r.license&&(0,z.jsx)(L.Detail.Metadata.Label,{title:"License",text:r.license}),(0,z.jsx)(L.Detail.Metadata.Label,{title:"Versions",text:fi(r)}),r.versions.head&&(0,z.jsx)(L.Detail.Metadata.Label,{title:"",text:r.versions.head}),(0,z.jsx)(Ge,{title:"Dependencies",dependencies:r.dependencies,isInstalled:t.isInstalled}),(0,z.jsx)(Ge,{title:"Build Dependencies",dependencies:r.build_dependencies,isInstalled:t.isInstalled}),(0,z.jsx)(Ge,{title:"Conflicts With",dependencies:r.conflicts_with,isInstalled:t.isInstalled}),r.pinned&&(0,z.jsx)(L.Detail.Metadata.Label,{title:"Pinned",text:"Yes"}),r.keg_only&&(0,z.jsx)(L.Detail.Metadata.Label,{title:"Keg Only",text:"Yes"})]}),actions:(0,z.jsx)(Dt,{formula:r,showDetails:!1,isInstalled:t.isInstalled,onAction:i=>{e(),t.onAction(i)}})})}function ui(t){return`
# ${t.name}
${t.desc}

${di(t)}
  `}function fi(t){let e=t.versions,r=[];return e.bottle&&r.push("bottled"),X(t)&&r.push("installed"),t.installed.first()?.installed_as_dependency&&r.push("dependency"),`${e.stable} ${r?`(${r.join(", ")})`:""}`}function di(t){let e="";return t.keg_only&&(e+=`
${t.name} is keg-only, which means it is not symlinked into ${Re}.
    `),t.caveats&&(e+=`
${t.caveats}
    `),e?`#### Caveats
${e}
    `:""}var c=require("react/jsx-runtime"),Cr=t=>(0,c.jsx)(f.ActionPanel.Section,{children:(0,c.jsx)(f.Action.Push,{target:(0,c.jsx)(f.Detail,{navigationTitle:"Debug Info",markdown:"```json\n"+JSON.stringify(t.obj,null,2)+"\n```",actions:(0,c.jsx)(f.ActionPanel,{children:(0,c.jsx)(f.Action.CopyToClipboard,{title:"Copy JSON",content:JSON.stringify(t.obj,null,2)})})}),title:"Debug",icon:f.Icon.MagnifyingGlass})});function Tt(t){let{cask:e}=t,{terminalName:r,terminalIcon:a,runCommandInTerminal:n}=Et();function s(){return(0,c.jsxs)(f.ActionPanel,{children:[(0,c.jsxs)(f.ActionPanel.Section,{children:[t.showDetails&&(0,c.jsx)(f.Action.Push,{title:"Show Details",icon:f.Icon.Document,target:(0,c.jsx)($r,{cask:e,isInstalled:t.isInstalled,onAction:t.onAction})}),e.outdated&&(0,c.jsx)(_r,{formula:e,onAction:t.onAction}),(0,c.jsx)(f.Action.ShowInFinder,{path:$t(e)})]}),(0,c.jsxs)(f.ActionPanel.Section,{children:[(0,c.jsx)(f.Action.OpenInBrowser,{title:"Open Cask",url:`https://formulae.brew.sh/cask/${e.token}`}),(0,c.jsx)(f.Action.CopyToClipboard,{title:"Copy Cask URL",content:`https://formulae.brew.sh/cask/${e.token}`})]}),(0,c.jsxs)(f.ActionPanel.Section,{children:[(0,c.jsx)(f.Action.OpenInBrowser,{title:"Open Homepage",url:e.homepage}),(0,c.jsx)(f.Action.CopyToClipboard,{title:"Copy Homepage URL",content:e.homepage})]}),(0,c.jsxs)(f.ActionPanel.Section,{children:[(0,c.jsx)(kr,{formula:e,onAction:t.onAction}),(0,c.jsx)(f.Action.CopyToClipboard,{title:"Copy Uninstall Command",content:Ve(e),shortcut:{modifiers:["cmd","opt"],key:"c"}}),(0,c.jsx)(f.Action,{title:`Run Uninstall in ${r}`,icon:a,style:f.Action.Style.Destructive,onAction:()=>n(Ve(e))})]}),(0,c.jsxs)(f.ActionPanel.Section,{children:[(0,c.jsx)(f.Action.CopyToClipboard,{title:"Copy Cask Name",content:e.token,shortcut:{modifiers:["cmd","shift"],key:"c"}}),(0,c.jsx)(f.Action.CopyToClipboard,{title:"Copy Tap Name",content:e.tap})]}),(0,c.jsx)(Cr,{obj:e})]})}function i(){return(0,c.jsxs)(f.ActionPanel,{children:[(0,c.jsxs)(f.ActionPanel.Section,{children:[t.showDetails&&(0,c.jsx)(f.Action.Push,{title:"Show Details",icon:f.Icon.Document,target:(0,c.jsx)($r,{cask:e,isInstalled:t.isInstalled,onAction:t.onAction})}),(0,c.jsx)(wr,{formula:e,onAction:t.onAction})]}),(0,c.jsxs)(f.ActionPanel.Section,{children:[(0,c.jsx)(f.Action.CopyToClipboard,{title:"Copy Tap Name",content:e.tap}),(0,c.jsx)(f.Action.CopyToClipboard,{title:"Copy Cask Name",content:e.token,shortcut:{modifiers:["cmd","shift"],key:"c"}}),(0,c.jsx)(f.Action.CopyToClipboard,{title:"Copy Install Command",content:Ne(e),shortcut:{modifiers:["cmd","opt"],key:"c"}}),(0,c.jsx)(f.Action,{title:`Run Install in ${r}`,icon:a,onAction:()=>n(Ne(e))})]}),(0,c.jsxs)(f.ActionPanel.Section,{children:[(0,c.jsx)(f.Action.OpenInBrowser,{title:"Open Cask",url:`https://formulae.brew.sh/cask/${e.token}`}),(0,c.jsx)(f.Action.CopyToClipboard,{title:"Copy Cask URL",content:`https://formulae.brew.sh/cask/${e.token}`})]}),(0,c.jsxs)(f.ActionPanel.Section,{children:[(0,c.jsx)(f.Action.OpenInBrowser,{title:"Open Homepage",url:e.homepage}),(0,c.jsx)(f.Action.CopyToClipboard,{title:"Copy Homepage URL",content:e.homepage})]})]})}return X(t.cask)?s():i()}function Dt(t){let{formula:e}=t,{terminalName:r,terminalIcon:a,runCommandInTerminal:n}=Et();function s(){return(0,c.jsxs)(f.ActionPanel,{children:[(0,c.jsxs)(f.ActionPanel.Section,{children:[t.showDetails&&(0,c.jsx)(f.Action.Push,{title:"Show Details",icon:f.Icon.Document,target:(0,c.jsx)(Sr,{formula:e,isInstalled:t.isInstalled,onAction:t.onAction})}),e.outdated&&(0,c.jsx)(_r,{formula:e,onAction:t.onAction}),(0,c.jsx)(f.Action.ShowInFinder,{path:$t(e)}),(0,c.jsx)(Wa,{formula:e,onAction:t.onAction}),(0,c.jsx)(za,{onAction:t.onAction})]}),(0,c.jsxs)(f.ActionPanel.Section,{children:[(0,c.jsx)(f.Action.OpenInBrowser,{title:"Open Formula",url:`https://formulae.brew.sh/formula/${e.name}`}),(0,c.jsx)(f.Action.CopyToClipboard,{title:"Copy Formula URL",content:`https://formulae.brew.sh/formula/${e.name}`})]}),(0,c.jsxs)(f.ActionPanel.Section,{children:[(0,c.jsx)(f.Action.OpenInBrowser,{title:"Open Homepage",url:e.homepage}),(0,c.jsx)(f.Action.CopyToClipboard,{title:"Copy Homepage URL",content:e.homepage})]}),(0,c.jsxs)(f.ActionPanel.Section,{children:[(0,c.jsx)(kr,{formula:e,onAction:t.onAction}),(0,c.jsx)(f.Action.CopyToClipboard,{title:"Copy Uninstall Command",content:Ve(e),shortcut:{modifiers:["cmd","opt"],key:"c"}}),(0,c.jsx)(f.Action,{title:`Run Uninstall in ${r}`,style:f.Action.Style.Destructive,icon:a,onAction:()=>n(Ve(e))})]}),(0,c.jsx)(Cr,{obj:e})]})}function i(){return(0,c.jsxs)(f.ActionPanel,{children:[(0,c.jsxs)(f.ActionPanel.Section,{children:[t.showDetails&&(0,c.jsx)(f.Action.Push,{title:"Show Details",icon:f.Icon.Document,target:(0,c.jsx)(Sr,{formula:e,isInstalled:t.isInstalled,onAction:t.onAction})}),(0,c.jsx)(wr,{formula:e,onAction:t.onAction})]}),(0,c.jsxs)(f.ActionPanel.Section,{children:[(0,c.jsx)(f.Action.CopyToClipboard,{title:"Copy Formula Name",content:e.name,shortcut:{modifiers:["cmd","shift"],key:"c"}}),(0,c.jsx)(f.Action.CopyToClipboard,{title:"Copy Install Command",content:Ne(e),shortcut:{modifiers:["cmd","opt"],key:"c"}}),(0,c.jsx)(f.Action,{title:`Run Install in ${r}`,icon:a,onAction:()=>n(Ne(e))})]}),(0,c.jsxs)(f.ActionPanel.Section,{children:[(0,c.jsx)(f.Action.OpenInBrowser,{title:"Open Formula",url:`https://formulae.brew.sh/formula/${e.name}`}),(0,c.jsx)(f.Action.CopyToClipboard,{title:"Copy Formula URL",content:`https://formulae.brew.sh/formula/${e.name}`})]}),(0,c.jsxs)(f.ActionPanel.Section,{children:[(0,c.jsx)(f.Action.OpenInBrowser,{title:"Open Homepage",url:e.homepage}),(0,c.jsx)(f.Action.CopyToClipboard,{title:"Copy Homepage URL",content:e.homepage})]}),(0,c.jsx)(Cr,{obj:e})]})}return X(t.formula)?s():i()}var se=require("react"),g=require("@raycast/api");var h=require("react/jsx-runtime");function hi(t){return!t.homepage||!t.tap||!t.desc}function mi(t){return!t.homepage||!t.tap||!t.desc}function qa({formula:t,isInstalled:e}){let[r,a]=(0,se.useState)(t),[n,s]=(0,se.useState)(!1);return(0,se.useEffect)(()=>{a(t)},[t]),(0,se.useEffect)(()=>{if(!hi(t))return;let i=!1,o=new AbortController,l=async()=>{s(!0);try{let u=await st(t.name,o.signal);!i&&u&&(t.installed?.length>0&&(u.installed=t.installed),a(u))}catch{}finally{i||s(!1)}},d=setTimeout(()=>o.abort(),1e4);return l(),()=>{i=!0,clearTimeout(d),o.abort()}},[t]),(0,h.jsx)(g.List.Item.Detail,{isLoading:n,markdown:bi(r),metadata:(0,h.jsxs)(g.List.Item.Detail.Metadata,{children:[r.homepage?(0,h.jsx)(g.List.Item.Detail.Metadata.Link,{title:"Homepage",text:r.homepage,target:r.homepage}):(0,h.jsx)(g.List.Item.Detail.Metadata.Label,{title:"Homepage",text:"\u2014"}),(0,h.jsx)(g.List.Item.Detail.Metadata.Separator,{}),r.license&&(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)(g.List.Item.Detail.Metadata.Label,{title:"License",text:r.license}),(0,h.jsx)(g.List.Item.Detail.Metadata.Separator,{})]}),(0,h.jsx)(g.List.Item.Detail.Metadata.Label,{title:"Version",text:wi(r)}),r.versions.head&&(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)(g.List.Item.Detail.Metadata.Separator,{}),(0,h.jsx)(g.List.Item.Detail.Metadata.Label,{title:"Head",text:r.versions.head})]}),(0,h.jsx)(Ft,{title:"Dependencies",dependencies:r.dependencies,isInstalled:e}),(0,h.jsx)(Ft,{title:"Build Dependencies",dependencies:r.build_dependencies,isInstalled:e}),(0,h.jsx)(Ft,{title:"Conflicts With",dependencies:r.conflicts_with,isInstalled:e}),r.pinned&&(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)(g.List.Item.Detail.Metadata.Separator,{}),(0,h.jsx)(g.List.Item.Detail.Metadata.Label,{title:"Pinned",text:"Yes"})]}),r.keg_only&&(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)(g.List.Item.Detail.Metadata.Separator,{}),(0,h.jsx)(g.List.Item.Detail.Metadata.Label,{title:"Keg Only",text:"Yes"})]})]})})}function Ga({cask:t,isInstalled:e}){let[r,a]=(0,se.useState)(t),[n,s]=(0,se.useState)(!1);return(0,se.useEffect)(()=>{a(t)},[t]),(0,se.useEffect)(()=>{if(!mi(t))return;let i=!1,o=new AbortController,l=async()=>{s(!0);try{let u=await it(t.token,o.signal);!i&&u&&(t.installed&&(u.installed=t.installed),a(u))}catch{}finally{i||s(!1)}},d=setTimeout(()=>o.abort(),1e4);return l(),()=>{i=!0,clearTimeout(d),o.abort()}},[t]),(0,h.jsx)(g.List.Item.Detail,{isLoading:n,markdown:yi(r),metadata:(0,h.jsxs)(g.List.Item.Detail.Metadata,{children:[r.homepage?(0,h.jsx)(g.List.Item.Detail.Metadata.Link,{title:"Homepage",text:r.homepage,target:r.homepage}):(0,h.jsx)(g.List.Item.Detail.Metadata.Label,{title:"Homepage",text:"\u2014"}),(0,h.jsx)(g.List.Item.Detail.Metadata.Separator,{}),(0,h.jsx)(g.List.Item.Detail.Metadata.Label,{title:"Tap",text:r.tap||"\u2014"}),(0,h.jsx)(g.List.Item.Detail.Metadata.Separator,{}),(0,h.jsx)(gi,{cask:r}),(0,h.jsx)(pi,{cask:r}),(0,h.jsx)(Ft,{title:"Conflicts With",dependencies:r.conflicts_with?.cask,isInstalled:e}),(0,h.jsx)(g.List.Item.Detail.Metadata.Separator,{}),(0,h.jsx)(g.List.Item.Detail.Metadata.Label,{title:"Auto Updates",text:r.auto_updates?"Yes":"No"})]})})}function Ft({title:t,dependencies:e,isInstalled:r}){return!e||e.length===0?null:(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)(g.List.Item.Detail.Metadata.Separator,{}),(0,h.jsx)(g.List.Item.Detail.Metadata.TagList,{title:t,children:e.map(a=>(0,h.jsx)(g.List.Item.Detail.Metadata.TagList.Item,{text:a,color:r(a)?g.Color.Green:g.Color.SecondaryText},a))})]})}function pi({cask:t}){let e=t.depends_on?.macos;return e?(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)(g.List.Item.Detail.Metadata.Separator,{}),(0,h.jsx)(g.List.Item.Detail.Metadata.TagList,{title:"macOS Version",children:Object.keys(e).map(r=>{let a=e[r];return a?(0,h.jsx)(g.List.Item.Detail.Metadata.TagList.Item,{text:`${r} ${a.join(", ")}`},r):null})})]}):null}function gi({cask:t}){let e=t.installed?`${t.installed} (installed)`:t.version;return e?(0,h.jsx)(g.List.Item.Detail.Metadata.Label,{title:"Version",text:e}):null}function bi(t){return`# ${t.name}
${t.desc||""}

${ki(t)}`}function yi(t){return`# ${T(t)}
${t.desc||""}

${_i(t)}`}function wi(t){let e=t.versions,r=[];return e.bottle&&r.push("bottled"),X(t)&&r.push("installed"),t.installed.first()?.installed_as_dependency&&r.push("dependency"),`${e.stable} ${r.length>0?`(${r.join(", ")})`:""}`}function ki(t){let e="";return t.keg_only&&(e+=`${t.name} is keg-only, which means it is not symlinked into ${Re}.
`),t.caveats&&(e+=`${t.caveats}
`),e?`#### Caveats
${e}`:""}function _i(t){return t.caveats?`#### Caveats
${t.caveats}`:""}var R=require("react/jsx-runtime"),Za={light:"#00000066",dark:"#FFFFFF66"};function Ya(t){let e=t.formulae,r=t.casks,a=e.length>0||r.length>0,n=t.showMetadataPanel??!1;return(0,R.jsxs)(A.List,{searchBarPlaceholder:t.searchBarPlaceholder,searchBarAccessory:t.searchBarAccessory,onSearchTextChange:t.onSearchTextChange,isLoading:t.isLoading,filtering:t.filtering??!0,isShowingDetail:n,throttle:!0,children:[!a&&(t.isLoading||!t.dataFetched)&&(0,R.jsx)(A.List.EmptyView,{icon:Na(.5),title:"Loading Packages",description:"Fetching casks and formulae from Homebrew..."}),!a&&!t.isLoading&&t.dataFetched&&(0,R.jsx)(A.List.EmptyView,{icon:A.Icon.MagnifyingGlass,title:"No Results",description:"No packages found"}),e.length>0&&(0,R.jsxs)(A.List.Section,{title:"Formulae",children:[e.map(s=>(0,R.jsx)(xi,{formula:s,isInstalled:t.isInstalled,onAction:t.onAction,showMetadataPanel:n},`formula-${s.name}`)),e.isTruncated()&&(0,R.jsx)(Ja,{})]}),r.length>0&&(0,R.jsxs)(A.List.Section,{title:"Casks",children:[r.map(s=>(0,R.jsx)($i,{cask:s,isInstalled:t.isInstalled,onAction:t.onAction,showMetadataPanel:n},`cask-${s.token}`)),r.isTruncated()&&(0,R.jsx)(Ja,{})]})]})}function xi(t){let e=t.formula,r=t.showMetadataPanel??!1,a=e.versions.stable,n=Za,s,i=A.Icon.Circle;X(e)&&(a=St(e),n=e.outdated?A.Color.Red:A.Color.Green,i=A.Icon.CheckCircle,s=e.outdated?"Outdated":"Up to date");let o={source:i,tintColor:n};return(0,R.jsx)(A.List.Item,{title:e.name,subtitle:r?void 0:e.desc,accessories:r?void 0:[{text:a}],icon:s?{value:o,tooltip:s}:o,detail:r?(0,R.jsx)(qa,{formula:e,isInstalled:t.isInstalled}):void 0,actions:(0,R.jsx)(Dt,{formula:e,showDetails:!r,isInstalled:t.isInstalled,onAction:t.onAction})})}function $i(t){let e=t.cask,r=t.showMetadataPanel??!1,a=e.version,n=Za,s,i=A.Icon.Circle;X(e)&&(a=St(e),n=e.outdated?A.Color.Red:A.Color.Green,i=A.Icon.CheckCircle,s=e.outdated?"Outdated":"Up to date");let o={source:i,tintColor:n};return(0,R.jsx)(A.List.Item,{title:T(e),subtitle:r?void 0:e.desc,accessories:r?void 0:[{text:a}],icon:s?{value:o,tooltip:s}:o,detail:r?(0,R.jsx)(Ga,{cask:e,isInstalled:t.isInstalled}):void 0,actions:(0,R.jsx)(Tt,{cask:e,showDetails:!r,isInstalled:t.isInstalled,onAction:t.onAction})})}function Ja(){return(0,R.jsx)(A.List.Item,{title:"",icon:A.Icon.Dot})}var Xa=require("react"),Ye=require("@raycast/api");function Qa(){let t=(0,Xa.useRef)(void 0),e=lt(async()=>await sr(!0),[],{keepPreviousData:!0,onWillExecute:async()=>{t.current=await(0,Ye.showToast)({style:Ye.Toast.Style.Animated,title:"Loading Installed Packages\u2026"})},onData:()=>{t.current?.hide()},onError:async r=>{t.current?.hide(),v.error("Failed to fetch installed packages",{errorType:r.name,message:r.message,isLockError:ce(r)});let a=ce(r),n=pe(r);await(0,Ye.showToast)({style:Ye.Toast.Style.Failure,title:a?"Brew is Busy":"Failed to fetch installed packages",message:a?"Another brew process is running. Please wait and try again.":n,primaryAction:{title:"Retry",onAction:s=>{s.hide(),e.revalidate()}}})}});return e}var Mt=require("react"),en=require("@raycast/api");function tn(t,e){return e?e.formulae instanceof Map&&e.formulae.get(t)!=null||e.casks instanceof Map&&e.casks.get(t)!=null:!1}var rn=(t,e,r)=>{let a=e!=="casks"&&t?.formulae instanceof Map?Array.from(t.formulae.values()):[];return{formulae:r?a.filter(n=>n.installed.some(s=>s.installed_on_request)):a,casks:e!=="formulae"&&t?.casks instanceof Map?Array.from(t.casks.values()):[]}};var ft=require("react/jsx-runtime");function Ci(){let[t,e]=(0,an.useState)("all"),{isLoading:r,data:a,revalidate:n}=Qa(),[s]=It(),{formulae:i,casks:o}=rn(a,t,s);a&&!r&&O.log("Installed view rendered",{filter:t,formulaeDisplayed:i.length,casksDisplayed:o.length,totalDisplayed:i.length+o.length,totalAvailable:(a.formulae?.size??0)+(a.casks?.size??0)});let l=r?"Loading installed packages\u2026":$a(t);return(0,ft.jsx)(Ya,{formulae:i,casks:o,searchBarPlaceholder:l,searchBarAccessory:(0,ft.jsx)(xa,{onSelect:e}),isLoading:r,dataFetched:a!==void 0,isInstalled:d=>tn(d,a),onAction:()=>{O.log("Revalidating installed packages"),n()}})}function nn(){return(0,ft.jsx)(Ct,{children:(0,ft.jsx)(Ci,{})})}
