"use strict";var i=Object.defineProperty;var h=Object.getOwnPropertyDescriptor;var m=Object.getOwnPropertyNames;var d=Object.prototype.hasOwnProperty;var u=(e,r)=>{for(var o in r)i(e,o,{get:r[o],enumerable:!0})},w=(e,r,o,a)=>{if(r&&typeof r=="object"||typeof r=="function")for(let s of m(r))!d.call(e,s)&&s!==o&&i(e,s,{get:()=>r[s],enumerable:!(a=h(r,s))||a.enumerable});return e};var S=e=>w(i({},"__esModule",{value:!0}),e);var E={};u(E,{default:()=>A});module.exports=S(E);var t=require("@raycast/api");var l=require("@raycast/api"),{accessToken:g}=(0,l.getPreferenceValues)(),p="https://api-ssl.bitly.com/v4",f={Authorization:`Bearer ${g}`,"Content-Type":"application/json"};async function A(){let e=await(0,t.showToast)(t.Toast.Style.Animated,"Shortening");try{let{pasteAfterShortening:r}=(0,t.getPreferenceValues)(),o;try{o=await(0,t.getSelectedText)()}catch{o=await t.Clipboard.readText()}if(!o)throw new Error("No text selected and clipboard is empty");new URL(o);let a=await fetch(`${p}/shorten`,{headers:f,method:"post",body:JSON.stringify({long_url:o})}),s=await a.json();if(!a.ok){let{message:y,errors:c}=s;throw new Error(`Bitly API Error - ${c?JSON.stringify(c):y}, URL - ${o}`)}let{link:n}=s;await t.Clipboard.copy(n),e.style=t.Toast.Style.Success,e.title="Success",e.message="Copied shortened URL to clipboard",r&&await t.Clipboard.paste(n)}catch(r){e.style=t.Toast.Style.Failure,e.title="Error",e.message=`${r}`}}
