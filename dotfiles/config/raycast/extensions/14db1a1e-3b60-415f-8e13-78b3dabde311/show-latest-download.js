"use strict";var _=Object.create;var h=Object.defineProperty;var P=Object.getOwnPropertyDescriptor;var U=Object.getOwnPropertyNames;var C=Object.getPrototypeOf,I=Object.prototype.hasOwnProperty;var O=(e,t)=>{for(var r in t)h(e,r,{get:t[r],enumerable:!0})},y=(e,t,r,a)=>{if(t&&typeof t=="object"||typeof t=="function")for(let u of U(t))!I.call(e,u)&&u!==r&&h(e,u,{get:()=>t[u],enumerable:!(a=P(t,u))||a.enumerable});return e};var w=(e,t,r)=>(r=e!=null?_(C(e)):{},y(t||!e||!e.__esModule?h(r,"default",{value:e,enumerable:!0}):r,e)),D=e=>y(h({},"__esModule",{value:!0}),e);var N={};O(N,{default:()=>R});module.exports=D(N);var i=require("@raycast/api");var s=require("@raycast/api");var c=w(require("react")),n=require("@raycast/api");var k=require("react/jsx-runtime");var o=require("fs");var $=require("path"),S=require("child_process"),E=require("os");var b=w(require("node:os"),1),f,p;function d(e){if(typeof e!="string")throw new TypeError(`Expected a string, got ${typeof e}`);if(f===void 0&&(f=b.default.homedir()),f&&/^~(?=$|\/|\\)/.test(e))return e.replace(/^~/,f);let t=e.match(/^~([^/\\]+)(.*)/);if(t&&(p===void 0&&(p=b.default.userInfo().username),p)){let r=t[1],a=t[2];if(r===p)return f+a}return e}var W=require("react/jsx-runtime"),x=new s.Cache,v="customDownloadsFolder",l=(0,s.getPreferenceValues)();function M(){if(l.downloadsFolder&&l.downloadsFolder.trim())return d(l.downloadsFolder);let e=x.get(v);if(e&&typeof e=="string")return e;let t=z();return x.set(v,t),t}var g=M(),L=l.showHiddenFiles,F=l.fileOrder,m=l.lastestDownloadOrder,X=l.downloadsLayout??"list";function z(){if(process.platform==="darwin")return d("~/Downloads");if(process.platform==="win32")try{return(0,S.execSync)(`powershell -Command "(New-Object -ComObject Shell.Application).NameSpace('shell:Downloads').Self.Path"`,{encoding:"utf-8"}).trim()}catch(e){return console.error("Failed to get Downloads folder from registry:",e),(0,$.join)((0,E.homedir)(),"Downloads")}return d("~/Downloads")}function V(){return(0,o.readdirSync)(g).filter(t=>L||!t.startsWith(".")).map(t=>{let r=(0,$.join)(g,t);try{let a=(0,o.statSync)(r);return{file:t,path:r,lastModifiedAt:a.mtime,createdAt:a.ctime,addedAt:a.atime,birthAt:a.birthtime}}catch(a){console.warn(`Skipping '${r}' because it could not be stat'd:`,a);return}}).filter(t=>!!t).map(t=>t).sort((t,r)=>{switch(F){case"addTime":return r.addedAt.getTime()-t.addedAt.getTime();case"createTime":return r.createdAt.getTime()-t.createdAt.getTime();case"modifiedTime":default:return r.lastModifiedAt.getTime()-t.lastModifiedAt.getTime()}})}function A(){let e=V();if(!(e.length<1))return m==="addTime"?e.sort((t,r)=>r.addedAt.getTime()-t.addedAt.getTime()):m==="createTime"?e.sort((t,r)=>r.createdAt.getTime()-t.createdAt.getTime()):m==="modifiedTime"?e.sort((t,r)=>r.lastModifiedAt.getTime()-t.lastModifiedAt.getTime()):m==="birthTime"&&e.sort((t,r)=>r.birthAt.getTime()-t.birthAt.getTime()),e[0]}function T(){try{return(0,o.accessSync)(g,o.constants.R_OK),!0}catch(e){return console.error(e),!1}}async function R(){if(!T()){await(0,i.showHUD)("No permission to access the downloads folder");return}let e=A();if(!e){await(0,i.showHUD)("No downloads found");return}await(0,i.showInFinder)(e.path),await(0,i.closeMainWindow)(),await(0,i.popToRoot)()}
