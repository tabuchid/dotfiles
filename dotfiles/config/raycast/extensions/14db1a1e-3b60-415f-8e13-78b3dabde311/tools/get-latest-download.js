"use strict";var R=Object.create;var d=Object.defineProperty;var _=Object.getOwnPropertyDescriptor;var P=Object.getOwnPropertyNames;var U=Object.getPrototypeOf,C=Object.prototype.hasOwnProperty;var I=(e,t)=>{for(var r in t)d(e,r,{get:t[r],enumerable:!0})},$=(e,t,r,a)=>{if(t&&typeof t=="object"||typeof t=="function")for(let l of P(t))!C.call(e,l)&&l!==r&&d(e,l,{get:()=>t[l],enumerable:!(a=_(t,l))||a.enumerable});return e};var y=(e,t,r)=>(r=e!=null?R(U(e)):{},$(t||!e||!e.__esModule?d(r,"default",{value:e,enumerable:!0}):r,e)),O=e=>$(d({},"__esModule",{value:!0}),e);var N={};I(N,{default:()=>T});module.exports=O(N);var s=require("@raycast/api");var o=y(require("react")),n=require("@raycast/api");var w=require("react/jsx-runtime");var i=require("fs");var g=require("path"),v=require("child_process"),S=require("os");var m=y(require("node:os"),1),u,h;function f(e){if(typeof e!="string")throw new TypeError(`Expected a string, got ${typeof e}`);if(u===void 0&&(u=m.default.homedir()),u&&/^~(?=$|\/|\\)/.test(e))return e.replace(/^~/,u);let t=e.match(/^~([^/\\]+)(.*)/);if(t&&(h===void 0&&(h=m.default.userInfo().username),h)){let r=t[1],a=t[2];if(r===h)return u+a}return e}var V=require("react/jsx-runtime"),k=new s.Cache,x="customDownloadsFolder",c=(0,s.getPreferenceValues)();function D(){if(c.downloadsFolder&&c.downloadsFolder.trim())return f(c.downloadsFolder);let e=k.get(x);if(e&&typeof e=="string")return e;let t=F();return k.set(x,t),t}var b=D(),M=c.showHiddenFiles,L=c.fileOrder,p=c.lastestDownloadOrder,Y=c.downloadsLayout??"list";function F(){if(process.platform==="darwin")return f("~/Downloads");if(process.platform==="win32")try{return(0,v.execSync)(`powershell -Command "(New-Object -ComObject Shell.Application).NameSpace('shell:Downloads').Self.Path"`,{encoding:"utf-8"}).trim()}catch(e){return console.error("Failed to get Downloads folder from registry:",e),(0,g.join)((0,S.homedir)(),"Downloads")}return f("~/Downloads")}function z(){return(0,i.readdirSync)(b).filter(t=>M||!t.startsWith(".")).map(t=>{let r=(0,g.join)(b,t);try{let a=(0,i.statSync)(r);return{file:t,path:r,lastModifiedAt:a.mtime,createdAt:a.ctime,addedAt:a.atime,birthAt:a.birthtime}}catch(a){console.warn(`Skipping '${r}' because it could not be stat'd:`,a);return}}).filter(t=>!!t).map(t=>t).sort((t,r)=>{switch(L){case"addTime":return r.addedAt.getTime()-t.addedAt.getTime();case"createTime":return r.createdAt.getTime()-t.createdAt.getTime();case"modifiedTime":default:return r.lastModifiedAt.getTime()-t.lastModifiedAt.getTime()}})}function E(){let e=z();if(!(e.length<1))return p==="addTime"?e.sort((t,r)=>r.addedAt.getTime()-t.addedAt.getTime()):p==="createTime"?e.sort((t,r)=>r.createdAt.getTime()-t.createdAt.getTime()):p==="modifiedTime"?e.sort((t,r)=>r.lastModifiedAt.getTime()-t.lastModifiedAt.getTime()):p==="birthTime"&&e.sort((t,r)=>r.birthAt.getTime()-t.birthAt.getTime()),e[0]}function A(){try{return(0,i.accessSync)(b,i.constants.R_OK),!0}catch(e){return console.error(e),!1}}async function T(){if(!A())throw new Error("No permission to access the downloads folder");let e=E();if(!e)throw new Error("No downloads found");return e.path}
