"use strict";var D=Object.create;var m=Object.defineProperty;var M=Object.getOwnPropertyDescriptor;var L=Object.getOwnPropertyNames;var F=Object.getPrototypeOf,z=Object.prototype.hasOwnProperty;var V=(e,t)=>{for(var r in t)m(e,r,{get:t[r],enumerable:!0})},E=(e,t,r,a)=>{if(t&&typeof t=="object"||typeof t=="function")for(let c of L(t))!z.call(e,c)&&c!==r&&m(e,c,{get:()=>t[c],enumerable:!(a=M(t,c))||a.enumerable});return e};var b=(e,t,r)=>(r=e!=null?D(F(e)):{},E(t||!e||!e.__esModule?m(r,"default",{value:e,enumerable:!0}):r,e)),W=e=>E(m({},"__esModule",{value:!0}),e);var J={};V(J,{default:()=>O});module.exports=W(J);var i=require("@raycast/api");var u=b(require("react")),n=require("@raycast/api");var f=b(require("node:fs")),g=b(require("node:path"));var T=require("react/jsx-runtime");function $(e,t){let r=e instanceof Error?e.message:String(e);return(0,n.showToast)({style:n.Toast.Style.Failure,title:t?.title??"Something went wrong",message:t?.message??r,primaryAction:t?.primaryAction??A(e),secondaryAction:t?.primaryAction?A(e):void 0})}var A=e=>{let t=!0,r="[Extension Name]...",a="";try{let o=JSON.parse((0,f.readFileSync)((0,g.join)(n.environment.assetsPath,"..","package.json"),"utf8"));r=`[${o.title}]...`,a=`https://raycast.com/${o.owner||o.author}/${o.name}`,(!o.owner||o.access==="public")&&(t=!1)}catch{}let c=n.environment.isDevelopment||t,S=e instanceof Error?e?.stack||e?.message||"":String(e);return{title:c?"Copy Logs":"Report Error",onAction(o){o.hide(),c?n.Clipboard.copy(S):(0,n.open)(`https://github.com/raycast/extensions/issues/new?&labels=extension%2Cbug&template=extension_bug_report.yml&title=${encodeURIComponent(r)}&extension-url=${encodeURI(a)}&description=${encodeURIComponent(`#### Error:
\`\`\`
${S}
\`\`\`
`)}`)}}};var s=require("@raycast/api");var l=require("fs");var v=require("path"),_=require("child_process"),C=require("os");var k=b(require("node:os"),1),h,y;function p(e){if(typeof e!="string")throw new TypeError(`Expected a string, got ${typeof e}`);if(h===void 0&&(h=k.default.homedir()),h&&/^~(?=$|\/|\\)/.test(e))return e.replace(/^~/,h);let t=e.match(/^~([^/\\]+)(.*)/);if(t&&(y===void 0&&(y=k.default.userInfo().username),y)){let r=t[1],a=t[2];if(r===y)return h+a}return e}var H=require("react/jsx-runtime"),R=new s.Cache,P="customDownloadsFolder",d=(0,s.getPreferenceValues)();function N(){if(d.downloadsFolder&&d.downloadsFolder.trim())return p(d.downloadsFolder);let e=R.get(P);if(e&&typeof e=="string")return e;let t=G();return R.set(P,t),t}var x=N(),j=d.showHiddenFiles,B=d.fileOrder,w=d.lastestDownloadOrder,ne=d.downloadsLayout??"list";function G(){if(process.platform==="darwin")return p("~/Downloads");if(process.platform==="win32")try{return(0,_.execSync)(`powershell -Command "(New-Object -ComObject Shell.Application).NameSpace('shell:Downloads').Self.Path"`,{encoding:"utf-8"}).trim()}catch(e){return console.error("Failed to get Downloads folder from registry:",e),(0,v.join)((0,C.homedir)(),"Downloads")}return p("~/Downloads")}function K(){return(0,l.readdirSync)(x).filter(t=>j||!t.startsWith(".")).map(t=>{let r=(0,v.join)(x,t);try{let a=(0,l.statSync)(r);return{file:t,path:r,lastModifiedAt:a.mtime,createdAt:a.ctime,addedAt:a.atime,birthAt:a.birthtime}}catch(a){console.warn(`Skipping '${r}' because it could not be stat'd:`,a);return}}).filter(t=>!!t).map(t=>t).sort((t,r)=>{switch(B){case"addTime":return r.addedAt.getTime()-t.addedAt.getTime();case"createTime":return r.createdAt.getTime()-t.createdAt.getTime();case"modifiedTime":default:return r.lastModifiedAt.getTime()-t.lastModifiedAt.getTime()}})}function U(){let e=K();if(!(e.length<1))return w==="addTime"?e.sort((t,r)=>r.addedAt.getTime()-t.addedAt.getTime()):w==="createTime"?e.sort((t,r)=>r.createdAt.getTime()-t.createdAt.getTime()):w==="modifiedTime"?e.sort((t,r)=>r.lastModifiedAt.getTime()-t.lastModifiedAt.getTime()):w==="birthTime"&&e.sort((t,r)=>r.birthAt.getTime()-t.birthAt.getTime()),e[0]}function I(){try{return(0,l.accessSync)(x,l.constants.R_OK),!0}catch(e){return console.error(e),!1}}async function O(){if(!I()){await(0,i.showHUD)("No permission to access the downloads folder");return}let e;try{e=U()}catch(t){await $(t,{title:"Could not get latest download"});return}if(!e){await(0,i.showHUD)("No downloads found");return}try{await i.Clipboard.paste({file:e.path}),await(0,i.closeMainWindow)(),await(0,i.showHUD)("Pasted latest download"),await(0,i.popToRoot)()}catch(t){await $(t,{title:"Could not paste download"})}}
