"use strict";var L=Object.create;var b=Object.defineProperty;var F=Object.getOwnPropertyDescriptor;var z=Object.getOwnPropertyNames;var V=Object.getPrototypeOf,N=Object.prototype.hasOwnProperty;var W=(e,t)=>{for(var r in t)b(e,r,{get:t[r],enumerable:!0})},E=(e,t,r,s)=>{if(t&&typeof t=="object"||typeof t=="function")for(let o of z(t))!N.call(e,o)&&o!==r&&b(e,o,{get:()=>t[o],enumerable:!(s=F(t,o))||s.enumerable});return e};var g=(e,t,r)=>(r=e!=null?L(V(e)):{},E(t||!e||!e.__esModule?b(r,"default",{value:e,enumerable:!0}):r,e)),j=e=>E(b({},"__esModule",{value:!0}),e);var q={};W(q,{default:()=>M});module.exports=j(q);var a=require("@raycast/api");var u=g(require("react")),n=require("@raycast/api");var f=g(require("node:fs")),$=g(require("node:path"));var T=require("react/jsx-runtime");function d(e,t){let r=e instanceof Error?e.message:String(e);return(0,n.showToast)({style:n.Toast.Style.Failure,title:t?.title??"Something went wrong",message:t?.message??r,primaryAction:t?.primaryAction??A(e),secondaryAction:t?.primaryAction?A(e):void 0})}var A=e=>{let t=!0,r="[Extension Name]...",s="";try{let i=JSON.parse((0,f.readFileSync)((0,$.join)(n.environment.assetsPath,"..","package.json"),"utf8"));r=`[${i.title}]...`,s=`https://raycast.com/${i.owner||i.author}/${i.name}`,(!i.owner||i.access==="public")&&(t=!1)}catch{}let o=n.environment.isDevelopment||t,S=e instanceof Error?e?.stack||e?.message||"":String(e);return{title:o?"Copy Logs":"Report Error",onAction(i){i.hide(),o?n.Clipboard.copy(S):(0,n.open)(`https://github.com/raycast/extensions/issues/new?&labels=extension%2Cbug&template=extension_bug_report.yml&title=${encodeURIComponent(r)}&extension-url=${encodeURI(s)}&description=${encodeURIComponent(`#### Error:
\`\`\`
${S}
\`\`\`
`)}`)}}};var l=require("fs"),P=require("fs/promises"),v=require("path"),U=require("child_process"),C=require("os");var k=g(require("node:os"),1),h,y;function p(e){if(typeof e!="string")throw new TypeError(`Expected a string, got ${typeof e}`);if(h===void 0&&(h=k.default.homedir()),h&&/^~(?=$|\/|\\)/.test(e))return e.replace(/^~/,h);let t=e.match(/^~([^/\\]+)(.*)/);if(t&&(y===void 0&&(y=k.default.userInfo().username),y)){let r=t[1],s=t[2];if(r===y)return h+s}return e}var Z=require("react/jsx-runtime"),R=new a.Cache,_="customDownloadsFolder",c=(0,a.getPreferenceValues)();function B(){if(c.downloadsFolder&&c.downloadsFolder.trim())return p(c.downloadsFolder);let e=R.get(_);if(e&&typeof e=="string")return e;let t=H();return R.set(_,t),t}var x=B(),G=c.showHiddenFiles,K=c.fileOrder,w=c.lastestDownloadOrder,se=c.downloadsLayout??"list";function H(){if(process.platform==="darwin")return p("~/Downloads");if(process.platform==="win32")try{return(0,U.execSync)(`powershell -Command "(New-Object -ComObject Shell.Application).NameSpace('shell:Downloads').Self.Path"`,{encoding:"utf-8"}).trim()}catch(e){return console.error("Failed to get Downloads folder from registry:",e),(0,v.join)((0,C.homedir)(),"Downloads")}return p("~/Downloads")}function J(){return(0,l.readdirSync)(x).filter(t=>G||!t.startsWith(".")).map(t=>{let r=(0,v.join)(x,t);try{let s=(0,l.statSync)(r);return{file:t,path:r,lastModifiedAt:s.mtime,createdAt:s.ctime,addedAt:s.atime,birthAt:s.birthtime}}catch(s){console.warn(`Skipping '${r}' because it could not be stat'd:`,s);return}}).filter(t=>!!t).map(t=>t).sort((t,r)=>{switch(K){case"addTime":return r.addedAt.getTime()-t.addedAt.getTime();case"createTime":return r.createdAt.getTime()-t.createdAt.getTime();case"modifiedTime":default:return r.lastModifiedAt.getTime()-t.lastModifiedAt.getTime()}})}function I(){let e=J();if(!(e.length<1))return w==="addTime"?e.sort((t,r)=>r.addedAt.getTime()-t.addedAt.getTime()):w==="createTime"?e.sort((t,r)=>r.createdAt.getTime()-t.createdAt.getTime()):w==="modifiedTime"?e.sort((t,r)=>r.lastModifiedAt.getTime()-t.lastModifiedAt.getTime()):w==="birthTime"&&e.sort((t,r)=>r.birthAt.getTime()-t.birthAt.getTime()),e[0]}function O(){try{return(0,l.accessSync)(x,l.constants.R_OK),!0}catch(e){return console.error(e),!1}}async function D(e){if(c.deletionBehavior==="trash"){try{await(0,a.trash)(e),await(0,a.showToast)({style:a.Toast.Style.Success,title:"Item Moved to Trash"})}catch(r){await d(r,{title:"Move to Trash Failed"})}return}if(!await(0,a.confirmAlert)({title:"Delete Item?",message:`Are you sure you want to permanently delete:
${e}?`,primaryAction:{title:"Delete"}})){await(0,a.showToast)({style:a.Toast.Style.Animated,title:"Cancelled"});return}try{await(0,P.rm)(e,{recursive:!0,force:!0}),await(0,a.showToast)({style:a.Toast.Style.Success,title:"Item Deleted"})}catch(r){r instanceof Error&&await d(r,{title:"Deletion Failed"})}}var m=require("@raycast/api");async function M(){if(!O()){await(0,m.showHUD)("No permission to access the downloads folder");return}let e=I();if(!e){await(0,m.showHUD)("No downloads found");return}try{await D(e.path)}catch(t){await d(t,{title:"Deletion Failed"})}await(0,m.popToRoot)()}
