"use strict";var C=Object.create;var h=Object.defineProperty;var U=Object.getOwnPropertyDescriptor;var I=Object.getOwnPropertyNames;var O=Object.getPrototypeOf,D=Object.prototype.hasOwnProperty;var M=(e,t)=>{for(var r in t)h(e,r,{get:t[r],enumerable:!0})},y=(e,t,r,a)=>{if(t&&typeof t=="object"||typeof t=="function")for(let u of I(t))!D.call(e,u)&&u!==r&&h(e,u,{get:()=>t[u],enumerable:!(a=U(t,u))||a.enumerable});return e};var w=(e,t,r)=>(r=e!=null?C(O(e)):{},y(t||!e||!e.__esModule?h(r,"default",{value:e,enumerable:!0}):r,e)),L=e=>y(h({},"__esModule",{value:!0}),e);var B={};M(B,{default:()=>P});module.exports=L(B);var l=require("@raycast/api");var s=require("@raycast/api");var o=w(require("react")),n=require("@raycast/api");var k=require("react/jsx-runtime");var i=require("fs");var $=require("path"),S=require("child_process"),E=require("os");var b=w(require("node:os"),1),f,p;function d(e){if(typeof e!="string")throw new TypeError(`Expected a string, got ${typeof e}`);if(f===void 0&&(f=b.default.homedir()),f&&/^~(?=$|\/|\\)/.test(e))return e.replace(/^~/,f);let t=e.match(/^~([^/\\]+)(.*)/);if(t&&(p===void 0&&(p=b.default.userInfo().username),p)){let r=t[1],a=t[2];if(r===p)return f+a}return e}var j=require("react/jsx-runtime"),x=new s.Cache,v="customDownloadsFolder",c=(0,s.getPreferenceValues)();function F(){if(c.downloadsFolder&&c.downloadsFolder.trim())return d(c.downloadsFolder);let e=x.get(v);if(e&&typeof e=="string")return e;let t=W();return x.set(v,t),t}var g=F(),z=c.showHiddenFiles,V=c.fileOrder,m=c.lastestDownloadOrder,ee=c.downloadsLayout??"list";function W(){if(process.platform==="darwin")return d("~/Downloads");if(process.platform==="win32")try{return(0,S.execSync)(`powershell -Command "(New-Object -ComObject Shell.Application).NameSpace('shell:Downloads').Self.Path"`,{encoding:"utf-8"}).trim()}catch(e){return console.error("Failed to get Downloads folder from registry:",e),(0,$.join)((0,E.homedir)(),"Downloads")}return d("~/Downloads")}function N(){return(0,i.readdirSync)(g).filter(t=>z||!t.startsWith(".")).map(t=>{let r=(0,$.join)(g,t);try{let a=(0,i.statSync)(r);return{file:t,path:r,lastModifiedAt:a.mtime,createdAt:a.ctime,addedAt:a.atime,birthAt:a.birthtime}}catch(a){console.warn(`Skipping '${r}' because it could not be stat'd:`,a);return}}).filter(t=>!!t).map(t=>t).sort((t,r)=>{switch(V){case"addTime":return r.addedAt.getTime()-t.addedAt.getTime();case"createTime":return r.createdAt.getTime()-t.createdAt.getTime();case"modifiedTime":default:return r.lastModifiedAt.getTime()-t.lastModifiedAt.getTime()}})}function A(){let e=N();if(!(e.length<1))return m==="addTime"?e.sort((t,r)=>r.addedAt.getTime()-t.addedAt.getTime()):m==="createTime"?e.sort((t,r)=>r.createdAt.getTime()-t.createdAt.getTime()):m==="modifiedTime"?e.sort((t,r)=>r.lastModifiedAt.getTime()-t.lastModifiedAt.getTime()):m==="birthTime"&&e.sort((t,r)=>r.birthAt.getTime()-t.birthAt.getTime()),e[0]}function T(){try{return(0,i.accessSync)(g,i.constants.R_OK),!0}catch(e){return console.error(e),!1}}var R=require("@raycast/api"),_=require("@raycast/api");async function P(){if(!T()){await(0,l.showHUD)("No permission to access the downloads folder");return}let e=A();if(!e){await(0,l.showHUD)("No downloads found");return}await R.Clipboard.copy({file:e.path}),await(0,_.closeMainWindow)(),await(0,l.showHUD)("Copied latest download to clipboard"),await(0,l.popToRoot)()}
