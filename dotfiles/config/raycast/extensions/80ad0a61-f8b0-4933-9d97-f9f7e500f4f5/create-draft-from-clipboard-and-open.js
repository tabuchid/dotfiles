"use strict";var X=Object.create;var m=Object.defineProperty;var z=Object.getOwnPropertyDescriptor;var H=Object.getOwnPropertyNames;var j=Object.getPrototypeOf,Y=Object.prototype.hasOwnProperty;var h=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports),J=(e,t)=>{for(var r in t)m(e,r,{get:t[r],enumerable:!0})},C=(e,t,r,n)=>{if(t&&typeof t=="object"||typeof t=="function")for(let a of H(t))!Y.call(e,a)&&a!==r&&m(e,a,{get:()=>t[a],enumerable:!(n=z(t,a))||n.enumerable});return e};var V=(e,t,r)=>(r=e!=null?X(j(e)):{},C(t||!e||!e.__esModule?m(r,"default",{value:e,enumerable:!0}):r,e)),Z=e=>C(m({},"__esModule",{value:!0}),e);var k=h((Pe,N)=>{"use strict";var R=require("fs"),D;function te(){try{return R.statSync("/.dockerenv"),!0}catch{return!1}}function re(){try{return R.readFileSync("/proc/self/cgroup","utf8").includes("docker")}catch{return!1}}N.exports=()=>(D===void 0&&(D=te()||re()),D)});var L=h((xe,E)=>{"use strict";var ae=require("os"),ne=require("fs"),F=k(),I=()=>{if(process.platform!=="linux")return!1;if(ae.release().toLowerCase().includes("microsoft"))return!F();try{return ne.readFileSync("/proc/version","utf8").toLowerCase().includes("microsoft")?!F():!1}catch{return!1}};process.env.__IS_WSL_TEST__?E.exports=I:E.exports=I()});var v=h((De,U)=>{"use strict";U.exports=(e,t,r)=>{let n=a=>Object.defineProperty(e,t,{value:a,enumerable:!0,writable:!0});return Object.defineProperty(e,t,{configurable:!0,enumerable:!0,get(){let a=r();return n(a),a},set(a){n(a)}}),e}});var $=h((ke,K)=>{var se=require("path"),ie=require("child_process"),{promises:A,constants:G}=require("fs"),g=L(),oe=k(),y=v(),q=se.join(__dirname,"xdg-open"),{platform:p,arch:W}=process,ce=()=>{try{return A.statSync("/run/.containerenv"),!0}catch{return!1}},_;function le(){return _===void 0&&(_=ce()||oe()),_}var ue=(()=>{let e="/mnt/",t;return async function(){if(t)return t;let r="/etc/wsl.conf",n=!1;try{await A.access(r,G.F_OK),n=!0}catch{}if(!n)return e;let a=await A.readFile(r,{encoding:"utf8"}),l=/(?<!#.*)root\s*=\s*(?<mountPoint>.*)/g.exec(a);return l?(t=l.groups.mountPoint.trim(),t=t.endsWith("/")?t:`${t}/`,t):e}})(),B=async(e,t)=>{let r;for(let n of e)try{return await t(n)}catch(a){r=a}throw r},w=async e=>{if(e={wait:!1,background:!1,newInstance:!1,allowNonzeroExitCode:!1,...e},Array.isArray(e.app))return B(e.app,o=>w({...e,app:o}));let{name:t,arguments:r=[]}=e.app||{};if(r=[...r],Array.isArray(t))return B(t,o=>w({...e,app:{name:o,arguments:r}}));let n,a=[],l={};if(p==="darwin")n="open",e.wait&&a.push("--wait-apps"),e.background&&a.push("--background"),e.newInstance&&a.push("--new"),t&&a.push("-a",t);else if(p==="win32"||g&&!le()&&!t){let o=await ue();n=g?`${o}c/Windows/System32/WindowsPowerShell/v1.0/powershell.exe`:`${process.env.SYSTEMROOT}\\System32\\WindowsPowerShell\\v1.0\\powershell`,a.push("-NoProfile","-NonInteractive","\u2013ExecutionPolicy","Bypass","-EncodedCommand"),g||(l.windowsVerbatimArguments=!0);let s=["Start"];e.wait&&s.push("-Wait"),t?(s.push(`"\`"${t}\`""`,"-ArgumentList"),e.target&&r.unshift(e.target)):e.target&&s.push(`"${e.target}"`),r.length>0&&(r=r.map(d=>`"\`"${d}\`""`),s.push(r.join(","))),e.target=Buffer.from(s.join(" "),"utf16le").toString("base64")}else{if(t)n=t;else{let o=!__dirname||__dirname==="/",s=!1;try{await A.access(q,G.X_OK),s=!0}catch{}n=process.versions.electron||p==="android"||o||!s?"xdg-open":q}r.length>0&&a.push(...r),e.wait||(l.stdio="ignore",l.detached=!0)}e.target&&a.push(e.target),p==="darwin"&&r.length>0&&a.push("--args",...r);let f=ie.spawn(n,a,l);return e.wait?new Promise((o,s)=>{f.once("error",s),f.once("close",d=>{if(!e.allowNonzeroExitCode&&d>0){s(new Error(`Exited with code ${d}`));return}o(f)})}):(f.unref(),f)},T=(e,t)=>{if(typeof e!="string")throw new TypeError("Expected a `target`");return w({...t,target:e})},pe=(e,t)=>{if(typeof e!="string")throw new TypeError("Expected a `name`");let{arguments:r=[]}=t||{};if(r!=null&&!Array.isArray(r))throw new TypeError("Expected `appArguments` as Array type");return w({...t,app:{name:e,arguments:r}})};function M(e){if(typeof e=="string"||Array.isArray(e))return e;let{[W]:t}=e;if(!t)throw new Error(`${W} is not supported`);return t}function b({[p]:e},{wsl:t}){if(t&&g)return M(t);if(!e)throw new Error(`${p} is not supported`);return M(e)}var P={};y(P,"chrome",()=>b({darwin:"google chrome",win32:"chrome",linux:["google-chrome","google-chrome-stable","chromium"]},{wsl:{ia32:"/mnt/c/Program Files (x86)/Google/Chrome/Application/chrome.exe",x64:["/mnt/c/Program Files/Google/Chrome/Application/chrome.exe","/mnt/c/Program Files (x86)/Google/Chrome/Application/chrome.exe"]}}));y(P,"firefox",()=>b({darwin:"firefox",win32:"C:\\Program Files\\Mozilla Firefox\\firefox.exe",linux:"firefox"},{wsl:"/mnt/c/Program Files/Mozilla Firefox/firefox.exe"}));y(P,"edge",()=>b({darwin:"microsoft edge",win32:"msedge",linux:["microsoft-edge","microsoft-edge-dev"]},{wsl:"/mnt/c/Program Files (x86)/Microsoft/Edge/Application/msedge.exe"}));T.apps=P;T.openApp=pe;K.exports=T});var me={};J(me,{default:()=>de});module.exports=Z(me);var i=require("@raycast/api");var c=require("@raycast/api");var S={CREATE_DRAFT:"drafts://x-callback-url/create?",OPEN_DRAFT:"drafts://x-callback-url/open?",RUN_ACTION:"drafts://x-callback-url/runAction?",OPEN_WORKSPACE:"drafts://x-callback-url/workspace?",APPEND_TO_DRAFT:"drafts://x-callback-url/append?",PREPEND_TO_DRAFT:"drafts://x-callback-url/prepend?",DICTATE:"drafts://x-callback-url/dictate?"};var u={APP_NAME:"Drafts",APP_BUNDLE_ID:"com.agiletortoise.Drafts-OSX",APP_DOWNLOAD_LINK:"https://getdrafts.com"};async function ee(){return(await(0,c.getApplications)()).some(({bundleId:t})=>t===u.APP_BUNDLE_ID)}async function O(){if(!await ee()){let e={style:c.Toast.Style.Failure,title:u.APP_NAME+" is not installed.",message:"Install it from: "+u.APP_DOWNLOAD_LINK,primaryAction:{title:"Open "+u.APP_DOWNLOAD_LINK,onAction:t=>{(0,c.open)(u.APP_DOWNLOAD_LINK),t.hide()}}};return await(0,c.showToast)(e),!1}return!0}var Q=V($()),x=class{constructor(t){this.callbackParams=[];this.baseUrl=t}getBaseUrl(){return this.baseUrl}getParams(){return this.callbackParams}addParam(t){this.callbackParams.push(t)}createCallbackUrl(){let t=0,r=this.baseUrl;return this.callbackParams.forEach(function(n){r=r+(t==0?"":"&")+n.name+"="+encodeURIComponent(n.value),t=t+1}),r}async openCallbackUrl(){await(0,Q.default)(this.createCallbackUrl())}};var fe=i.Toast.Style,de=async()=>{if(await O()){let e=new x(S.CREATE_DRAFT),t=await i.Clipboard.readText();t?(e.addParam({name:"text",value:t}),await e.openCallbackUrl()):await(0,i.showToast)({style:fe.Failure,title:"Clipboard is empty"}),await(0,i.popToRoot)({clearSearchBar:!0}),await(0,i.closeMainWindow)()}};
