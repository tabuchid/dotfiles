"use strict";var X=Object.create;var d=Object.defineProperty;var z=Object.getOwnPropertyDescriptor;var H=Object.getOwnPropertyNames;var j=Object.getPrototypeOf,Y=Object.prototype.hasOwnProperty;var m=(e,r)=>()=>(r||e((r={exports:{}}).exports,r),r.exports),J=(e,r)=>{for(var t in r)d(e,t,{get:r[t],enumerable:!0})},T=(e,r,t,n)=>{if(r&&typeof r=="object"||typeof r=="function")for(let a of H(r))!Y.call(e,a)&&a!==t&&d(e,a,{get:()=>r[a],enumerable:!(n=z(r,a))||n.enumerable});return e};var V=(e,r,t)=>(t=e!=null?X(j(e)):{},T(r||!e||!e.__esModule?d(t,"default",{value:e,enumerable:!0}):t,e)),Z=e=>T(d({},"__esModule",{value:!0}),e);var k=m((we,R)=>{"use strict";var N=require("fs"),x;function re(){try{return N.statSync("/.dockerenv"),!0}catch{return!1}}function te(){try{return N.readFileSync("/proc/self/cgroup","utf8").includes("docker")}catch{return!1}}R.exports=()=>(x===void 0&&(x=re()||te()),x)});var L=m((Pe,E)=>{"use strict";var ae=require("os"),ne=require("fs"),I=k(),F=()=>{if(process.platform!=="linux")return!1;if(ae.release().toLowerCase().includes("microsoft"))return!I();try{return ne.readFileSync("/proc/version","utf8").toLowerCase().includes("microsoft")?!I():!1}catch{return!1}};process.env.__IS_WSL_TEST__?E.exports=F:E.exports=F()});var v=m((De,U)=>{"use strict";U.exports=(e,r,t)=>{let n=a=>Object.defineProperty(e,r,{value:a,enumerable:!0,writable:!0});return Object.defineProperty(e,r,{configurable:!0,enumerable:!0,get(){let a=t();return n(a),a},set(a){n(a)}}),e}});var $=m((xe,K)=>{var se=require("path"),ie=require("child_process"),{promises:g,constants:G}=require("fs"),h=L(),oe=k(),b=v(),q=se.join(__dirname,"xdg-open"),{platform:u,arch:W}=process,ce=()=>{try{return g.statSync("/run/.containerenv"),!0}catch{return!1}},_;function le(){return _===void 0&&(_=ce()||oe()),_}var ue=(()=>{let e="/mnt/",r;return async function(){if(r)return r;let t="/etc/wsl.conf",n=!1;try{await g.access(t,G.F_OK),n=!0}catch{}if(!n)return e;let a=await g.readFile(t,{encoding:"utf8"}),c=/(?<!#.*)root\s*=\s*(?<mountPoint>.*)/g.exec(a);return c?(r=c.groups.mountPoint.trim(),r=r.endsWith("/")?r:`${r}/`,r):e}})(),B=async(e,r)=>{let t;for(let n of e)try{return await r(n)}catch(a){t=a}throw t},A=async e=>{if(e={wait:!1,background:!1,newInstance:!1,allowNonzeroExitCode:!1,...e},Array.isArray(e.app))return B(e.app,i=>A({...e,app:i}));let{name:r,arguments:t=[]}=e.app||{};if(t=[...t],Array.isArray(r))return B(r,i=>A({...e,app:{name:i,arguments:t}}));let n,a=[],c={};if(u==="darwin")n="open",e.wait&&a.push("--wait-apps"),e.background&&a.push("--background"),e.newInstance&&a.push("--new"),r&&a.push("-a",r);else if(u==="win32"||h&&!le()&&!r){let i=await ue();n=h?`${i}c/Windows/System32/WindowsPowerShell/v1.0/powershell.exe`:`${process.env.SYSTEMROOT}\\System32\\WindowsPowerShell\\v1.0\\powershell`,a.push("-NoProfile","-NonInteractive","\u2013ExecutionPolicy","Bypass","-EncodedCommand"),h||(c.windowsVerbatimArguments=!0);let s=["Start"];e.wait&&s.push("-Wait"),r?(s.push(`"\`"${r}\`""`,"-ArgumentList"),e.target&&t.unshift(e.target)):e.target&&s.push(`"${e.target}"`),t.length>0&&(t=t.map(p=>`"\`"${p}\`""`),s.push(t.join(","))),e.target=Buffer.from(s.join(" "),"utf16le").toString("base64")}else{if(r)n=r;else{let i=!__dirname||__dirname==="/",s=!1;try{await g.access(q,G.X_OK),s=!0}catch{}n=process.versions.electron||u==="android"||i||!s?"xdg-open":q}t.length>0&&a.push(...t),e.wait||(c.stdio="ignore",c.detached=!0)}e.target&&a.push(e.target),u==="darwin"&&t.length>0&&a.push("--args",...t);let f=ie.spawn(n,a,c);return e.wait?new Promise((i,s)=>{f.once("error",s),f.once("close",p=>{if(!e.allowNonzeroExitCode&&p>0){s(new Error(`Exited with code ${p}`));return}i(f)})}):(f.unref(),f)},y=(e,r)=>{if(typeof e!="string")throw new TypeError("Expected a `target`");return A({...r,target:e})},fe=(e,r)=>{if(typeof e!="string")throw new TypeError("Expected a `name`");let{arguments:t=[]}=r||{};if(t!=null&&!Array.isArray(t))throw new TypeError("Expected `appArguments` as Array type");return A({...r,app:{name:e,arguments:t}})};function M(e){if(typeof e=="string"||Array.isArray(e))return e;let{[W]:r}=e;if(!r)throw new Error(`${W} is not supported`);return r}function C({[u]:e},{wsl:r}){if(r&&h)return M(r);if(!e)throw new Error(`${u} is not supported`);return M(e)}var w={};b(w,"chrome",()=>C({darwin:"google chrome",win32:"chrome",linux:["google-chrome","google-chrome-stable","chromium"]},{wsl:{ia32:"/mnt/c/Program Files (x86)/Google/Chrome/Application/chrome.exe",x64:["/mnt/c/Program Files/Google/Chrome/Application/chrome.exe","/mnt/c/Program Files (x86)/Google/Chrome/Application/chrome.exe"]}}));b(w,"firefox",()=>C({darwin:"firefox",win32:"C:\\Program Files\\Mozilla Firefox\\firefox.exe",linux:"firefox"},{wsl:"/mnt/c/Program Files/Mozilla Firefox/firefox.exe"}));b(w,"edge",()=>C({darwin:"microsoft edge",win32:"msedge",linux:["microsoft-edge","microsoft-edge-dev"]},{wsl:"/mnt/c/Program Files (x86)/Microsoft/Edge/Application/msedge.exe"}));y.apps=w;y.openApp=fe;K.exports=y});var de={};J(de,{default:()=>pe});module.exports=Z(de);var D=require("@raycast/api");var o=require("@raycast/api");var S={CREATE_DRAFT:"drafts://x-callback-url/create?",OPEN_DRAFT:"drafts://x-callback-url/open?",RUN_ACTION:"drafts://x-callback-url/runAction?",OPEN_WORKSPACE:"drafts://x-callback-url/workspace?",APPEND_TO_DRAFT:"drafts://x-callback-url/append?",PREPEND_TO_DRAFT:"drafts://x-callback-url/prepend?",DICTATE:"drafts://x-callback-url/dictate?"};var l={APP_NAME:"Drafts",APP_BUNDLE_ID:"com.agiletortoise.Drafts-OSX",APP_DOWNLOAD_LINK:"https://getdrafts.com"};async function ee(){return(await(0,o.getApplications)()).some(({bundleId:r})=>r===l.APP_BUNDLE_ID)}async function O(){if(!await ee()){let e={style:o.Toast.Style.Failure,title:l.APP_NAME+" is not installed.",message:"Install it from: "+l.APP_DOWNLOAD_LINK,primaryAction:{title:"Open "+l.APP_DOWNLOAD_LINK,onAction:r=>{(0,o.open)(l.APP_DOWNLOAD_LINK),r.hide()}}};return await(0,o.showToast)(e),!1}return!0}var Q=V($()),P=class{constructor(r){this.callbackParams=[];this.baseUrl=r}getBaseUrl(){return this.baseUrl}getParams(){return this.callbackParams}addParam(r){this.callbackParams.push(r)}createCallbackUrl(){let r=0,t=this.baseUrl;return this.callbackParams.forEach(function(n){t=t+(r==0?"":"&")+n.name+"="+encodeURIComponent(n.value),r=r+1}),t}async openCallbackUrl(){await(0,Q.default)(this.createCallbackUrl())}};var pe=async()=>{await O()&&(await new P(S.DICTATE).openCallbackUrl(),await(0,D.popToRoot)({clearSearchBar:!0}),await(0,D.closeMainWindow)())};
