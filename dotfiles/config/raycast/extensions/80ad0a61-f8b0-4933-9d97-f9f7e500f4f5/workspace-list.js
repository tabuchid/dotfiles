"use strict";var Z=Object.create;var h=Object.defineProperty;var ee=Object.getOwnPropertyDescriptor;var te=Object.getOwnPropertyNames;var re=Object.getPrototypeOf,ae=Object.prototype.hasOwnProperty;var g=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports),ne=(e,t)=>{for(var r in t)h(e,r,{get:t[r],enumerable:!0})},I=(e,t,r,o)=>{if(t&&typeof t=="object"||typeof t=="function")for(let n of te(t))!ae.call(e,n)&&n!==r&&h(e,n,{get:()=>t[n],enumerable:!(o=ee(t,n))||o.enumerable});return e};var oe=(e,t,r)=>(r=e!=null?Z(re(e)):{},I(t||!e||!e.__esModule?h(r,"default",{value:e,enumerable:!0}):r,e)),se=e=>I(h({},"__esModule",{value:!0}),e);var E=g((Se,v)=>{"use strict";var L=require("fs"),x;function ce(){try{return L.statSync("/.dockerenv"),!0}catch{return!1}}function le(){try{return L.readFileSync("/proc/self/cgroup","utf8").includes("docker")}catch{return!1}}v.exports=()=>(x===void 0&&(x=ce()||le()),x)});var B=g((Te,_)=>{"use strict";var pe=require("os"),ue=require("fs"),U=E(),q=()=>{if(process.platform!=="linux")return!1;if(pe.release().toLowerCase().includes("microsoft"))return!U();try{return ue.readFileSync("/proc/version","utf8").toLowerCase().includes("microsoft")?!U():!1}catch{return!1}};process.env.__IS_WSL_TEST__?_.exports=q:_.exports=q()});var M=g((Ne,K)=>{"use strict";K.exports=(e,t,r)=>{let o=n=>Object.defineProperty(e,t,{value:n,enumerable:!0,writable:!0});return Object.defineProperty(e,t,{configurable:!0,enumerable:!0,get(){let n=r();return o(n),n},set(n){o(n)}}),e}});var j=g((We,H)=>{var fe=require("path"),me=require("child_process"),{promises:w,constants:z}=require("fs"),A=B(),de=E(),S=M(),G=fe.join(__dirname,"xdg-open"),{platform:k,arch:Q}=process,ke=()=>{try{return w.statSync("/run/.containerenv"),!0}catch{return!1}},b;function he(){return b===void 0&&(b=ke()||de()),b}var ge=(()=>{let e="/mnt/",t;return async function(){if(t)return t;let r="/etc/wsl.conf",o=!1;try{await w.access(r,z.F_OK),o=!0}catch{}if(!o)return e;let n=await w.readFile(r,{encoding:"utf8"}),u=/(?<!#.*)root\s*=\s*(?<mountPoint>.*)/g.exec(n);return u?(t=u.groups.mountPoint.trim(),t=t.endsWith("/")?t:`${t}/`,t):e}})(),$=async(e,t)=>{let r;for(let o of e)try{return await t(o)}catch(n){r=n}throw r},P=async e=>{if(e={wait:!1,background:!1,newInstance:!1,allowNonzeroExitCode:!1,...e},Array.isArray(e.app))return $(e.app,p=>P({...e,app:p}));let{name:t,arguments:r=[]}=e.app||{};if(r=[...r],Array.isArray(t))return $(t,p=>P({...e,app:{name:p,arguments:r}}));let o,n=[],u={};if(k==="darwin")o="open",e.wait&&n.push("--wait-apps"),e.background&&n.push("--background"),e.newInstance&&n.push("--new"),t&&n.push("-a",t);else if(k==="win32"||A&&!he()&&!t){let p=await ge();o=A?`${p}c/Windows/System32/WindowsPowerShell/v1.0/powershell.exe`:`${process.env.SYSTEMROOT}\\System32\\WindowsPowerShell\\v1.0\\powershell`,n.push("-NoProfile","-NonInteractive","\u2013ExecutionPolicy","Bypass","-EncodedCommand"),A||(u.windowsVerbatimArguments=!0);let l=["Start"];e.wait&&l.push("-Wait"),t?(l.push(`"\`"${t}\`""`,"-ArgumentList"),e.target&&r.unshift(e.target)):e.target&&l.push(`"${e.target}"`),r.length>0&&(r=r.map(i=>`"\`"${i}\`""`),l.push(r.join(","))),e.target=Buffer.from(l.join(" "),"utf16le").toString("base64")}else{if(t)o=t;else{let p=!__dirname||__dirname==="/",l=!1;try{await w.access(G,z.X_OK),l=!0}catch{}o=process.versions.electron||k==="android"||p||!l?"xdg-open":G}r.length>0&&n.push(...r),e.wait||(u.stdio="ignore",u.detached=!0)}e.target&&n.push(e.target),k==="darwin"&&r.length>0&&n.push("--args",...r);let f=me.spawn(o,n,u);return e.wait?new Promise((p,l)=>{f.once("error",l),f.once("close",i=>{if(!e.allowNonzeroExitCode&&i>0){l(new Error(`Exited with code ${i}`));return}p(f)})}):(f.unref(),f)},T=(e,t)=>{if(typeof e!="string")throw new TypeError("Expected a `target`");return P({...t,target:e})},Ae=(e,t)=>{if(typeof e!="string")throw new TypeError("Expected a `name`");let{arguments:r=[]}=t||{};if(r!=null&&!Array.isArray(r))throw new TypeError("Expected `appArguments` as Array type");return P({...t,app:{name:e,arguments:r}})};function X(e){if(typeof e=="string"||Array.isArray(e))return e;let{[Q]:t}=e;if(!t)throw new Error(`${Q} is not supported`);return t}function N({[k]:e},{wsl:t}){if(t&&A)return X(t);if(!e)throw new Error(`${k} is not supported`);return X(e)}var D={};S(D,"chrome",()=>N({darwin:"google chrome",win32:"chrome",linux:["google-chrome","google-chrome-stable","chromium"]},{wsl:{ia32:"/mnt/c/Program Files (x86)/Google/Chrome/Application/chrome.exe",x64:["/mnt/c/Program Files/Google/Chrome/Application/chrome.exe","/mnt/c/Program Files (x86)/Google/Chrome/Application/chrome.exe"]}}));S(D,"firefox",()=>N({darwin:"firefox",win32:"C:\\Program Files\\Mozilla Firefox\\firefox.exe",linux:"firefox"},{wsl:"/mnt/c/Program Files/Mozilla Firefox/firefox.exe"}));S(D,"edge",()=>N({darwin:"microsoft edge",win32:"msedge",linux:["microsoft-edge","microsoft-edge-dev"]},{wsl:"/mnt/c/Program Files (x86)/Microsoft/Edge/Application/msedge.exe"}));T.apps=D;T.openApp=Ae;H.exports=T});var ye={};ne(ye,{default:()=>Y});module.exports=se(ye);var a=require("@raycast/api"),O=require("react");var m=require("@raycast/api");var C={CREATE_DRAFT:"drafts://x-callback-url/create?",OPEN_DRAFT:"drafts://x-callback-url/open?",RUN_ACTION:"drafts://x-callback-url/runAction?",OPEN_WORKSPACE:"drafts://x-callback-url/workspace?",APPEND_TO_DRAFT:"drafts://x-callback-url/append?",PREPEND_TO_DRAFT:"drafts://x-callback-url/prepend?",DICTATE:"drafts://x-callback-url/dictate?"};var d={APP_NAME:"Drafts",APP_BUNDLE_ID:"com.agiletortoise.Drafts-OSX",APP_DOWNLOAD_LINK:"https://getdrafts.com"};async function ie(){return(await(0,m.getApplications)()).some(({bundleId:t})=>t===d.APP_BUNDLE_ID)}async function F(){if(!await ie()){let e={style:m.Toast.Style.Failure,title:d.APP_NAME+" is not installed.",message:"Install it from: "+d.APP_DOWNLOAD_LINK,primaryAction:{title:"Open "+d.APP_DOWNLOAD_LINK,onAction:t=>{(0,m.open)(d.APP_DOWNLOAD_LINK),t.hide()}}};return await(0,m.showToast)(e),!1}return!0}var V=oe(j()),y=class{constructor(t){this.callbackParams=[];this.baseUrl=t}getBaseUrl(){return this.baseUrl}getParams(){return this.callbackParams}addParam(t){this.callbackParams.push(t)}createCallbackUrl(){let t=0,r=this.baseUrl;return this.callbackParams.forEach(function(o){r=r+(t==0?"":"&")+o.name+"="+encodeURIComponent(o.value),t=t+1}),r}async openCallbackUrl(){await(0,V.default)(this.createCallbackUrl())}};var s=require("react/jsx-runtime"),R=a.Toast.Style;function W(e){return(0,s.jsx)(a.Action.Push,{icon:a.Icon.Plus,title:"Add Workspace",shortcut:{modifiers:["opt"],key:"a"},target:(0,s.jsx)(De,{onCreate:e.onCreate})})}function we(e){return(0,s.jsx)(a.Action,{icon:a.Icon.ArrowRight,title:"Open Workspace",onAction:e.onOpen})}function Pe(e){return(0,s.jsx)(a.Action,{icon:a.Icon.Trash,title:"Remove Workspace",shortcut:{modifiers:["opt"],key:"d"},onAction:e.onDelete})}function De(e){let{pop:t}=(0,a.useNavigation)();async function r(o){o.workspaceName.length>0?(e.onCreate({workspaceName:o.workspaceName}),t()):await(0,a.showToast)({style:R.Failure,title:"Workspace Name must not be empty!",message:"copy the exact name from an existing workspace in Drafts"})}return(0,s.jsx)(a.Form,{actions:(0,s.jsx)(a.ActionPanel,{children:(0,s.jsx)(a.Action.SubmitForm,{title:"Add Workspace",onSubmit:r})}),children:(0,s.jsx)(a.Form.TextField,{id:"workspaceName",title:"Add Workspace"})})}function Y(){F();let[e,t]=(0,O.useState)([]),[r,o]=(0,O.useState)(!0);async function n(){let i=await a.LocalStorage.getItem("stored-workspaces");if(i){let c=i.split(",");t(c.map(J=>({workspaceName:J})))}o(!1)}async function u(i){await a.LocalStorage.setItem("stored-workspaces",i.map(c=>c.workspaceName).join(",")),n()}e.length==0&&n();async function f(i){let c=[...e,i];u(c),t(c),await(0,a.showToast)({style:R.Success,title:'Added Workspace "'+i.workspaceName+'"'})}async function p(i){let c=new y(C.OPEN_WORKSPACE);c.addParam({name:"name",value:i.workspaceName}),await c.openCallbackUrl(),await(0,a.popToRoot)({clearSearchBar:!0}),await(0,a.closeMainWindow)()}async function l(i){let c=[...e];c.splice(i,1),u(c),t(c),await(0,a.showToast)({style:R.Success,title:"Removed Workspace"})}return(0,s.jsxs)(a.List,{actions:(0,s.jsx)(a.ActionPanel,{children:(0,s.jsx)(W,{onCreate:f})}),isLoading:r,children:[(0,s.jsx)(a.List.EmptyView,{actions:(0,s.jsx)(a.ActionPanel,{children:(0,s.jsx)(W,{onCreate:f})}),title:"No (matching) Workspace Configured!",description:"Configure Workspaces you want to open from Raycast",icon:"\u2699\uFE0F"}),(0,s.jsx)(a.List.Item,{title:"Deprecated Command",subtitle:"Please use the Command 'Find Workspace' instead.",icon:a.Icon.Warning}),e.map((i,c)=>(0,s.jsx)(a.List.Item,{title:i.workspaceName,icon:a.Icon.List,actions:(0,s.jsxs)(a.ActionPanel,{children:[(0,s.jsxs)(a.ActionPanel.Section,{title:"Workspace "+i.workspaceName,children:[(0,s.jsx)(we,{onOpen:()=>p(i)}),(0,s.jsx)(a.Action.CreateQuicklink,{quicklink:{link:C.OPEN_WORKSPACE+"name="+encodeURIComponent(i.workspaceName)},icon:a.Icon.Link,title:'Create Quicklink to open Workspace "'+i.workspaceName+'"'},c),(0,s.jsx)(Pe,{onDelete:()=>l(c)})]}),(0,s.jsx)(W,{onCreate:f})]})},c))]})}
